var __extends=this&&this.__extends||function(e,t){function r(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);r.prototype=t.prototype,e.prototype=new r},Kurve;!function(e){var t=function(){function e(){this.doneCallbacks=[],this.failCallbacks=[],this.progressCallbacks=[],this._promise=new n(this),this._state="pending"}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rejected",{get:function(){return"rejected"===this.state},set:function(e){this._state=e?"rejected":"pending"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resolved",{get:function(){return"resolved"===this.state},set:function(e){this._state=e?"resolved":"pending"},enumerable:!0,configurable:!0}),e.prototype.resolve=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return e.unshift(this),this.resolveWith.apply(this,e)},e.prototype.resolveWith=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this._result=t,this.doneCallbacks.forEach(function(r){r.apply(e,t)}),this.doneCallbacks=[],this.resolved=!0,this},e.prototype.reject=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return e.unshift(this),this.rejectWith.apply(this,e)},e.prototype.rejectWith=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this.failCallbacks.forEach(function(r){r.apply(e,t)}),this.failCallbacks=[],this.rejected=!0,this},e.prototype.progress=function(){for(var t=this,r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];var o=new e;return this.resolved||this.rejected?(r.forEach(function(e){e.apply(t._notifyContext,t._notifyArgs)}),o):(r.forEach(function(e){t.progressCallbacks.push(t.wrap(o,e,o.notify))}),this.checkStatus(),o)},e.prototype.notify=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return e.unshift(this),this.notifyWith.apply(this,e)},e.prototype.notifyWith=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this.resolved||this.rejected?this:(this._notifyContext=e,this._notifyArgs=t,this.progressCallbacks.forEach(function(r){r.apply(e,t)}),this)},e.prototype.checkStatus=function(){this.resolved?this.resolve.apply(this,this._result):this.rejected&&this.reject.apply(this,this._result)},e.prototype.then=function(t,r,n){var o=new e;return this.progressCallbacks.push(this.wrap(o,n,o.progress)),this.doneCallbacks.push(this.wrap(o,t,o.resolve)),this.failCallbacks.push(this.wrap(o,r,o.reject)),this.checkStatus(),this},e.prototype.wrap=function(e,t,r){return function(){for(var o=[],s=0;s<arguments.length;s++)o[s-0]=arguments[s];var i=t.apply(t,o);i&&i instanceof n?i.then(function(){e.resolve()},function(){e.reject()}):r.apply(e,[i])}},e.prototype.done=function(){for(var t=this,r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];var o=new e;return r.forEach(function(e){t.doneCallbacks.push(t.wrap(o,e,o.resolve))}),this.checkStatus(),o},e.prototype.fail=function(){for(var t=this,r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];var o=new e;return r.forEach(function(e){t.failCallbacks.push(t.wrap(o,e,o.reject))}),this.checkStatus(),o},e.prototype.always=function(){for(var t=this,r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];var o=new e;return r.forEach(function(e){t.doneCallbacks.push(t.wrap(o,e,o.resolve)),t.failCallbacks.push(t.wrap(o,e,o.reject))}),this.checkStatus(),o},e}();e.Deferred=t;var r=function(){function e(){this.doneCallbacks=[],this.failCallbacks=[],this.progressCallbacks=[],this._promise=new o(this),this._state="pending"}return Object.defineProperty(e.prototype,"promise",{get:function(){return this._promise},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rejected",{get:function(){return"rejected"===this.state},set:function(e){this._state=e?"rejected":"pending"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"resolved",{get:function(){return"resolved"===this.state},set:function(e){this._state=e?"resolved":"pending"},enumerable:!0,configurable:!0}),e.prototype.resolve=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return e.unshift(this),this.resolveWith.apply(this,e)},e.prototype.resolveWith=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this._result=t,this.doneCallbacks.forEach(function(r){r.apply(e,t)}),this.doneCallbacks=[],this.resolved=!0,this},e.prototype.reject=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return e.unshift(this),this.rejectWith.apply(this,e)},e.prototype.rejectWith=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this.failCallbacks.forEach(function(r){r.apply(e,t)}),this.failCallbacks=[],this.rejected=!0,this},e.prototype.progress=function(){for(var t=this,r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];var o=new e;return this.resolved||this.rejected?(r.forEach(function(e){e.apply(t._notifyContext,t._notifyArgs)}),o):(r.forEach(function(e){t.progressCallbacks.push(t.wrap(o,e,o.notify))}),this.checkStatus(),o)},e.prototype.notify=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return e.unshift(this),this.notifyWith.apply(this,e)},e.prototype.notifyWith=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return this.resolved||this.rejected?this:(this._notifyContext=e,this._notifyArgs=t,this.progressCallbacks.forEach(function(r){r.apply(e,t)}),this)},e.prototype.checkStatus=function(){this.resolved?this.resolve.apply(this,this._result):this.rejected&&this.reject.apply(this,this._result)},e.prototype.then=function(t,r,n){var o=new e;return this.progressCallbacks.push(this.wrap(o,n,o.progress)),this.doneCallbacks.push(this.wrap(o,t,o.resolve)),this.failCallbacks.push(this.wrap(o,r,o.reject)),this.checkStatus(),this},e.prototype.wrap=function(e,t,r){return function(){for(var o=[],s=0;s<arguments.length;s++)o[s-0]=arguments[s];var i=t.apply(t,o);i&&i instanceof n?i.then(function(){e.resolve()},function(){e.reject()}):r.apply(e,[i])}},e.prototype.done=function(){for(var t=this,r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];var o=new e;return r.forEach(function(e){t.doneCallbacks.push(t.wrap(o,e,o.resolve))}),this.checkStatus(),o},e.prototype.fail=function(){for(var t=this,r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];var o=new e;return r.forEach(function(e){t.failCallbacks.push(t.wrap(o,e,o.reject))}),this.checkStatus(),o},e.prototype.always=function(){for(var t=this,r=[],n=0;n<arguments.length;n++)r[n-0]=arguments[n];var o=new e;return r.forEach(function(e){t.doneCallbacks.push(t.wrap(o,e,o.resolve)),t.failCallbacks.push(t.wrap(o,e,o.reject))}),this.checkStatus(),o},e}();e.TypedDeferred=r;var n=function(){function e(e){this.deferred=e}return e.prototype.then=function(e,t,r){return this.deferred.then(e,t,r).promise},e.prototype.done=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.deferred.done.apply(this.deferred,e).promise},e.prototype.fail=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.deferred.fail.apply(this.deferred,e).promise},e.prototype.always=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.deferred.always.apply(this.deferred,e).promise},Object.defineProperty(e.prototype,"resolved",{get:function(){return this.deferred.resolved},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rejected",{get:function(){return this.deferred.rejected},enumerable:!0,configurable:!0}),e}();e.Promise=n;var o=function(){function e(e){this.deferred=e}return e.prototype.then=function(e,t,r){return this.deferred.then(e,t,r).promise},e.prototype.done=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.deferred.done.apply(this.deferred,e).promise},e.prototype.fail=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.deferred.fail.apply(this.deferred,e).promise},e.prototype.always=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return this.deferred.always.apply(this.deferred,e).promise},Object.defineProperty(e.prototype,"resolved",{get:function(){return this.deferred.resolved},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rejected",{get:function(){return this.deferred.rejected},enumerable:!0,configurable:!0}),e}();e.TypedPromise=o,e.when=function(){for(var e=[],r=0;r<arguments.length;r++)e[r-0]=arguments[r];if(1===e.length){var o=e[0];if(o instanceof t)return o.promise;if(o instanceof n)return o}var s=new t;if(1===e.length)return s.resolve(e[0]),s.promise;var i=e.length,a=[],u=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];a.push(e),0===--i&&s.resolve.apply(s,a)},c=function(){s.reject()};return e.forEach(function(e){e.then(u,c)}),s.promise}}(Kurve||(Kurve={}));var Kurve;!function(e){var t=function(){function e(){}return e}();e.Error=t;var r=function(){function r(e,r){var n=this;void 0===e&&(e=""),void 0===r&&(r=""),this.authContext=null,this.config=null,this.isCallback=!1,this.clientId=e,this.redirectUri=r,this.req=new XMLHttpRequest,this.tokenCache={},window.addEventListener("message",function(e){if("id_token"===e.data.type)if(e.data.token)if(n.state!==e.data.state){var r=new t;r.statusText="Invalid state",n.loginCallback(r)}else n.decodeIdToken(e.data.token),n.loginCallback(null);else n.loginCallback(e.data);else if("access_token"===e.data.type)if(e.data.token){var o=e.data.token,s=document.getElementById("tokenIFrame");if(s.parentNode.removeChild(s),e.data.state!==n.state){var r=new t;r.statusText="Invalid state",n.getTokenCallback(null,r)}else n.getTokenCallback(o,null)}else n.getTokenCallback(null,e.data)})}return r.prototype.decodeIdToken=function(e){var t=this,r=this.base64Decode(e.substring(e.indexOf(".")+1,e.lastIndexOf("."))),n=JSON.parse(r),o=new Date(new Date("01/01/1970 0:0 UTC").getTime()+1e3*parseInt(n.exp));this.idToken={token:e,expiry:o,upn:n.upn,tenantId:n.tid,family_name:n.family_name,given_name:n.given_name,name:n.name},this.refreshTimer=setTimeout(function(){t.renewIdToken()},1e3*parseInt(n.exp)-3e5)},r.prototype.decodeAccessToken=function(e,t){var r=this.base64Decode(e.substring(e.indexOf(".")+1,e.lastIndexOf("."))),n=JSON.parse(r),o=new Date(new Date("01/01/1970 0:0 UTC").getTime()+1e3*parseInt(n.exp));this.tokenCache[t]={resource:t,token:e,expiry:o}},r.prototype.getIdToken=function(){return this.idToken},r.prototype.isLoggedIn=function(){return this.idToken?this.idToken.expiry>new Date:!1},r.prototype.renewIdToken=function(){clearTimeout(this.refreshTimer),this.login(function(){})},r.prototype.getAccessTokenAsync=function(t){var r=new e.Deferred;return this.getAccessToken(t,function(e,t){t?r.reject(t):r.resolve(e)}),r.promise},r.prototype.getAccessToken=function(e,t){var r=this,n=this.tokenCache[e];if(n&&n.expiry>new Date((new Date).getTime()+6e4))return void t(n.token,null);this.getTokenCallback=function(n,o){o?t(null,o):(r.decodeAccessToken(n,e),t(n,null))},this.nonce=this.generateNonce(),this.state=this.generateNonce();var o=document.createElement("iframe");o.style.display="none",o.id="tokenIFrame",o.src="./login.html?clientId="+encodeURIComponent(this.clientId)+"&resource="+encodeURIComponent(e)+"&redirectUri="+encodeURIComponent(this.redirectUri)+"&state="+encodeURIComponent(this.state)+"&nonce="+encodeURIComponent(this.nonce),document.body.appendChild(o)},r.prototype.loginAsync=function(){var t=new e.Deferred;return this.login(function(e){e?t.reject(e):t.resolve()}),t.promise},r.prototype.login=function(e){this.loginCallback=e,this.state=this.generateNonce(),this.nonce=this.generateNonce(),window.open("./login.html?clientId="+encodeURIComponent(this.clientId)+"&redirectUri="+encodeURIComponent(this.redirectUri)+"&state="+encodeURIComponent(this.state)+"&nonce="+encodeURIComponent(this.nonce),"_blank")},r.prototype.logOut=function(){var e="https://login.microsoftonline.com/common/oauth2/logout?post_logout_redirect_uri="+encodeURI(window.location.href);window.location.href=e},r.prototype.base64Decode=function(e){var t,r,n,o,s={},i=0,a=0,u="",c=String.fromCharCode,p=e.length,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(t=0;64>t;t++)s[h.charAt(t)]=t;for(n=0;p>n;n++)for(r=s[e.charAt(n)],i=(i<<6)+r,a+=6;a>=8;)((o=i>>>(a-=8)&255)||p-2>n)&&(u+=c(o));return u},r.prototype.generateNonce=function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",r=0;32>r;r++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},r}();e.Identity=r}(Kurve||(Kurve={}));var Kurve;!function(e){var t=function(){function e(){}return e}();e.ProfilePhotoDataModel=t;var r=function(){function e(e,t){this.graph=e,this._data=t}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e}();e.ProfilePhoto=r;var n=function(){function e(){}return e}();e.UserDataModel=n;var o=function(){function e(e,t){this.graph=e,this._data=t}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e.prototype.memberOf=function(e,t,r){this.graph.memberOfForUser(this._data.userPrincipalName,e,r)},e.prototype.memberOfAsync=function(e){return this.graph.memberOfForUserAsync(this._data.userPrincipalName,e)},e.prototype.messages=function(e,t){this.graph.messagesForUser(this._data.userPrincipalName,e,t)},e.prototype.messagesAsync=function(e){return this.graph.messagesForUserAsync(this._data.userPrincipalName,e)},e.prototype.manager=function(e,t){this.graph.managerForUser(this._data.userPrincipalName,e,t)},e.prototype.managerAsync=function(e){return this.graph.managerForUserAsync(this._data.userPrincipalName,e)},e.prototype.profilePhoto=function(e){this.graph.profilePhotoForUser(this._data.userPrincipalName,e)},e.prototype.profilePhotoAsync=function(){return this.graph.profilePhotoForUserAsync(this._data.userPrincipalName)},e.prototype.profilePhotoValue=function(e){this.graph.profilePhotoValueForUser(this._data.userPrincipalName,e)},e.prototype.profilePhotoValueAsync=function(){return this.graph.profilePhotoValueForUserAsync(this._data.userPrincipalName)},e.prototype.calendar=function(e,t){this.graph.calendarForUser(this._data.userPrincipalName,e,t)},e.prototype.calendarAsync=function(e){return this.graph.calendarForUserAsync(this._data.userPrincipalName,e)},e}();e.User=o;var s=function(){function e(e,t){this.graph=e,this._data=t}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e}();e.Users=s;var i=function(){function e(){}return e}();e.MessageDataModel=i;var a=function(){function e(e,t){this.graph=e,this._data=t}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e}();e.Message=a;var u=function(){function e(e,t){this.graph=e,this._data=t}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e}();e.Messages=u;var c=function(){function e(){}return e}();e.CalendarEvent=c;var p=function(){function e(e,t){this.graph=e,this._data=t}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e}();e.CalendarEvents=p;var h=function(){function e(){}return e}();e.Contact=h;var l=function(){function e(){}return e}();e.GroupDataModel=l;var f=function(){function e(e,t){this.graph=e,this._data=t}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e}();e.Group=f;var d=function(){function e(e,t){this.graph=e,this._data=t}return Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!0,configurable:!0}),e}();e.Groups=d;var g=function(){function t(e){this.req=null,this.state=null,this.nonce=null,this.accessToken=null,this.KurveIdentity=null,this.defaultResourceID="https://graph.microsoft.com",this.baseUrl="https://graph.microsoft.com/v1.0/",e.defaultAccessToken?this.accessToken=e.defaultAccessToken:this.KurveIdentity=e.identity}return t.prototype.meAsync=function(t){var r=new e.TypedDeferred;return this.me(function(e,t){t?r.reject(t):r.resolve(e)},t),r.promise},t.prototype.me=function(e,t){var r=this.buildMeUrl()+"/";t&&(r+="?"+t),this.getUser(r,e)},t.prototype.userAsync=function(t){var r=new e.TypedDeferred;return this.user(t,function(e,t){t?r.reject(t):r.resolve(e)}),r.promise},t.prototype.user=function(e,t){var r=this.buildUsersUrl()+"/"+e;this.getUser(r,t)},t.prototype.usersAsync=function(t){var r=new e.TypedDeferred;return this.users(function(e,t){t?r.reject(t):r.resolve(e)},t),r.promise},t.prototype.users=function(e,t){var r=this.buildUsersUrl()+"/";t&&(r+="?"+t),this.getUsers(r,e)},t.prototype.groupAsync=function(t){var r=new e.Deferred;return this.group(t,function(e,t){t?r.reject(t):r.resolve(e)}),r.promise},t.prototype.group=function(e,t){var r=this.buildGroupsUrl()+"/"+e;this.getGroup(r,t)},t.prototype.groups=function(e,t){var r=this.buildGroupsUrl()+"/";t&&(r+="?"+t),this.getGroups(r,e)},t.prototype.groupsAsync=function(t){var r=new e.Deferred;return this.groups(function(e,t){t?r.reject(t):r.resolve(e)},t),r.promise},t.prototype.messagesForUser=function(e,t,r){var n=this.buildUsersUrl()+"/"+e+"/messages";r&&(n+="?"+r),this.getMessages(n,function(e,r){t(e,r)},r)},t.prototype.messagesForUserAsync=function(t,r){var n=new e.TypedDeferred;return this.messagesForUser(t,function(e,t){t?n.reject(t):n.resolve(e)},r),n.promise},t.prototype.calendarForUser=function(e,t,r){},t.prototype.calendarForUserAsync=function(t,r){var n=new e.TypedDeferred;return n.promise},t.prototype.memberOfForUser=function(e,t,r){var n=this.buildUsersUrl()+"/"+e+"/memberOf";r&&(n+="?"+r),this.getGroups(n,t,r)},t.prototype.memberOfForUserAsync=function(t,r){var n=new e.TypedDeferred;return this.memberOfForUser(t,function(e,t){t?n.reject(t):n.resolve(e)},r),n.promise},t.prototype.managerForUser=function(e,t,r){var n=this.buildUsersUrl()+"/"+e+"/manager";this.getUser(n,t)},t.prototype.managerForUserAsync=function(t,r){var n=new e.TypedDeferred;return this.managerForUser(t,function(e,t){t?n.reject(t):n.resolve(e)},r),n.promise},t.prototype.directReportsForUser=function(e,t,r){var n=this.buildUsersUrl()+"/"+e+"/directReports";this.getUsers(n,t)},t.prototype.directReportsForUserAsync=function(t,r){var n=new e.TypedDeferred;return this.directReportsForUser(t,function(e,t){t?n.reject(t):n.resolve(e)},r),n.promise},t.prototype.profilePhotoForUser=function(e,t){var r=this.buildUsersUrl()+"/"+e+"/photo";this.getPhoto(r,t)},t.prototype.profilePhotoForUserAsync=function(t){var r=new e.TypedDeferred;return this.profilePhotoForUser(t,function(e,t){t?r.reject(t):r.resolve(e)}),r.promise},t.prototype.profilePhotoValueForUser=function(e,t){var r=this.buildUsersUrl()+"/"+e+"/photo/$value";this.getPhotoValue(r,t)},t.prototype.profilePhotoValueForUserAsync=function(t){var r=new e.TypedDeferred;return this.profilePhotoValueForUser(t,function(e,t){t?r.reject(t):r.resolve(e)}),r.promise},t.prototype.getAsync=function(t){var r=new e.TypedDeferred;return this.get(t,function(e,t){t?r.reject(t):r.resolve(e)}),r.promise},t.prototype.get=function(e,t,r){var n=this,o=new XMLHttpRequest;r&&(o.responseType=r),o.onreadystatechange=function(){4===o.readyState&&200===o.status?r?t(o.response,null):t(o.responseText,null):4===o.readyState&&200!==o.status&&t(null,n.generateError(o))},o.open("GET",e),this.addAccessTokenAndSend(o,function(e){e&&t(null,e)})},t.prototype.generateError=function(t){var r=new e.Error;return r.status=t.status,r.statusText=t.statusText,""===t.responseType||"text"===t.responseType?r.text=t.responseText:r.other=t.response,r},t.prototype.getUsers=function(t,r){var n=this;this.get(t,function(t,s){if(s)return void r(null,s);var i=JSON.parse(t);if(i.error){var a=new e.Error;return a.other=i.error,void r(null,a)}var u=i.value?i.value:[i],c=new e.Users(n,u.map(function(e){return new o(n,e)})),p=i["@odata.nextLink"];p&&(c.nextLink=function(t){var r=new e.Deferred;return n.getUsers(p,function(e,n){t?t(e,n):n?r.reject(n):r.resolve(e)}),r.promise}),r(c,null)})},t.prototype.getUser=function(t,r){var n=this;this.get(t,function(t,s){if(s)return void r(null,s);var i=JSON.parse(t);if(i.error){var a=new e.Error;return a.other=i.error,void r(null,a)}var u=new o(n,i);r(u,null)})},t.prototype.addAccessTokenAndSend=function(e,t){this.accessToken?(e.setRequestHeader("Authorization","Bearer "+this.accessToken),e.send()):this.KurveIdentity.getAccessToken(this.defaultResourceID,function(r,n){n?t(n):(e.setRequestHeader("Authorization","Bearer "+r),e.send(),t(null))})},t.prototype.getMessages=function(t,r,n){var o=this,s=t;n&&(t+="?"+n),this.get(s,function(t,n){if(n)return void r(null,n);var s=JSON.parse(t);if(s.error){var i=new e.Error;return i.other=s.error,void r(null,i)}var u=s.value?s.value:[s],c=new e.Messages(o,u.map(function(e){return new a(o,e)}));s["@odata.nextLink"]&&(c.nextLink=function(t,r){var n=new e.Deferred;return o.getMessages(s["@odata.nextLink"],function(e,r){t?t(e,r):r?n.reject(r):n.resolve(e)},r),n.promise}),r(c,null)})},t.prototype.getGroups=function(t,r,n){var o=this,s=t;n&&(t+="?"+n),this.get(s,function(t,n){if(n)return void r(null,n);var s=JSON.parse(t);if(s.error){var i=new e.Error;return i.other=s.error,void r(null,i)}var a=s.value?s.value:[s],u=new e.Groups(o,a.map(function(e){return new f(o,e)})),c=s["@odata.nextLink"];c&&(u.nextLink=function(t){var r=new e.TypedDeferred;return o.getGroups(c,function(e,n){t?t(e,n):n?r.reject(n):r.resolve(e)}),r.promise}),r(u,null)})},t.prototype.getGroup=function(t,r){var n=this;this.get(t,function(t,o){if(o)return void r(null,o);var s=JSON.parse(t);if(s.error){var i=new e.Error;return i.other=s.error,void r(null,i)}var a=new e.Group(n,s);r(a,null)})},t.prototype.getPhoto=function(t,n){var o=this;this.get(t,function(t,s){if(s)return void n(null,s);var i=JSON.parse(t);if(i.error){var a=new e.Error;return a.other=i.error,void n(null,a)}var u=new r(o,i);n(u,null)})},t.prototype.getPhotoValue=function(e,t){this.get(e,function(e,r){return r?void t(null,r):void t(e,null)},"blob")},t.prototype.buildMeUrl=function(){return this.baseUrl+"me"},t.prototype.buildUsersUrl=function(){return this.baseUrl+"/users"},t.prototype.buildGroupsUrl=function(){return this.baseUrl+"/groups"},t}();e.Graph=g}(Kurve||(Kurve={})),("undefined"!=typeof window&&window.module||"undefined"!=typeof module)&&"undefined"!=typeof module.exports&&(module.exports=Kurve);