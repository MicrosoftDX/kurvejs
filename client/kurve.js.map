{"version":3,"sources":["kurve.ts"],"names":[],"mappings":"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","file":"kurve.js","sourcesContent":["// Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license. See full license at the bottom of this file.\r\nexport module kurve {\r\n    \r\n// Adapted from the original source: https://github.com/DirtyHairy/typescript-deferred\r\n\r\n\r\n\r\n  export class Error {\r\n        public status: number;\r\n        public statusText: string;\r\n        public text: string;\r\n        public other: any;\r\n    }\r\n    \r\n    function DispatchDeferred(closure: () => void) {\r\n        setTimeout(closure, 0);\r\n    }\r\n\r\n     enum PromiseState { Pending, ResolutionInProgress, Resolved, Rejected }\r\n\r\n    export interface PromiseCallback<T> {\r\n        (error: Error, result?: T): void;\r\n    }\r\n\r\n    class Client {\r\n        constructor(\r\n            private _dispatcher: (closure: () => void) => void,\r\n            private _successCB: any,\r\n            private _errorCB: any\r\n        ) {\r\n            this.result = new Deferred<any, any>(_dispatcher);\r\n        }\r\n\r\n        resolve(value: any, defer: boolean): void {\r\n            if (typeof (this._successCB) !== 'function') {\r\n                this.result.resolve(value);\r\n                return;\r\n            }\r\n\r\n            if (defer) {\r\n                this._dispatcher(() => this._dispatchCallback(this._successCB, value));\r\n            } else {\r\n                this._dispatchCallback(this._successCB, value);\r\n            }\r\n        }\r\n\r\n        reject(error: any, defer: boolean): void {\r\n            if (typeof (this._errorCB) !== 'function') {\r\n                this.result.reject(error);\r\n                return;\r\n            }\r\n\r\n            if (defer) {\r\n                this._dispatcher(() => this._dispatchCallback(this._errorCB, error));\r\n            } else {\r\n                this._dispatchCallback(this._errorCB, error);\r\n            }\r\n        }\r\n\r\n        private _dispatchCallback(callback: (arg: any) => any, arg: any): void {\r\n            var result: any,\r\n                then: any,\r\n                type: string;\r\n\r\n            try {\r\n                result = callback(arg);\r\n                this.result.resolve(result);\r\n            } catch (err) {\r\n                this.result.reject(err);\r\n                return;\r\n            }\r\n        }\r\n\r\n        result: Deferred<any, any>;\r\n    }\r\n\r\n    export class Deferred<T, E>  {\r\n        private _dispatcher: (closure: () => void)=> void;\r\n\r\n        constructor();\r\n        constructor(dispatcher: (closure: () => void) => void);\r\n        constructor(dispatcher?: (closure: () => void) => void) {\r\n            if (dispatcher)\r\n                this._dispatcher = dispatcher;\r\n            else\r\n                this._dispatcher = DispatchDeferred;\r\n            this.promise = new Promise<T, E>(this);\r\n        }\r\n\r\n        private DispatchDeferred(closure: () => void) {\r\n            setTimeout(closure, 0);\r\n        }\r\n\r\n        then(successCB: any, errorCB: any): any {\r\n            if (typeof (successCB) !== 'function' && typeof (errorCB) !== 'function') {\r\n                return this.promise;\r\n            }\r\n\r\n            var client = new Client(this._dispatcher, successCB, errorCB);\r\n\r\n            switch (this._state) {\r\n                case PromiseState.Pending:\r\n                case PromiseState.ResolutionInProgress:\r\n                    this._stack.push(client);\r\n                    break;\r\n\r\n                case PromiseState.Resolved:\r\n                    client.resolve(this._value, true);\r\n                    break;\r\n\r\n                case PromiseState.Rejected:\r\n                    client.reject(this._error, true);\r\n                    break;\r\n            }\r\n\r\n            return client.result.promise;\r\n        }\r\n\r\n        resolve(value?: T): Deferred<T, E>;\r\n\r\n        resolve(value?: Promise<T, E>): Deferred<T, E>;\r\n\r\n        resolve(value?: any): Deferred<T, E> {\r\n            if (this._state !== PromiseState.Pending) {\r\n                return this;\r\n            }\r\n\r\n            return this._resolve(value);\r\n        }\r\n\r\n        private _resolve(value: any): Deferred<T, E> {\r\n            var type = typeof (value),\r\n                then: any,\r\n                pending = true;\r\n\r\n            try {\r\n                if (value !== null &&\r\n                    (type === 'object' || type === 'function') &&\r\n                    typeof (then = value.then) === 'function') {\r\n                    if (value === this.promise) {\r\n                        throw new TypeError('recursive resolution');\r\n                    }\r\n\r\n                    this._state = PromiseState.ResolutionInProgress;\r\n                    then.call(value,\r\n                        (result: any): void => {\r\n                            if (pending) {\r\n                                pending = false;\r\n                                this._resolve(result);\r\n                            }\r\n                        },\r\n                        (error: any): void => {\r\n                            if (pending) {\r\n                                pending = false;\r\n                                this._reject(error);\r\n                            }\r\n                        }\r\n                    );\r\n                } else {\r\n                    this._state = PromiseState.ResolutionInProgress;\r\n\r\n                    this._dispatcher(() => {\r\n                        this._state = PromiseState.Resolved;\r\n                        this._value = value;\r\n\r\n                        var i: number,\r\n                            stackSize = this._stack.length;\r\n\r\n                        for (i = 0; i < stackSize; i++) {\r\n                            this._stack[i].resolve(value, false);\r\n                        }\r\n\r\n                        this._stack.splice(0, stackSize);\r\n                    });\r\n                }\r\n            } catch (err) {\r\n                if (pending) {\r\n                    this._reject(err);\r\n                }\r\n            }\r\n\r\n            return this;\r\n        }\r\n\r\n        reject(error?: E): Deferred<T, E> {\r\n            if (this._state !== PromiseState.Pending) {\r\n                return this;\r\n            }\r\n\r\n            return this._reject(error);\r\n        }\r\n\r\n        private _reject(error?: any): Deferred<T, E> {\r\n            this._state = PromiseState.ResolutionInProgress;\r\n\r\n            this._dispatcher(() => {\r\n                this._state = PromiseState.Rejected;\r\n                this._error = error;\r\n\r\n                var stackSize = this._stack.length,\r\n                    i = 0;\r\n\r\n                for (i = 0; i < stackSize; i++) {\r\n                    this._stack[i].reject(error, false);\r\n                }\r\n\r\n                this._stack.splice(0, stackSize);\r\n            });\r\n\r\n            return this;\r\n        }\r\n\r\n        promise: Promise<T, E>;\r\n\r\n        private _stack: Array<Client> = [];\r\n        private _state = PromiseState.Pending;\r\n        private _value: T;\r\n        private _error: any;\r\n    }\r\n\r\n    export class Promise<T, E>  {\r\n        constructor(private _deferred: Deferred<T, E>) { }\r\n\r\n        then<R>(\r\n            successCallback?: (result: T) => R,\r\n            errorCallback?: (error: E) => R\r\n        );\r\n\r\n        then(successCallback: any, errorCallback: any): any {\r\n            return this._deferred.then(successCallback, errorCallback);\r\n        }\r\n\r\n        fail<R>(\r\n            errorCallback?: (error: E) => R\r\n        );\r\n\r\n        fail(errorCallback: any): any {\r\n            return this._deferred.then(undefined, errorCallback);\r\n        }\r\n    }\r\n\r\n\r\n\r\n\n\r\n\r\n    export enum OAuthVersion {\r\n        v1=1,\r\n        v2=2\r\n    }\r\n\r\n  \r\n\r\n    class CachedToken {\r\n        constructor(\r\n            public id: string,\r\n            public scopes: string[],\r\n            public resource: string,\r\n            public token: string,\r\n            public expiry: Date) {};\r\n\r\n        public get isExpired() {\r\n            return this.expiry <= new Date(new Date().getTime() + 60000);\r\n        }\r\n\r\n        public hasScopes(requiredScopes: string[]) {\r\n            if (!this.scopes) {\r\n                return false;\r\n            }\r\n\r\n            return requiredScopes.every(requiredScope => {\r\n                return this.scopes.some(actualScope => requiredScope === actualScope);\r\n            });\r\n        }\r\n    }\r\n\r\n    interface CachedTokenDictionary {\r\n        [index: string]: CachedToken;\r\n    }\r\n\r\n    export interface TokenStorage {\r\n        add(key: string, token: any);\r\n        remove(key: string);\r\n        getAll(): any[];\r\n        clear();\r\n    }\r\n\r\n    class TokenCache {\r\n        private cachedTokens: CachedTokenDictionary;\r\n\r\n        constructor(private tokenStorage: TokenStorage) {\r\n            this.cachedTokens = {};\r\n            if (tokenStorage) {\r\n                tokenStorage.getAll().forEach(({ id, scopes, resource, token, expiry }) => {\r\n                    var cachedToken = new CachedToken(id, scopes, resource, token, new Date(expiry));\r\n                    if (cachedToken.isExpired) {\r\n                        this.tokenStorage.remove(cachedToken.id);\r\n                    } else {\r\n                        this.cachedTokens[cachedToken.id] = cachedToken;\r\n                    }\r\n                });\r\n            }\r\n        }\r\n\r\n        public add(token: CachedToken) {\r\n            this.cachedTokens[token.id] = token;\r\n            this.tokenStorage && this.tokenStorage.add(token.id, token);\r\n        }\r\n\r\n        public getForResource(resource: string): CachedToken {\r\n            var cachedToken = this.cachedTokens[resource];\r\n            if (cachedToken && cachedToken.isExpired) {\r\n                this.remove(resource);\r\n                return null;\r\n            }\r\n            return cachedToken;\r\n        }\r\n\r\n        public getForScopes(scopes: string[]): CachedToken {\r\n            for (var key in this.cachedTokens) {\r\n                var cachedToken = this.cachedTokens[key];\r\n\r\n                if (cachedToken.hasScopes(scopes)) {\r\n                    if (cachedToken.isExpired) {\r\n                        this.remove(key);\r\n                    } else {\r\n                        return cachedToken;\r\n                    }\r\n                }\r\n            }\r\n\r\n            return null;\r\n        }\r\n\r\n        public clear() {\r\n            this.cachedTokens = {};\r\n            this.tokenStorage && this.tokenStorage.clear();\r\n        }\r\n\r\n        private remove(key) {\r\n            this.tokenStorage && this.tokenStorage.remove(key);\r\n            delete this.cachedTokens[key];\r\n        }\r\n    }\r\n\r\n    export class IdToken {\r\n        public Token: string;\r\n        public IssuerIdentifier: string;\r\n        public SubjectIdentifier: string;\r\n        public Audience: string;\r\n        public Expiry: Date;\r\n        public UPN: string;\r\n        public TenantId: string;\r\n        public FamilyName: string;\r\n        public GivenName: string;\r\n        public Name: string;\r\n        public PreferredUsername: string;\r\n        public FullToken: any;\r\n\r\n    }\r\n\r\n    export interface IdentitySettings {\r\n        clientId: string;\r\n        tokenProcessingUri: string;\r\n        version: OAuthVersion;\r\n        tokenStorage?: TokenStorage;\r\n    }\r\n\r\n    export class Identity {\r\n//      public authContext: any = null;\r\n//      public config: any = null;\r\n//      public isCallback: boolean = false;\r\n        public clientId: string;\r\n//      private req: XMLHttpRequest;\r\n        private state: string;\r\n        private version: OAuthVersion;\r\n        private nonce: string;\r\n        private idToken: IdToken;\r\n        private loginCallback: (error: Error) => void;\r\n//      private accessTokenCallback: (token: string, error: Error) => void;\r\n        private getTokenCallback: (token: string, error: Error) => void;\r\n        private tokenProcessorUrl: string;\r\n        private tokenCache: TokenCache;\r\n//      private logonUser: any;\r\n        private refreshTimer: any;\r\n        private policy: string = \"\";\r\n//      private tenant: string = \"\";\r\n\r\n        constructor(identitySettings: IdentitySettings) {\r\n            this.clientId = identitySettings.clientId;\r\n            this.tokenProcessorUrl = identitySettings.tokenProcessingUri;\r\n//          this.req = new XMLHttpRequest();\r\n            if (identitySettings.version)\r\n                this.version = identitySettings.version;\r\n            else\r\n                this.version = OAuthVersion.v1;\r\n\r\n            this.tokenCache = new TokenCache(identitySettings.tokenStorage);\r\n\r\n            //Callback handler from other windows\r\n            window.addEventListener(\"message\", event => {\r\n                if (event.data.type === \"id_token\") {\r\n                    if (event.data.error) {\r\n                        var e: Error = new Error();\r\n                        e.text = event.data.error;\r\n                        this.loginCallback(e);\r\n\r\n                    } else {\r\n                        //check for state\r\n                        if (this.state !== event.data.state) {\r\n                            var error = new Error();\r\n                            error.statusText = \"Invalid state\";\r\n                            this.loginCallback(error);\r\n                        } else {\r\n                            this.decodeIdToken(event.data.token);\r\n                            this.loginCallback(null);\r\n                        }\r\n                    }\r\n                } else if (event.data.type === \"access_token\") {\r\n                    if (event.data.error) {\r\n                        var e: Error = new Error();\r\n                        e.text = event.data.error;\r\n                        this.getTokenCallback(null, e);\r\n\r\n                    } else {\r\n                        var token:string = event.data.token;\r\n                        var iframe = document.getElementById(\"tokenIFrame\");\r\n                        iframe.parentNode.removeChild(iframe);\r\n\r\n                        if (event.data.state !== this.state) {\r\n                            var error = new Error();\r\n                            error.statusText = \"Invalid state\";\r\n                            this.getTokenCallback(null, error);\r\n                        }\r\n                        else {\r\n                            this.getTokenCallback(token, null);\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        public checkForIdentityRedirect(): boolean {\r\n            function token(s: string) {\r\n                var start = window.location.href.indexOf(s);\r\n                if (start < 0) return null;\r\n                var end = window.location.href.indexOf(\"&\",start + s.length);\r\n                return  window.location.href.substring(start,((end > 0) ? end : window.location.href.length));\r\n            }\r\n\r\n            function parseQueryString(str: string) {\r\n                var queryString = str || window.location.search || '';\r\n                var keyValPairs: any[] = [];\r\n                var params: any = {};\r\n                queryString = queryString.replace(/.*?\\?/, \"\");\r\n\r\n                if (queryString.length) {\r\n                    keyValPairs = queryString.split('&');\r\n                    for (var pairNum in keyValPairs) {\r\n                        var key = keyValPairs[pairNum].split('=')[0];\r\n                        if (!key.length) continue;\r\n                        if (typeof params[key] === 'undefined')\r\n                            params[key] = [];\r\n                        params[key].push(keyValPairs[pairNum].split('=')[1]);\r\n                    }\r\n                }\r\n                return params;\r\n            }\r\n\r\n            var params = parseQueryString(window.location.href);\r\n            var idToken = token(\"#id_token=\");\r\n            var accessToken = token(\"#access_token\");\r\n            if (idToken) {\r\n                if (true || this.state === params[\"state\"][0]) { //BUG? When you are in a pure redirect system you don't remember your state or nonce so don't check.\r\n                    this.decodeIdToken(idToken);\r\n                    this.loginCallback && this.loginCallback(null);\r\n                } else {\r\n                    var error = new Error();\r\n                    error.statusText = \"Invalid state\";\r\n                    this.loginCallback && this.loginCallback(error);\r\n                }\r\n                return true;\r\n            }\r\n            else if (accessToken) {\r\n                throw \"Should not get here.  This should be handled via the iframe approach.\"\r\n/*\r\n                if (this.state === params[\"state\"][0]) {\r\n                    this.getTokenCallback && this.getTokenCallback(accessToken, null);\r\n                } else {\r\n                    var error = new Error();\r\n                    error.statusText = \"Invalid state\";\r\n                    this.getTokenCallback && this.getTokenCallback(null, error);\r\n                }\r\n*/\r\n            }\r\n            return false;\r\n        }\r\n\r\n        private decodeIdToken(idToken: string): void {\r\n\r\n            var decodedToken = this.base64Decode(idToken.substring(idToken.indexOf('.') + 1, idToken.lastIndexOf('.')));\r\n            var decodedTokenJSON = JSON.parse(decodedToken);\r\n            var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\r\n            this.idToken = new IdToken();\r\n            this.idToken.FullToken = decodedTokenJSON;\r\n            this.idToken.Token = idToken;\r\n            this.idToken.Expiry = expiryDate;\r\n            this.idToken.UPN = decodedTokenJSON.upn;\r\n            this.idToken.TenantId = decodedTokenJSON.tid;\r\n            this.idToken.FamilyName = decodedTokenJSON.family_name;\r\n            this.idToken.GivenName = decodedTokenJSON.given_name;\r\n            this.idToken.Name = decodedTokenJSON.name;\r\n            this.idToken.PreferredUsername = decodedTokenJSON.preferred_username;\r\n\r\n            var expiration: Number = expiryDate.getTime() - new Date().getTime() - 300000;\r\n\r\n            this.refreshTimer = setTimeout((() => {\r\n                this.renewIdToken();\r\n            }), expiration);\r\n        }\r\n\r\n        private decodeAccessToken(accessToken: string, resource?:string, scopes?:string[]): void {\r\n            var decodedToken = this.base64Decode(accessToken.substring(accessToken.indexOf('.') + 1, accessToken.lastIndexOf('.')));\r\n            var decodedTokenJSON = JSON.parse(decodedToken);\r\n            var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\r\n            var key = resource || scopes.join(\" \");\r\n\r\n            var token = new CachedToken(key, scopes, resource, accessToken, expiryDate);\r\n            this.tokenCache.add(token);\r\n        }\r\n\r\n        public getIdToken(): any {\r\n            return this.idToken;\r\n        }\r\n        public isLoggedIn(): boolean {\r\n            if (!this.idToken) return false;\r\n            return (this.idToken.Expiry > new Date());\r\n        }\r\n\r\n        private renewIdToken(): void {\r\n            clearTimeout(this.refreshTimer);\r\n            this.login(() => { });\r\n        }\r\n\r\n        public getCurrentOauthVersion(): OAuthVersion {\r\n            return this.version;\r\n        }\r\n\r\n        public getAccessTokenAsync(resource: string): Promise<string,Error> {\r\n\r\n            var d = new Deferred<string,Error>();\r\n            this.getAccessToken(resource, ((error, token) => {\r\n                if (error) {\r\n                    d.reject(error);\r\n                } else {\r\n                    d.resolve(token);\r\n                }\r\n            }));\r\n            return d.promise;\r\n        }\r\n\r\n        public getAccessToken(resource: string, callback: PromiseCallback<string>): void {\r\n            if (this.version !== OAuthVersion.v1) {\r\n                var e = new Error();\r\n                e.statusText = \"Currently this identity class is using v2 OAuth mode. You need to use getAccessTokenForScopes() method\";\r\n                callback(e);\r\n                return;\r\n            }\r\n\r\n            var token = this.tokenCache.getForResource(resource);\r\n            if (token) {\r\n                return callback(null, token.token);\r\n            }\r\n\r\n            //If we got this far, we need to go get this token\r\n\r\n            //Need to create the iFrame to invoke the acquire token\r\n            this.getTokenCallback = ((token: string, error: Error) => {\r\n                if (error) {\r\n                    callback(error);\r\n                }\r\n                else {\r\n                    this.decodeAccessToken(token, resource);\r\n                    callback(null, token);\r\n                }\r\n            });\r\n\r\n            this.nonce = \"token\" + this.generateNonce();\r\n            this.state = \"token\" + this.generateNonce();\r\n\r\n            var iframe = document.createElement('iframe');\r\n            iframe.style.display = \"none\";\r\n            iframe.id = \"tokenIFrame\";\r\n\r\n            iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n            \"&resource=\" + encodeURIComponent(resource) +\r\n                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n                \"&state=\" + encodeURIComponent(this.state) +\r\n                \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n                \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n                \"&op=token\";\r\n\r\n            document.body.appendChild(iframe);\r\n        }\r\n\r\n\r\n        public getAccessTokenForScopesAsync(scopes: string[], promptForConsent = false): Promise<string, Error> {\r\n\r\n            var d = new Deferred<string, Error>();\r\n            this.getAccessTokenForScopes(scopes, promptForConsent, (token, error) => {\r\n                if (error) {\r\n                    d.reject(error);\r\n                } else {\r\n                    d.resolve(token);\r\n                }\r\n            });\r\n            return d.promise;\r\n        }\r\n\r\n        public getAccessTokenForScopes(scopes: string[], promptForConsent, callback: (token: string, error: Error) => void): void {\r\n            if (this.version !== OAuthVersion.v2) {\r\n                var e = new Error();\r\n                e.statusText = \"Dynamic scopes require v2 mode. Currently this identity class is using v1\";\r\n                callback(null, e);\r\n                return;\r\n            }\r\n\r\n            var token = this.tokenCache.getForScopes(scopes);\r\n            if (token) {\r\n                return callback(token.token, null);\r\n            }\r\n\r\n            //If we got this far, we don't have a valid cached token, so will need to get one.\r\n\r\n            //Need to create the iFrame to invoke the acquire token\r\n\r\n            this.getTokenCallback = ((token: string, error: Error) => {\r\n                if (error) {\r\n                    if (promptForConsent || !error.text) {\r\n                        callback(null, error);\r\n                    } else if (error.text.indexOf(\"AADSTS65001\")>=0) {\r\n                        //We will need to try getting the consent\r\n                        this.getAccessTokenForScopes(scopes, true, this.getTokenCallback);\r\n                    } else {\r\n                        callback(null, error);\r\n                    }\r\n                }\r\n                else {\r\n                    this.decodeAccessToken(token, null, scopes);\r\n                    callback(token, null);\r\n                }\r\n            });\r\n\r\n            this.nonce = \"token\" + this.generateNonce();\r\n            this.state = \"token\" + this.generateNonce();\r\n\r\n            if (!promptForConsent) {\r\n                var iframe = document.createElement('iframe');\r\n                iframe.style.display = \"none\";\r\n                iframe.id = \"tokenIFrame\";\r\n                iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n                    \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\r\n                    \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n                    \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n                    \"&state=\" + encodeURIComponent(this.state) +\r\n                    \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n                    \"&login_hint=\" + encodeURIComponent(this.idToken.PreferredUsername) +\r\n                    \"&domain_hint=\" + encodeURIComponent(this.idToken.TenantId === \"9188040d-6c67-4c5b-b112-36a304b66dad\" ? \"consumers\" : \"organizations\") +\r\n                    \"&op=token\";\r\n                document.body.appendChild(iframe);\r\n            } else {\r\n                window.open(this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n                    \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\r\n                    \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n                    \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n                    \"&state=\" + encodeURIComponent(this.state) +\r\n                    \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n                    \"&op=token\"\r\n                    , \"_blank\");\r\n            }\r\n        }\r\n\r\n        public loginAsync(loginSettings?: { scopes?: string[], policy?:string, tenant?:string}): Promise<void, Error> {\r\n            var d = new Deferred<void, Error>();\r\n            this.login((error) => {\r\n                if (error) {\r\n                    d.reject(error);\r\n                }\r\n                else {\r\n                    d.resolve(null);\r\n                }\r\n            }, loginSettings);\r\n            return d.promise;\r\n        }\r\n\r\n        public login(callback: (error: Error) => void, loginSettings?: { scopes?: string[], policy?: string, tenant?: string}): void {\r\n            this.loginCallback = callback;\r\n            if (!loginSettings) loginSettings = {};\r\n            if (loginSettings.policy) this.policy = loginSettings.policy;\r\n\r\n            if (loginSettings.scopes && this.version === OAuthVersion.v1) {\r\n                var e = new Error();\r\n                e.text = \"Scopes can only be used with OAuth v2.\";\r\n                callback(e);\r\n                return;\r\n            }\r\n\r\n            if (loginSettings.policy && !loginSettings.tenant) {\r\n                var e = new Error();\r\n                e.text = \"In order to use policy (AAD B2C) a tenant must be specified as well.\";\r\n                callback(e);\r\n                return;\r\n            }\r\n            this.state = \"login\" + this.generateNonce();\r\n            this.nonce = \"login\" + this.generateNonce();\r\n            var loginURL = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n                \"&state=\" + encodeURIComponent(this.state) +\r\n                \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n                \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n                \"&op=login\" +\r\n                \"&p=\" + encodeURIComponent(this.policy);\r\n            if (loginSettings.tenant) {\r\n                loginURL += \"&tenant=\" + encodeURIComponent(loginSettings.tenant);\r\n            }\r\n            if (this.version === OAuthVersion.v2) {\r\n                    if (!loginSettings.scopes) loginSettings.scopes = [];\r\n                    if (loginSettings.scopes.indexOf(\"profile\") < 0)\r\n                        loginSettings.scopes.push(\"profile\");\r\n                    if (loginSettings.scopes.indexOf(\"openid\") < 0)\r\n                        loginSettings.scopes.push(\"openid\");\r\n\r\n                    loginURL += \"&scopes=\" + encodeURIComponent(loginSettings.scopes.join(\" \"));\r\n            }\r\n            window.open(loginURL, \"_blank\");\r\n        }\r\n\r\n\r\n        public loginNoWindowAsync(toUrl? : string): Promise<void, Error> {\r\n            var d = new Deferred<void, Error>();\r\n            this.loginNoWindow((error) => {\r\n                if (error) {\r\n                    d.reject(error);\r\n                }\r\n                else {\r\n                    d.resolve(null);\r\n                }\r\n            }, toUrl);\r\n            return d.promise;\r\n        }\r\n\r\n        public loginNoWindow(callback: (error: Error) => void, toUrl? : string): void {\r\n            this.loginCallback = callback;\r\n            this.state = \"clientId=\" + this.clientId + \"&\" + \"tokenProcessorUrl=\" + this.tokenProcessorUrl\r\n            this.nonce = this.generateNonce();\r\n\r\n            var redirected = this.checkForIdentityRedirect();\r\n            if (!redirected) {\r\n                var redirectUri = (toUrl) ? toUrl : window.location.href.split(\"#\")[0];  // default the no login window scenario to return to the current page\r\n                var url = \"https://login.microsoftonline.com/common/oauth2/authorize?response_type=id_token\" +\r\n                    \"&client_id=\" + encodeURIComponent(this.clientId) +\r\n                    \"&redirect_uri=\" + encodeURIComponent(redirectUri) +\r\n                    \"&state=\" + encodeURIComponent(this.state) +\r\n                    \"&nonce=\" + encodeURIComponent(this.nonce);\r\n                window.location.href = url;\r\n            }\r\n        }\r\n\r\n        public logOut(): void {\r\n            this.tokenCache.clear();\r\n            var url = \"https://login.microsoftonline.com/common/oauth2/logout?post_logout_redirect_uri=\" + encodeURI(window.location.href);\r\n            window.location.href = url;\r\n        }\r\n\r\n        private base64Decode(encodedString: string): string {\r\n            var e: any = {}, i: number, b = 0, c: number, x: number, l = 0, a: any, r = '', w = String.fromCharCode, L = encodedString.length;\r\n            var A = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\r\n            for (i = 0; i < 64; i++) { e[A.charAt(i)] = i; }\r\n            for (x = 0; x < L; x++) {\r\n                c = e[encodedString.charAt(x)];\r\n                b = (b << 6) + c;\r\n                l += 6;\r\n                while (l >= 8) {\r\n                    ((a = (b >>> (l -= 8)) & 0xff) || (x < (L - 2))) && (r += w(a));\r\n                }\r\n            }\r\n            return r;\r\n        }\r\n\r\n        private generateNonce(): string {\r\n            var text = \"\";\r\n            var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n            for (var i = 0; i < 32; i++) {\r\n                text += chars.charAt(Math.floor(Math.random() * chars.length));\r\n            }\r\n            return text;\r\n        }\r\n    }\r\n\r\n\r\n\n\r\n    export class Graph {\r\n        public static foo = () => \"test\";\r\n        private req: XMLHttpRequest = null;\r\n        private accessToken: string = null;\r\n        private KurveIdentity: Identity = null;\r\n        private defaultResourceID: string = \"https://graph.microsoft.com\";\r\n        private baseUrl: string = \"https://graph.microsoft.com/v1.0\";\r\n\r\n        constructor(identityInfo: { identity: Identity });\r\n        constructor(identityInfo: { defaultAccessToken: string });\r\n        constructor(identityInfo: any) {\r\n            if (identityInfo.defaultAccessToken) {\r\n                this.accessToken = identityInfo.defaultAccessToken;\r\n            } else {\r\n                this.KurveIdentity = identityInfo.identity;\r\n            }\r\n        }\r\n\r\n        get me() { return new User(this, this.baseUrl); }\r\n        get users() { return new Users(this, this.baseUrl); }\r\n\r\n        public Get<Model, N extends Node>(path:string, self:N, scopes?:string[]): Promise<Singleton<Model, N>, Error> {\r\n            console.log(\"GET\", path, scopes);\r\n            var d = new Deferred<Singleton<Model, N>, Error>();\r\n\r\n            this.get(path, (error, result) => {\r\n                var jsonResult = JSON.parse(result) ;\r\n\r\n                if (jsonResult.error) {\r\n                    var errorODATA = new Error();\r\n                    errorODATA.other = jsonResult.error;\r\n                    d.reject(errorODATA);\r\n                    return;\r\n                }\r\n\r\n                d.resolve(new Singleton<Model, N>(jsonResult, self));\r\n            });\r\n\r\n            return d.promise;\r\n         }\r\n\r\n        public GetCollection<Model, N extends CollectionNode>(path:string, self:N, next:N, scopes?:string[]): Promise<Collection<Model, N>, Error> {\r\n            console.log(\"GET collection\", path, scopes);\r\n            var d = new Deferred<Collection<Model, N>, Error>();\r\n\r\n            this.get(path, (error, result) => {\r\n                var jsonResult = JSON.parse(result) ;\r\n\r\n                if (jsonResult.error) {\r\n                    var errorODATA = new Error();\r\n                    errorODATA.other = jsonResult.error;\r\n                    d.reject(errorODATA);\r\n                    return;\r\n                }\r\n\r\n                d.resolve(new Collection<Model,N>(jsonResult, self, next))\r\n            });\r\n\r\n            return d.promise;\r\n         }\r\n\r\n        public Post<Model, N extends Node>(object:Model, path:string, self:N, scopes?:string[]): Promise<Singleton<Model, N>, Error> {\r\n            console.log(\"POST\", path, scopes);\r\n            var d = new Deferred<Singleton<Model, N>, Error>();\r\n            \r\n/*\r\n            this.post(object, path, (error, result) => {\r\n                var jsonResult = JSON.parse(result) ;\r\n\r\n                if (jsonResult.error) {\r\n                    var errorODATA = new Error();\r\n                    errorODATA.other = jsonResult.error;\r\n                    d.reject(errorODATA);\r\n                    return;\r\n                }\r\n\r\n                d.resolve(new Response<Model, N>({}, self));\r\n            });\r\n*/\r\n            return d.promise;\r\n         }\r\n \r\n        //Only adds scopes when linked to a v2 Oauth of kurve identity\r\n        private scopesForV2(scopes: string[]): string[] {\r\n            if (!this.KurveIdentity)\r\n                return null;\r\n            if (this.KurveIdentity.getCurrentOauthVersion() === OAuthVersion.v1)\r\n                return null;\r\n            else return scopes;\r\n        }\r\n\r\n        public get(url: string, callback: PromiseCallback<string>, responseType?: string, scopes?:string[]): void {\r\n            var xhr = new XMLHttpRequest();\r\n            if (responseType)\r\n                xhr.responseType = responseType;\r\n            xhr.onreadystatechange = () => {\r\n                if (xhr.readyState === 4)\r\n                    if (xhr.status === 200)\r\n                        callback(null, responseType ? xhr.response : xhr.responseText);\r\n                    else\r\n                        callback(this.generateError(xhr));\r\n            }\r\n\r\n            xhr.open(\"GET\", url);\r\n            this.addAccessTokenAndSend(xhr, (addTokenError: Error) => {\r\n                if (addTokenError) {\r\n                    callback(addTokenError);\r\n                }\r\n            }, scopes);\r\n        }\r\n\r\n        public post(object:string, url: string, callback: PromiseCallback<string>, responseType?: string, scopes?:string[]): void {\r\n/*\r\n            var xhr = new XMLHttpRequest();\r\n            if (responseType)\r\n                xhr.responseType = responseType;\r\n            xhr.onreadystatechange = () => {\r\n                if (xhr.readyState === 4)\r\n                    if (xhr.status === 202)\r\n                        callback(null, responseType ? xhr.response : xhr.responseText);\r\n                    else\r\n                        callback(this.generateError(xhr));\r\n            }\r\n            xhr.send(object)\r\n            xhr.open(\"GET\", url);\r\n            this.addAccessTokenAndSend(xhr, (addTokenError: Error) => {\r\n                if (addTokenError) {\r\n                    callback(addTokenError);\r\n                }\r\n            }, scopes);\r\n*/\r\n        }\r\n\r\n        private generateError(xhr: XMLHttpRequest): Error {\r\n            var response = new Error();\r\n            response.status = xhr.status;\r\n            response.statusText = xhr.statusText;\r\n            if (xhr.responseType === '' || xhr.responseType === 'text')\r\n                response.text = xhr.responseText;\r\n            else\r\n                response.other = xhr.response;\r\n            return response;\r\n\r\n        }\r\n\r\n        private addAccessTokenAndSend(xhr: XMLHttpRequest, callback: (error: Error) => void, scopes?:string[]): void {\r\n            if (this.accessToken) {\r\n                //Using default access token\r\n                xhr.setRequestHeader('Authorization', 'Bearer ' + this.accessToken);\r\n                xhr.send();\r\n            } else {\r\n                //Using the integrated Identity object\r\n\r\n                if (scopes) {\r\n                    //v2 scope based tokens\r\n                    this.KurveIdentity.getAccessTokenForScopes(scopes,false, ((token: string, error: Error) => {\r\n                        if (error)\r\n                            callback(error);\r\n                        else {\r\n                            xhr.setRequestHeader('Authorization', 'Bearer ' + token);\r\n                            xhr.send();\r\n                            callback(null);\r\n                        }\r\n                    }));\r\n\r\n                }\r\n                else {\r\n                    //v1 resource based tokens\r\n                    this.KurveIdentity.getAccessToken(this.defaultResourceID, ((error: Error, token: string) => {\r\n                        if (error)\r\n                            callback(error);\r\n                        else {\r\n                            xhr.setRequestHeader('Authorization', 'Bearer ' + token);\r\n                            xhr.send();\r\n                            callback(null);\r\n                        }\r\n                    }));\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n\r\n\n\r\n\r\nexport interface ItemBody {\r\n    contentType?: string;\r\n    content?: string;\r\n}\r\n\r\nexport interface EmailAddress {\r\n    name?: string;\r\n    address?: string;\r\n}\r\n\r\nexport interface Recipient {\r\n    emailAddress?: EmailAddress;\r\n}\r\n\r\nexport interface UserDataModel {\r\n    businessPhones?: string;\r\n    displayName?: string;\r\n    givenName?: string;\r\n    jobTitle?: string;\r\n    mail?: string;\r\n    mobilePhone?: string;\r\n    officeLocation?: string;\r\n    preferredLanguage?: string;\r\n    surname?: string;\r\n    userPrincipalName?: string;\r\n    id?: string;\r\n}\r\n\r\nexport interface ProfilePhotoDataModel {\r\n    id?: string;\r\n    height?: Number;\r\n    width?: Number;\r\n}\r\n\r\nexport interface MessageDataModel {\r\n    attachments?: AttachmentDataModel[];\r\n    bccRecipients?: Recipient[];\r\n    body?: ItemBody;\r\n    bodyPreview?: string;\r\n    categories?: string[]\r\n    ccRecipients?: Recipient[];\r\n    changeKey?: string;\r\n    conversationId?: string;\r\n    createdDateTime?: string;\r\n    from?: Recipient;\r\n    graph?: any;\r\n    hasAttachments?: boolean;\r\n    id?: string;\r\n    importance?: string;\r\n    isDeliveryReceiptRequested?: boolean;\r\n    isDraft?: boolean;\r\n    isRead?: boolean;\r\n    isReadReceiptRequested?: boolean;\r\n    lastModifiedDateTime?: string;\r\n    parentFolderId?: string;\r\n    receivedDateTime?: string;\r\n    replyTo?: Recipient[]\r\n    sender?: Recipient;\r\n    sentDateTime?: string;\r\n    subject?: string;\r\n    toRecipients?: Recipient[];\r\n    webLink?: string;\r\n}\r\n\r\nexport interface Attendee {\r\n    status?: ResponseStatus;\r\n    type?: string;\r\n    emailAddress?: EmailAddress;\r\n}\r\n\r\nexport interface DateTimeTimeZone {\r\n    dateTime?: string;\r\n    timeZone?: string;\r\n}\r\n\r\nexport interface PatternedRecurrence { }\r\n\r\nexport interface ResponseStatus {\r\n    response?: string;\r\n    time?: string\r\n}\r\n\r\nexport interface Location {\r\n    displayName?: string;\r\n    address?: any;\r\n}\r\n\r\nexport interface EventDataModel {\r\n    attendees?: Attendee[];\r\n    body?: ItemBody;\r\n    bodyPreview?: string;\r\n    categories?: string[];\r\n    changeKey?: string;\r\n    createdDateTime?: string;\r\n    end?: DateTimeTimeZone;\r\n    hasAttachments?: boolean;\r\n    iCalUId?: string;\r\n    id?: string;\r\n    IDBCursor?: string;\r\n    importance?: string;\r\n    isAllDay?: boolean;\r\n    isCancelled?: boolean;\r\n    isOrganizer?: boolean;\r\n    isReminderOn?: boolean;\r\n    lastModifiedDateTime?: string;\r\n    location?: Location;\r\n    organizer?: Recipient;\r\n    originalEndTimeZone?: string;\r\n    originalStartTimeZone?: string;\r\n    recurrence?: PatternedRecurrence;\r\n    reminderMinutesBeforeStart?: number;\r\n    responseRequested?: boolean;\r\n    responseStatus?: ResponseStatus;\r\n    sensitivity?: string;\r\n    seriesMasterId?: string;\r\n    showAs?: string;\r\n    start?: DateTimeTimeZone;\r\n    subject?: string;\r\n    type?: string;\r\n    webLink?: string;\r\n}\r\n\r\nexport interface GroupDataModel {\r\n    id?: string;\r\n    description?: string;\r\n    displayName?: string;\r\n    groupTypes?: string[];\r\n    mail?: string;\r\n    mailEnabled?: Boolean;\r\n    mailNickname?: string;\r\n    onPremisesLastSyncDateTime?: Date;\r\n    onPremisesSecurityIdentifier?: string;\r\n    onPremisesSyncEnabled?: Boolean;\r\n    proxyAddresses?: string[];\r\n    securityEnabled?: Boolean;\r\n    visibility?: string;\r\n}\r\n\r\nexport interface MailFolderDataModel {\r\n    id?: string;\r\n    displayName?: string;\r\n    childFolderCount?: number;\r\n    unreadItemCount?: number;\r\n    totalItemCount?: number;\r\n}\r\n\r\nexport interface AttachmentDataModel {\r\n    contentId?: string;\r\n    id?: string;\r\n    isInline?: boolean;\r\n    lastModifiedDateTime?: Date;\r\n    name?: string;\r\n    size?: number;\r\n\r\n    /* File Attachments */\r\n    contentBytes?: string;\r\n    contentLocation?: string;\r\n    contentType?: string;\r\n}\r\n\r\n\n\r\n\r\n/*\r\n\r\nRequestBuilder allows you to discover and access the Microsoft Graph using Visual Studio Code intellisense.\r\n\r\nJust start typing and see how intellisense helps you explore the graph:\r\n\r\n    graph.                      me, users\r\n    graph.me.                   events, messages, calendarView, mailFolders, GetUser, odata, select, ...\r\n    graph.me.events.            GetEvents, $, odata, select, ...\r\n    graph.me.events.$           (eventId:string) => Event\r\n    graph.me.events.$(\"123\").   GetEvent, odata, select, ...\r\n\r\nEach endpoint exposes the set of available Graph operations through strongly typed methods:\r\n\r\n    graph.me.GetUser() => UserDataModel\r\n        GET \"/me\"\r\n    graph.me.events.GetEvents => EventDataModel[]\r\n        GET \"/me/events\"\r\n    graph.me.events.CreateEvent(event:EventDataModel) \r\n        POST \"/me/events\"\r\n\r\nCertain Graph endpoints are implemented as OData \"Functions\". These are not treated as Graph nodes. They're just methods: \r\n\r\n    graph.me.events.$(\"123\").DeclineEvent(eventResponse:EventResponse)\r\n        POST \"/me/events/123/microsoft.graph.decline\r\n\r\nGraph operations are exposed through Promises:\r\n\r\n    graph.me.messages\r\n    .GetMessages()\r\n    .then(collection =>\r\n        collection.items.forEach(message =>\r\n            console.log(message.subject)\r\n        )\r\n    )\r\n\r\nAll operations return a \"self\" property which allows you to continue along the Graph path from the point where you left off:\r\n\r\n    graph.me.messages.$(\"123\").GetMessage().then(singleton =>\r\n        console.log(singleton.item.subject);\r\n        singleton.self.attachments.GetAttachments().then(collection => // singleton.self === graph.me.messages.$(\"123\")\r\n            collection.items.forEach(attachment => \r\n                console.log(attachment.contentBytes)\r\n            )\r\n        )\r\n    )\r\n\r\nOperations which return paginated collections can return a \"next\" request object. This can be utilized in a recursive function:\r\n\r\n    ListMessageSubjects(messages:Messages) {\r\n        messages.GetMessages().then(collection => {\r\n            collection.items.forEach(message => console.log(message.subject));\r\n            if (collection.next)\r\n                ListMessageSubjects(collection.next);\r\n        })\r\n    }\r\n    ListMessageSubjects(graph.me.messages);\r\n\r\nEvery Graph operation may include OData queries:\r\n\r\n    graph.me.messages.GetMessages(\"$select=subject,id&$orderby=id\")\r\n        /me/messages/$select=subject,id&$orderby=id\r\n\r\nThere is an optional OData helper to aid in constructing more complex queries:\r\n\r\n    graph.me.messages.GetMessages(new OData()\r\n        .select(\"subject\", \"id\")\r\n        .orderby(\"id\")\r\n    )\r\n        /me/messages/$select=subject,id&$orderby=id\r\n\r\nSome operations include parameters which transform into OData queries \r\n\r\n    graph.me.calendarView.GetCalendarView([start],[end], [odataQuery])\r\n        /me/calendarView?startDateTime=[start]&endDateTime=[end]&[odataQuery]\r\n\r\nNote: This initial stab only includes a few familiar pieces of the Microsoft Graph.\r\n*/\r\n\r\n//import { Promise,Error } from \"./promises\";\r\n//import { Graph } from \"./graph\";\r\n//import { Error } from \"./identity\";\r\n//import { UserDataModel, AttachmentDataModel, MessageDataModel, EventDataModel, MailFolderDataModel } from './models';\r\n\r\nexport class Scopes {\r\n    private static rootUrl = \"https://graph.microsoft.com/\";\r\n    static General = {\r\n        OpenId: \"openid\",\r\n        OfflineAccess: \"offline_access\",\r\n    }\r\n    static User = {\r\n        Read: Scopes.rootUrl + \"User.Read\",\r\n        ReadAll: Scopes.rootUrl + \"User.Read.All\",\r\n        ReadWrite: Scopes.rootUrl + \"User.ReadWrite\",\r\n        ReadWriteAll: Scopes.rootUrl + \"User.ReadWrite.All\",\r\n        ReadBasicAll: Scopes.rootUrl + \"User.ReadBasic.All\",\r\n    }\r\n    static Contacts = {\r\n        Read: Scopes.rootUrl + \"Contacts.Read\",\r\n        ReadWrite: Scopes.rootUrl + \"Contacts.ReadWrite\",\r\n    }\r\n    static Directory = {\r\n        ReadAll: Scopes.rootUrl + \"Directory.Read.All\",\r\n        ReadWriteAll: Scopes.rootUrl + \"Directory.ReadWrite.All\",\r\n        AccessAsUserAll: Scopes.rootUrl + \"Directory.AccessAsUser.All\",\r\n    }\r\n    static Group = {\r\n        ReadAll: Scopes.rootUrl + \"Group.Read.All\",\r\n        ReadWriteAll: Scopes.rootUrl + \"Group.ReadWrite.All\",\r\n        AccessAsUserAll: Scopes.rootUrl + \"Directory.AccessAsUser.All\"\r\n    }\r\n    static Mail = {\r\n        Read: Scopes.rootUrl + \"Mail.Read\",\r\n        ReadWrite: Scopes.rootUrl + \"Mail.ReadWrite\",\r\n        Send: Scopes.rootUrl + \"Mail.Send\",\r\n    }\r\n    static Calendars = {\r\n        Read: Scopes.rootUrl + \"Calendars.Read\",\r\n        ReadWrite: Scopes.rootUrl + \"Calendars.ReadWrite\",\r\n    }\r\n    static Files = {\r\n        Read: Scopes.rootUrl + \"Files.Read\",\r\n        ReadAll: Scopes.rootUrl + \"Files.Read.All\",\r\n        ReadWrite: Scopes.rootUrl + \"Files.ReadWrite\",\r\n        ReadWriteAppFolder: Scopes.rootUrl + \"Files.ReadWrite.AppFolder\",\r\n        ReadWriteSelected: Scopes.rootUrl + \"Files.ReadWrite.Selected\",\r\n    }\r\n    static Tasks = {\r\n        ReadWrite: Scopes.rootUrl + \"Tasks.ReadWrite\",\r\n    }\r\n    static People = {\r\n        Read: Scopes.rootUrl + \"People.Read\",\r\n        ReadWrite: Scopes.rootUrl + \"People.ReadWrite\",\r\n    }\r\n    static Notes = {\r\n        Create: Scopes.rootUrl + \"Notes.Create\",\r\n        ReadWriteCreatedByApp: Scopes.rootUrl + \"Notes.ReadWrite.CreatedByApp\",\r\n        Read: Scopes.rootUrl + \"Notes.Read\",\r\n        ReadAll: Scopes.rootUrl + \"Notes.Read.All\",\r\n        ReadWriteAll: Scopes.rootUrl + \"Notes.ReadWrite.All\",\r\n    }\r\n}\r\n\r\nlet queryUnion = (query1:string, query2:string) => (query1 ? query1 + (query2 ? \"&\" + query2 : \"\" ) : query2); \r\n\r\nexport class OData {\r\n    constructor(public query?:string) {\r\n    }\r\n    \r\n    toString = () => this.query;\r\n\r\n    odata = (query:string) => {\r\n        this.query = queryUnion(this.query, query);\r\n        return this;\r\n    }\r\n\r\n    select   = (...fields:string[])  => this.odata(`$select=${fields.join(\",\")}`);\r\n    expand   = (...fields:string[])  => this.odata(`$expand=${fields.join(\",\")}`);\r\n    filter   = (query:string)        => this.odata(`$filter=${query}`);\r\n    orderby  = (...fields:string[])  => this.odata(`$orderby=${fields.join(\",\")}`);\r\n    top      = (items:Number)        => this.odata(`$top=${items}`);\r\n    skip     = (items:Number)        => this.odata(`$skip=${items}`);\r\n}\r\n\r\ntype ODataQuery = OData | string;\r\n\r\nlet pathWithQuery = (path:string, odataQuery?:ODataQuery) => {\r\n    let query = odataQuery && odataQuery.toString();\r\n    return path + (query ? \"?\" + query : \"\");\r\n}\r\n\r\nexport class Singleton<Model, N extends Node> {\r\n    constructor(public raw:any, public self:N) {\r\n    }\r\n\r\n    get item() {\r\n        return this.raw;\r\n    }\r\n}\r\n\r\nexport class Collection<Model, N extends CollectionNode> {\r\n    constructor(public raw:any, public self:N, public next:N) {\r\n        let nextLink = this.raw[\"@odata.nextLink\"];\r\n        if (nextLink) {\r\n            this.next.nextLink = nextLink;\r\n        } else {\r\n            this.next = undefined;\r\n        }\r\n    }\r\n\r\n    get items() {\r\n        return (this.raw.value ? this.raw.value : [this.raw]);\r\n    }\r\n}\r\n\r\nexport class Node {\r\n    constructor(protected graph:Graph, protected path:string) {\r\n    }\r\n\r\n    pathWithQuery = (odataQuery?:ODataQuery, pathSuffix:string = \"\") => pathWithQuery(this.path + pathSuffix, odataQuery);\r\n}\r\n\r\nexport class CollectionNode extends Node {    \r\n    private _nextLink:string;   // this is only set when the collection in question is from a nextLink\r\n\r\n    pathWithQuery = (odataQuery?:ODataQuery, pathSuffix:string = \"\") => this._nextLink || pathWithQuery(this.path + pathSuffix, odataQuery);\r\n    \r\n    set nextLink(pathWithQuery:string) {\r\n        this._nextLink = pathWithQuery;\r\n    }\r\n}\r\n\r\nexport class Attachment extends Node {\r\n    constructor(graph:Graph, path:string, private context:string, attachmentId?:string) {\r\n        super(graph, path + (attachmentId ? \"/\" + attachmentId : \"\"));\r\n    }\r\n\r\n    static scopes = {\r\n        messages: [Scopes.Mail.Read],\r\n        events: [Scopes.Calendars.Read],\r\n    }\r\n\r\n    GetAttachment = (odataQuery?:ODataQuery) => this.graph.Get<AttachmentDataModel, Attachment>(this.pathWithQuery(odataQuery), this, Attachment.scopes[this.context]);\r\n/*    \r\n    PATCH = this.graph.PATCH<AttachmentDataModel>(this.path, this.query);\r\n    DELETE = this.graph.DELETE<AttachmentDataModel>(this.path, this.query);\r\n*/\r\n}\r\n\r\nexport class Attachments extends CollectionNode {\r\n    constructor(graph:Graph, path:string, private context:string) {\r\n        super(graph, path + \"/attachments\");\r\n    }\r\n\r\n    $ = (attachmentId:string) => new Attachment(this.graph, this.path, this.context, attachmentId);\r\n    \r\n    GetAttachments = (odataQuery?:ODataQuery) => this.graph.GetCollection<AttachmentDataModel, Attachments>(this.pathWithQuery(odataQuery), this, new Attachments(this.graph, null, this.context), Attachment.scopes[this.context]);\r\n/*\r\n    POST = this.graph.POST<AttachmentDataModel>(this.path, this.query);\r\n*/\r\n}\r\n\r\nexport class Message extends Node {\r\n    constructor(graph:Graph, path:string=\"\", messageId?:string) {\r\n        super(graph, path + (messageId ? \"/\" + messageId : \"\"));\r\n    }\r\n    \r\n    get attachments() { return new Attachments(this.graph, this.path, \"messages\"); }\r\n\r\n    GetMessage  = (odataQuery?:ODataQuery) => this.graph.Get<MessageDataModel, Message>(this.pathWithQuery(odataQuery), this, [Scopes.Mail.Read]);\r\n    SendMessage = (odataQuery?:ODataQuery) => this.graph.Post<MessageDataModel, Message>(null, this.pathWithQuery(odataQuery, \"/microsoft.graph.sendMail\"), this, [Scopes.Mail.Send]);\r\n/*\r\n    PATCH = this.graph.PATCH<MessageDataModel>(this.path, this.query);\r\n    DELETE = this.graph.DELETE<MessageDataModel>(this.path, this.query);\r\n*/\r\n}\r\n\r\nexport class Messages extends CollectionNode {\r\n    constructor(graph:Graph, path:string=\"\") {\r\n        super(graph, path + \"/messages\");\r\n    }\r\n\r\n    $ = (messageId:string) => new Message(this.graph, this.path, messageId);\r\n\r\n    GetMessages     = (odataQuery?:ODataQuery) => this.graph.GetCollection<MessageDataModel, Messages>(this.pathWithQuery(odataQuery), this, new Messages(this.graph), [Scopes.Mail.Read, Scopes.Mail.ReadWrite]);\r\n    CreateMessage   = (object:MessageDataModel, odataQuery?:ODataQuery) => this.graph.Post<MessageDataModel, Messages>(object, this.pathWithQuery(odataQuery), this, [Scopes.Mail.ReadWrite]);\r\n}\r\n\r\nexport class Event extends Node {\r\n    constructor(graph:Graph, path:string, eventId:string) {\r\n        super(graph, path + (eventId ? \"/\" + eventId : \"\"));\r\n    }\r\n\r\n    get attachments() { return new Attachments(this.graph, this.path, \"events\"); }\r\n\r\n    GetEvent = (odataQuery?:ODataQuery) => this.graph.Get<EventDataModel, Event>(this.pathWithQuery(odataQuery), this, [Scopes.Calendars.Read]);\r\n/*\r\n    PATCH = this.graph.PATCH<EventDataModel>(this.path, this.query);\r\n    DELETE = this.graph.DELETE<EventDataModel>(this.path, this.query);\r\n*/\r\n}\r\n\r\nlet eventsScopes = [Scopes.Calendars.Read, Scopes.Calendars.ReadWrite];\r\n\r\nexport class Events extends CollectionNode {\r\n    constructor(graph:Graph, path:string=\"\") {\r\n        super(graph, path + \"/events\");\r\n    }\r\n\r\n    $ = (eventId:string) => new Event(this.graph, this.path, eventId);\r\n\r\n    GetEvents = (odataQuery?:ODataQuery) => this.graph.GetCollection<EventDataModel, Events>(this.pathWithQuery(odataQuery), this, new Events(this.graph), eventsScopes);\r\n/*\r\n    POST = this.graph.POST<EventDataModel>(this.path, this.query);\r\n*/\r\n}\r\n\r\nexport class CalendarView extends CollectionNode {\r\n    constructor(graph:Graph, path:string=\"\") {\r\n        super(graph, path + \"/calendarView\");\r\n    }\r\n    \r\n    dateRange = (startDate:Date, endDate:Date) => `startDateTime=${startDate.toISOString()}&endDateTime=${endDate.toISOString()}`\r\n\r\n    GetCalendarView = (odataQuery?:ODataQuery) => this.graph.GetCollection<EventDataModel, CalendarView>(this.pathWithQuery(odataQuery), this, new CalendarView(this.graph), eventsScopes);\r\n}\r\n\r\nlet mailFolderScopes = [Scopes.Mail.Read, Scopes.Mail.ReadWrite];\r\n\r\nexport class MailFolder extends Node {\r\n    constructor(graph:Graph, path:string, mailFolderId:string) {\r\n        super(graph, path + (mailFolderId ? \"/\" + mailFolderId : \"\"));\r\n    }\r\n\r\n\r\n    GetMailFolder = (odataQuery?:ODataQuery) => this.graph.Get<MailFolderDataModel, MailFolder>(this.pathWithQuery(odataQuery), this, mailFolderScopes);\r\n}\r\n\r\nexport class MailFolders extends CollectionNode {\r\n    constructor(graph:Graph, path:string=\"\") {\r\n        super(graph, path + \"/mailFolders\");\r\n    }\r\n\r\n    $ = (mailFolderId:string) => new MailFolder(this.graph, this.path, mailFolderId);\r\n\r\n    GetMailFolders = (odataQuery?:ODataQuery) => this.graph.GetCollection<MailFolderDataModel, MailFolders>(this.pathWithQuery(odataQuery), this, new MailFolders(this.graph), mailFolderScopes);\r\n}\r\n\r\nlet usersScopes = [Scopes.User.ReadBasicAll, Scopes.User.ReadAll, Scopes.User.ReadWriteAll, Scopes.Directory.ReadAll, Scopes.Directory.ReadWriteAll, Scopes.Directory.AccessAsUserAll];\r\nlet userScopes = usersScopes.concat([Scopes.User.Read, Scopes.User.ReadWrite]);\r\n\r\nexport class User extends Node {\r\n    constructor(protected graph:Graph, path:string=\"\", userId?:string) {\r\n        super(graph, userId ? path + \"/\" + userId : path + \"/me\");\r\n        console.log(\"Graph.foo\", Graph.foo);\r\n    }\r\n\r\n    get messages()      { return new Messages(this.graph, this.path); }\r\n    get events()        { return new Events(this.graph, this.path); }\r\n    get calendarView()  { return new CalendarView(this.graph, this.path); }\r\n    get mailFolders()   { return new MailFolders(this.graph, this.path) }\r\n\r\n    GetUser = (odataQuery?:ODataQuery) => this.graph.Get<UserDataModel, User>(this.pathWithQuery(odataQuery), this, userScopes);\r\n/*\r\n    PATCH = this.graph.PATCH<UserDataModel>(this.path, this.query);\r\n    DELETE = this.graph.DELETE<UserDataModel>(this.path, this.query);\r\n*/\r\n}\r\n\r\nexport class Users extends CollectionNode {\r\n    constructor(graph:Graph, path:string=\"\") {\r\n        super(graph, path + \"/users\");\r\n    }\r\n\r\n    $ = (userId:string) => new User(this.graph, this.path, userId);\r\n\r\n    GetUsers = (odataQuery:ODataQuery) => this.graph.GetCollection<UserDataModel, Users>(this.pathWithQuery(odataQuery), this, new Users(this.graph), userScopes);\r\n/*\r\n    CreateUser = this.graph.POST<UserDataModel>(this.path, this.query);\r\n*/\r\n}\r\n\r\n}\r\n\r\n//*********************************************************\r\n//\r\n//Kurve js, https://github.com/microsoftdx/kurvejs\r\n//\r\n//Copyright (c) Microsoft Corporation\r\n//All rights reserved.\r\n//\r\n// MIT License:\r\n// Permission is hereby granted, free of charge, to any person obtaining\r\n// a copy of this software and associated documentation files (the\r\n// \"\"Software\"\"), to deal in the Software without restriction, including\r\n// without limitation the rights to use, copy, modify, merge, publish,\r\n// distribute, sublicense, and/or sell copies of the Software, and to\r\n// permit persons to whom the Software is furnished to do so, subject to\r\n// the following conditions:\r\n\r\n\r\n\r\n\r\n// The above copyright notice and this permission notice shall be\r\n// included in all copies or substantial portions of the Software.\r\n\r\n\r\n\r\n\r\n// THE SOFTWARE IS PROVIDED \"\"AS IS\"\", WITHOUT WARRANTY OF ANY KIND,\r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF\r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\r\n// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE\r\n// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION\r\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION\r\n// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\r\n//\r\n//*********************************************************\r\n\r\n"],"sourceRoot":"/source/"}