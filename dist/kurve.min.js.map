{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///dist/kurve.min.js","webpack:///webpack/bootstrap 2d27f8fa67d02ff43a20","webpack:///./src/kurve.ts","webpack:///./src/graph.ts","webpack:///./src/promises.ts","webpack:///./src/identity.ts","webpack:///./src/requestbuilder.ts"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","__export","hasOwnProperty","Scopes","__extends","d","b","__","constructor","prototype","Object","create","promises_1","identity_1","requestbuilder_1","Util","rootUrl","General","OpenId","OfflineAccess","User","Read","ReadWrite","ReadBasicAll","ReadAll","ReadWriteAll","Contacts","Directory","AccessAsUserAll","Group","Mail","Send","Calendars","Files","ReadWriteAppFolder","ReadWriteSelected","Tasks","People","Notes","Create","ReadWriteCreatedByApp","DataModelWrapper","graph","_data","defineProperty","get","enumerable","configurable","DataModelListWrapper","_super","apply","arguments","ProfilePhoto","EventsEndpoint","events","callback","odataQuery","eventsForUser","userPrincipalName","eventsAsync","eventsForUserAsync","memberOf","Error","memberOfForUser","memberOfAsync","memberOfForUserAsync","messages","messagesForUser","messagesAsync","messagesForUserAsync","manager","managerForUser","managerAsync","managerForUserAsync","profilePhoto","profilePhotoForUser","profilePhotoAsync","profilePhotoForUserAsync","profilePhotoValue","profilePhotoValueForUser","profilePhotoValueAsync","profilePhotoValueForUserAsync","calendarView","calendarViewAsync","mailFolders","mailFoldersForUser","mailFoldersAsync","mailFoldersForUserAsync","message","messageId","messageForUser","messageAsync","messageForUserAsync","event","eventId","eventForUser","eventAsync","eventForUserAsync","messageAttachment","attachmentId","messageAttachmentForUser","messageAttachmentAsync","messageAttachmentForUserAsync","Users","Message","Messages","Event","Events","endpoint","Contact","Groups","MailFolder","MailFolders","AttachmentType","Attachment","getType","fileAttachment","itemAttachment","referenceAttachment","Attachments","Graph","identityInfo","req","accessToken","KurveIdentity","defaultResourceID","baseUrl","defaultAccessToken","identity","scopesForV2","scopes","getCurrentOauthVersion","OAuthVersion","v1","meAsync","Deferred","me","error","user","reject","resolve","promise","_this","endpointGet","Root","then","result","fail","userAsync","userId","basicProfileOnly","urlString","buildUsersUrl","getUser","usersAsync","users","getUsers","groupAsync","groupId","group","buildGroupsUrl","getGroup","groupsAsync","groups","getGroups","getMessage","getMessages","getMailFolders","getEvent","getEvents","directReportsForUserAsync","directReportsForUser","getPhoto","getPhotoValue","messageAttachmentsForUserAsync","messageAttachmentsForUser","getMessageAttachments","attachment","getMessageAttachment","getAsync","url","response","responseType","xhr","XMLHttpRequest","onreadystatechange","readyState","status","responseText","generateError","open","addAccessTokenAndSend","addTokenError","statusText","text","other","pathWithQuery","jsonResult","JSON","parse","errorODATA","errorGet","usersODATA","resultsArray","value","map","o","nextLink","userODATA","setRequestHeader","send","getAccessTokenForScopes","token","getAccessToken","ODATA","ODATAError","messagesODATA","EventId","odata","groupsODATA","photo","attachmentsODATA","attachments","buildUrl","path","buildMeUrl","DispatchDeferred","closure","setTimeout","PromiseState","Client","_dispatcher","_successCB","_errorCB","defer","_dispatchCallback","arg","err","dispatcher","_stack","_state","Pending","Promise","successCB","errorCB","client","ResolutionInProgress","push","Resolved","_value","Rejected","_error","_resolve","type","pending","i","stackSize","length","splice","TypeError","_reject","_deferred","successCallback","errorCallback","undefined","CachedToken","resource","expiry","Date","getTime","hasScopes","requiredScopes","every","requiredScope","some","actualScope","TokenCache","tokenStorage","cachedTokens","getAll","forEach","_a","cachedToken","isExpired","remove","add","getForResource","getForScopes","key","clear","IdToken","Identity","identitySettings","policy","clientId","tokenProcessorUrl","tokenProcessingUri","version","tokenCache","window","addEventListener","data","e","loginCallback","state","decodeIdToken","getTokenCallback","iframe","document","getElementById","parentNode","removeChild","checkForIdentityRedirect","s","start","location","href","indexOf","end","substring","parseQueryString","str","queryString","search","keyValPairs","params","replace","split","pairNum","idToken","decodedToken","base64Decode","lastIndexOf","decodedTokenJSON","expiryDate","parseInt","exp","FullToken","Token","Expiry","UPN","upn","TenantId","tid","FamilyName","family_name","GivenName","given_name","Name","name","PreferredUsername","preferred_username","expiration","refreshTimer","renewIdToken","decodeAccessToken","join","getIdToken","isLoggedIn","clearTimeout","login","getAccessTokenAsync","nonce","generateNonce","createElement","style","display","src","encodeURIComponent","toString","body","appendChild","getAccessTokenForScopesAsync","promptForConsent","v2","loginAsync","loginSettings","tenant","loginURL","loginNoWindowAsync","toUrl","loginNoWindow","redirected","redirectUri","logOut","encodeURI","encodedString","x","a","l","r","w","String","fromCharCode","L","A","charAt","chars","Math","floor","random","queryUnion","query1","query2","Action","query","Endpoint","addQuery","AddQuery","actions","verb","GET","GETCOLLECTION","POST","CalendarView","startDate","endDate","MockGraph","getUntypedCollection","getTypedCollection","getUntyped","getCollection","action","console","log","getTyped","postUntyped","request","postTyped","post","patchUntyped","patchTyped","patch","PATCH","deleteUntyped","deleteTyped","DELETE"],"mappings":"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","file":"dist/kurve.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Kurve\"] = factory();\n\telse\n\t\troot[\"Kurve\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Kurve\"] = factory();\n\telse\n\t\troot[\"Kurve\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tfunction __export(m) {\r\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n\t}\r\n\t__export(__webpack_require__(1));\r\n\t__export(__webpack_require__(3));\r\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar __extends = (this && this.__extends) || function (d, b) {\r\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\r\n\t    function __() { this.constructor = d; }\r\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n\t};\r\n\tvar promises_1 = __webpack_require__(2);\r\n\tvar identity_1 = __webpack_require__(3);\r\n\tvar requestbuilder_1 = __webpack_require__(4);\r\n\tvar Scopes;\r\n\t(function (Scopes) {\r\n\t    var Util = (function () {\r\n\t        function Util() {\r\n\t        }\r\n\t        Util.rootUrl = \"https://graph.microsoft.com/\";\r\n\t        return Util;\r\n\t    }());\r\n\t    var General = (function () {\r\n\t        function General() {\r\n\t        }\r\n\t        General.OpenId = \"openid\";\r\n\t        General.OfflineAccess = \"offline_access\";\r\n\t        return General;\r\n\t    }());\r\n\t    Scopes.General = General;\r\n\t    var User = (function () {\r\n\t        function User() {\r\n\t        }\r\n\t        User.Read = Util.rootUrl + \"User.Read\";\r\n\t        User.ReadWrite = Util.rootUrl + \"User.ReadWrite\";\r\n\t        User.ReadBasicAll = Util.rootUrl + \"User.ReadBasic.All\";\r\n\t        User.ReadAll = Util.rootUrl + \"User.Read.All\";\r\n\t        User.ReadWriteAll = Util.rootUrl + \"User.ReadWrite.All\";\r\n\t        return User;\r\n\t    }());\r\n\t    Scopes.User = User;\r\n\t    var Contacts = (function () {\r\n\t        function Contacts() {\r\n\t        }\r\n\t        Contacts.Read = Util.rootUrl + \"Contacts.Read\";\r\n\t        Contacts.ReadWrite = Util.rootUrl + \"Contacts.ReadWrite\";\r\n\t        return Contacts;\r\n\t    }());\r\n\t    Scopes.Contacts = Contacts;\r\n\t    var Directory = (function () {\r\n\t        function Directory() {\r\n\t        }\r\n\t        Directory.ReadAll = Util.rootUrl + \"Directory.Read.All\";\r\n\t        Directory.ReadWriteAll = Util.rootUrl + \"Directory.ReadWrite.All\";\r\n\t        Directory.AccessAsUserAll = Util.rootUrl + \"Directory.AccessAsUser.All\";\r\n\t        return Directory;\r\n\t    }());\r\n\t    Scopes.Directory = Directory;\r\n\t    var Group = (function () {\r\n\t        function Group() {\r\n\t        }\r\n\t        Group.ReadAll = Util.rootUrl + \"Group.Read.All\";\r\n\t        Group.ReadWriteAll = Util.rootUrl + \"Group.ReadWrite.All\";\r\n\t        Group.AccessAsUserAll = Util.rootUrl + \"Directory.AccessAsUser.All\";\r\n\t        return Group;\r\n\t    }());\r\n\t    Scopes.Group = Group;\r\n\t    var Mail = (function () {\r\n\t        function Mail() {\r\n\t        }\r\n\t        Mail.Read = Util.rootUrl + \"Mail.Read\";\r\n\t        Mail.ReadWrite = Util.rootUrl + \"Mail.ReadWrite\";\r\n\t        Mail.Send = Util.rootUrl + \"Mail.Send\";\r\n\t        return Mail;\r\n\t    }());\r\n\t    Scopes.Mail = Mail;\r\n\t    var Calendars = (function () {\r\n\t        function Calendars() {\r\n\t        }\r\n\t        Calendars.Read = Util.rootUrl + \"Calendars.Read\";\r\n\t        Calendars.ReadWrite = Util.rootUrl + \"Calendars.ReadWrite\";\r\n\t        return Calendars;\r\n\t    }());\r\n\t    Scopes.Calendars = Calendars;\r\n\t    var Files = (function () {\r\n\t        function Files() {\r\n\t        }\r\n\t        Files.Read = Util.rootUrl + \"Files.Read\";\r\n\t        Files.ReadAll = Util.rootUrl + \"Files.Read.All\";\r\n\t        Files.ReadWrite = Util.rootUrl + \"Files.ReadWrite\";\r\n\t        Files.ReadWriteAppFolder = Util.rootUrl + \"Files.ReadWrite.AppFolder\";\r\n\t        Files.ReadWriteSelected = Util.rootUrl + \"Files.ReadWrite.Selected\";\r\n\t        return Files;\r\n\t    }());\r\n\t    Scopes.Files = Files;\r\n\t    var Tasks = (function () {\r\n\t        function Tasks() {\r\n\t        }\r\n\t        Tasks.ReadWrite = Util.rootUrl + \"Tasks.ReadWrite\";\r\n\t        return Tasks;\r\n\t    }());\r\n\t    Scopes.Tasks = Tasks;\r\n\t    var People = (function () {\r\n\t        function People() {\r\n\t        }\r\n\t        People.Read = Util.rootUrl + \"People.Read\";\r\n\t        People.ReadWrite = Util.rootUrl + \"People.ReadWrite\";\r\n\t        return People;\r\n\t    }());\r\n\t    Scopes.People = People;\r\n\t    var Notes = (function () {\r\n\t        function Notes() {\r\n\t        }\r\n\t        Notes.Create = Util.rootUrl + \"Notes.Create\";\r\n\t        Notes.ReadWriteCreatedByApp = Util.rootUrl + \"Notes.ReadWrite.CreatedByApp\";\r\n\t        Notes.Read = Util.rootUrl + \"Notes.Read\";\r\n\t        Notes.ReadAll = Util.rootUrl + \"Notes.Read.All\";\r\n\t        Notes.ReadWriteAll = Util.rootUrl + \"Notes.ReadWrite.All\";\r\n\t        return Notes;\r\n\t    }());\r\n\t    Scopes.Notes = Notes;\r\n\t})(Scopes = exports.Scopes || (exports.Scopes = {}));\r\n\tvar DataModelWrapper = (function () {\r\n\t    function DataModelWrapper(graph, _data) {\r\n\t        this.graph = graph;\r\n\t        this._data = _data;\r\n\t    }\r\n\t    Object.defineProperty(DataModelWrapper.prototype, \"data\", {\r\n\t        get: function () { return this._data; },\r\n\t        enumerable: true,\r\n\t        configurable: true\r\n\t    });\r\n\t    return DataModelWrapper;\r\n\t}());\r\n\texports.DataModelWrapper = DataModelWrapper;\r\n\tvar DataModelListWrapper = (function (_super) {\r\n\t    __extends(DataModelListWrapper, _super);\r\n\t    function DataModelListWrapper() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    return DataModelListWrapper;\r\n\t}(DataModelWrapper));\r\n\texports.DataModelListWrapper = DataModelListWrapper;\r\n\tvar ProfilePhoto = (function (_super) {\r\n\t    __extends(ProfilePhoto, _super);\r\n\t    function ProfilePhoto() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    return ProfilePhoto;\r\n\t}(DataModelWrapper));\r\n\texports.ProfilePhoto = ProfilePhoto;\r\n\t(function (EventsEndpoint) {\r\n\t    EventsEndpoint[EventsEndpoint[\"events\"] = 0] = \"events\";\r\n\t    EventsEndpoint[EventsEndpoint[\"calendarView\"] = 1] = \"calendarView\";\r\n\t})(exports.EventsEndpoint || (exports.EventsEndpoint = {}));\r\n\tvar EventsEndpoint = exports.EventsEndpoint;\r\n\tvar User = (function (_super) {\r\n\t    __extends(User, _super);\r\n\t    function User() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    User.prototype.events = function (callback, odataQuery) {\r\n\t        this.graph.eventsForUser(this._data.userPrincipalName, EventsEndpoint.events, callback, odataQuery);\r\n\t    };\r\n\t    User.prototype.eventsAsync = function (odataQuery) {\r\n\t        return this.graph.eventsForUserAsync(this._data.userPrincipalName, EventsEndpoint.events, odataQuery);\r\n\t    };\r\n\t    User.prototype.memberOf = function (callback, Error, odataQuery) {\r\n\t        this.graph.memberOfForUser(this._data.userPrincipalName, callback, odataQuery);\r\n\t    };\r\n\t    User.prototype.memberOfAsync = function (odataQuery) {\r\n\t        return this.graph.memberOfForUserAsync(this._data.userPrincipalName, odataQuery);\r\n\t    };\r\n\t    User.prototype.messages = function (callback, odataQuery) {\r\n\t        this.graph.messagesForUser(this._data.userPrincipalName, callback, odataQuery);\r\n\t    };\r\n\t    User.prototype.messagesAsync = function (odataQuery) {\r\n\t        return this.graph.messagesForUserAsync(this._data.userPrincipalName, odataQuery);\r\n\t    };\r\n\t    User.prototype.manager = function (callback, odataQuery) {\r\n\t        this.graph.managerForUser(this._data.userPrincipalName, callback, odataQuery);\r\n\t    };\r\n\t    User.prototype.managerAsync = function (odataQuery) {\r\n\t        return this.graph.managerForUserAsync(this._data.userPrincipalName, odataQuery);\r\n\t    };\r\n\t    User.prototype.profilePhoto = function (callback, odataQuery) {\r\n\t        this.graph.profilePhotoForUser(this._data.userPrincipalName, callback, odataQuery);\r\n\t    };\r\n\t    User.prototype.profilePhotoAsync = function (odataQuery) {\r\n\t        return this.graph.profilePhotoForUserAsync(this._data.userPrincipalName, odataQuery);\r\n\t    };\r\n\t    User.prototype.profilePhotoValue = function (callback, odataQuery) {\r\n\t        this.graph.profilePhotoValueForUser(this._data.userPrincipalName, callback, odataQuery);\r\n\t    };\r\n\t    User.prototype.profilePhotoValueAsync = function (odataQuery) {\r\n\t        return this.graph.profilePhotoValueForUserAsync(this._data.userPrincipalName, odataQuery);\r\n\t    };\r\n\t    User.prototype.calendarView = function (callback, odataQuery) {\r\n\t        this.graph.eventsForUser(this._data.userPrincipalName, EventsEndpoint.calendarView, callback, odataQuery);\r\n\t    };\r\n\t    User.prototype.calendarViewAsync = function (odataQuery) {\r\n\t        return this.graph.eventsForUserAsync(this._data.userPrincipalName, EventsEndpoint.calendarView, odataQuery);\r\n\t    };\r\n\t    User.prototype.mailFolders = function (callback, odataQuery) {\r\n\t        this.graph.mailFoldersForUser(this._data.userPrincipalName, callback, odataQuery);\r\n\t    };\r\n\t    User.prototype.mailFoldersAsync = function (odataQuery) {\r\n\t        return this.graph.mailFoldersForUserAsync(this._data.userPrincipalName, odataQuery);\r\n\t    };\r\n\t    User.prototype.message = function (messageId, callback, odataQuery) {\r\n\t        this.graph.messageForUser(this._data.userPrincipalName, messageId, callback, odataQuery);\r\n\t    };\r\n\t    User.prototype.messageAsync = function (messageId, odataQuery) {\r\n\t        return this.graph.messageForUserAsync(this._data.userPrincipalName, messageId, odataQuery);\r\n\t    };\r\n\t    User.prototype.event = function (eventId, callback, odataQuery) {\r\n\t        this.graph.eventForUser(this._data.userPrincipalName, eventId, callback, odataQuery);\r\n\t    };\r\n\t    User.prototype.eventAsync = function (eventId, odataQuery) {\r\n\t        return this.graph.eventForUserAsync(this._data.userPrincipalName, eventId, odataQuery);\r\n\t    };\r\n\t    User.prototype.messageAttachment = function (messageId, attachmentId, callback, odataQuery) {\r\n\t        this.graph.messageAttachmentForUser(this._data.userPrincipalName, messageId, attachmentId, callback, odataQuery);\r\n\t    };\r\n\t    User.prototype.messageAttachmentAsync = function (messageId, attachmentId, odataQuery) {\r\n\t        return this.graph.messageAttachmentForUserAsync(this._data.userPrincipalName, messageId, attachmentId, odataQuery);\r\n\t    };\r\n\t    return User;\r\n\t}(DataModelWrapper));\r\n\texports.User = User;\r\n\tvar Users = (function (_super) {\r\n\t    __extends(Users, _super);\r\n\t    function Users() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    return Users;\r\n\t}(DataModelListWrapper));\r\n\texports.Users = Users;\r\n\tvar Message = (function (_super) {\r\n\t    __extends(Message, _super);\r\n\t    function Message() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    return Message;\r\n\t}(DataModelWrapper));\r\n\texports.Message = Message;\r\n\tvar Messages = (function (_super) {\r\n\t    __extends(Messages, _super);\r\n\t    function Messages() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    return Messages;\r\n\t}(DataModelListWrapper));\r\n\texports.Messages = Messages;\r\n\tvar Event = (function (_super) {\r\n\t    __extends(Event, _super);\r\n\t    function Event() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    return Event;\r\n\t}(DataModelWrapper));\r\n\texports.Event = Event;\r\n\tvar Events = (function (_super) {\r\n\t    __extends(Events, _super);\r\n\t    function Events(graph, endpoint, _data) {\r\n\t        _super.call(this, graph, _data);\r\n\t        this.graph = graph;\r\n\t        this.endpoint = endpoint;\r\n\t        this._data = _data;\r\n\t    }\r\n\t    return Events;\r\n\t}(DataModelListWrapper));\r\n\texports.Events = Events;\r\n\tvar Contact = (function () {\r\n\t    function Contact() {\r\n\t    }\r\n\t    return Contact;\r\n\t}());\r\n\texports.Contact = Contact;\r\n\tvar Group = (function (_super) {\r\n\t    __extends(Group, _super);\r\n\t    function Group() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    return Group;\r\n\t}(DataModelWrapper));\r\n\texports.Group = Group;\r\n\tvar Groups = (function (_super) {\r\n\t    __extends(Groups, _super);\r\n\t    function Groups() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    return Groups;\r\n\t}(DataModelListWrapper));\r\n\texports.Groups = Groups;\r\n\tvar MailFolder = (function (_super) {\r\n\t    __extends(MailFolder, _super);\r\n\t    function MailFolder() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    return MailFolder;\r\n\t}(DataModelWrapper));\r\n\texports.MailFolder = MailFolder;\r\n\tvar MailFolders = (function (_super) {\r\n\t    __extends(MailFolders, _super);\r\n\t    function MailFolders() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    return MailFolders;\r\n\t}(DataModelListWrapper));\r\n\texports.MailFolders = MailFolders;\r\n\t(function (AttachmentType) {\r\n\t    AttachmentType[AttachmentType[\"fileAttachment\"] = 0] = \"fileAttachment\";\r\n\t    AttachmentType[AttachmentType[\"itemAttachment\"] = 1] = \"itemAttachment\";\r\n\t    AttachmentType[AttachmentType[\"referenceAttachment\"] = 2] = \"referenceAttachment\";\r\n\t})(exports.AttachmentType || (exports.AttachmentType = {}));\r\n\tvar AttachmentType = exports.AttachmentType;\r\n\tvar Attachment = (function (_super) {\r\n\t    __extends(Attachment, _super);\r\n\t    function Attachment() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    Attachment.prototype.getType = function () {\r\n\t        switch (this._data['@odata.type']) {\r\n\t            case \"#microsoft.graph.fileAttachment\":\r\n\t                return AttachmentType.fileAttachment;\r\n\t            case \"#microsoft.graph.itemAttachment\":\r\n\t                return AttachmentType.itemAttachment;\r\n\t            case \"#microsoft.graph.referenceAttachment\":\r\n\t                return AttachmentType.referenceAttachment;\r\n\t        }\r\n\t    };\r\n\t    return Attachment;\r\n\t}(DataModelWrapper));\r\n\texports.Attachment = Attachment;\r\n\tvar Attachments = (function (_super) {\r\n\t    __extends(Attachments, _super);\r\n\t    function Attachments() {\r\n\t        _super.apply(this, arguments);\r\n\t    }\r\n\t    return Attachments;\r\n\t}(DataModelListWrapper));\r\n\texports.Attachments = Attachments;\r\n\tvar Graph = (function () {\r\n\t    function Graph(identityInfo) {\r\n\t        this.req = null;\r\n\t        this.accessToken = null;\r\n\t        this.KurveIdentity = null;\r\n\t        this.defaultResourceID = \"https://graph.microsoft.com\";\r\n\t        this.baseUrl = \"https://graph.microsoft.com/v1.0/\";\r\n\t        if (identityInfo.defaultAccessToken) {\r\n\t            this.accessToken = identityInfo.defaultAccessToken;\r\n\t        }\r\n\t        else {\r\n\t            this.KurveIdentity = identityInfo.identity;\r\n\t        }\r\n\t    }\r\n\t    Graph.prototype.scopesForV2 = function (scopes) {\r\n\t        if (!this.KurveIdentity)\r\n\t            return null;\r\n\t        if (this.KurveIdentity.getCurrentOauthVersion() === identity_1.OAuthVersion.v1)\r\n\t            return null;\r\n\t        else\r\n\t            return scopes;\r\n\t    };\r\n\t    Graph.prototype.meAsync = function (odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.me(function (error, user) { return error ? d.reject(error) : d.resolve(user); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.me = function (callback, odataQuery) {\r\n\t        var _this = this;\r\n\t        this.endpointGet(new requestbuilder_1.Root().me)\r\n\t            .then(function (result) { return callback(null, new User(_this, result)); })\r\n\t            .fail(function (error) { return callback(error); });\r\n\t    };\r\n\t    Graph.prototype.userAsync = function (userId, odataQuery, basicProfileOnly) {\r\n\t        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.user(userId, function (error, user) { return error ? d.reject(error) : d.resolve(user); }, odataQuery, basicProfileOnly);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.user = function (userId, callback, odataQuery, basicProfileOnly) {\r\n\t        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n\t        var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\r\n\t        var urlString = this.buildUsersUrl(userId, odataQuery);\r\n\t        this.getUser(urlString, callback, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.usersAsync = function (odataQuery, basicProfileOnly) {\r\n\t        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.users(function (error, users) { return error ? d.reject(error) : d.resolve(users); }, odataQuery, basicProfileOnly);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.users = function (callback, odataQuery, basicProfileOnly) {\r\n\t        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n\t        var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\r\n\t        var urlString = this.buildUsersUrl(\"\", odataQuery);\r\n\t        this.getUsers(urlString, callback, this.scopesForV2(scopes), basicProfileOnly);\r\n\t    };\r\n\t    Graph.prototype.groupAsync = function (groupId, odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.group(groupId, function (error, group) { return error ? d.reject(error) : d.resolve(group); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.group = function (groupId, callback, odataQuery) {\r\n\t        var scopes = [Scopes.Group.ReadAll];\r\n\t        var urlString = this.buildGroupsUrl(groupId, odataQuery);\r\n\t        this.getGroup(urlString, callback, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.groupsAsync = function (odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.groups(function (error, groups) { return error ? d.reject(error) : d.resolve(groups); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.groups = function (callback, odataQuery) {\r\n\t        var scopes = [Scopes.Group.ReadAll];\r\n\t        var urlString = this.buildGroupsUrl(\"\", odataQuery);\r\n\t        this.getGroups(urlString, callback, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.messageForUserAsync = function (userPrincipalName, messageId, odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.messageForUser(userPrincipalName, messageId, function (error, message) { return error ? d.reject(error) : d.resolve(message); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.messageForUser = function (userPrincipalName, messageId, callback, odataQuery) {\r\n\t        var scopes = [Scopes.Mail.Read];\r\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages/\" + messageId, odataQuery);\r\n\t        this.getMessage(urlString, messageId, function (error, result) { return callback(error, result); }, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.messagesForUserAsync = function (userPrincipalName, odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.messagesForUser(userPrincipalName, function (error, messages) { return error ? d.reject(error) : d.resolve(messages); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.messagesForUser = function (userPrincipalName, callback, odataQuery) {\r\n\t        var scopes = [Scopes.Mail.Read];\r\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages\", odataQuery);\r\n\t        this.getMessages(urlString, function (error, result) { return callback(error, result); }, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.mailFoldersForUserAsync = function (userPrincipalName, odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.mailFoldersForUser(userPrincipalName, function (error, messages) { return error ? d.reject(error) : d.resolve(messages); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.mailFoldersForUser = function (userPrincipalName, callback, odataQuery) {\r\n\t        var scopes = [Scopes.Mail.Read];\r\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/mailFolders\", odataQuery);\r\n\t        this.getMailFolders(urlString, function (error, result) { return callback(error, result); }, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.eventForUserAsync = function (userPrincipalName, eventId, odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.eventForUser(userPrincipalName, eventId, function (error, event) { return error ? d.reject(error) : d.resolve(event); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.eventForUser = function (userPrincipalName, eventId, callback, odataQuery) {\r\n\t        var scopes = [Scopes.Calendars.Read];\r\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/events/\" + eventId, odataQuery);\r\n\t        this.getEvent(urlString, eventId, function (error, result) { return callback(error, result); }, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.eventsForUserAsync = function (userPrincipalName, endpoint, odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.eventsForUser(userPrincipalName, endpoint, function (error, events) { return error ? d.reject(error) : d.resolve(events); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.eventsForUser = function (userPrincipalName, endpoint, callback, odataQuery) {\r\n\t        var scopes = [Scopes.Calendars.Read];\r\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/\" + EventsEndpoint[endpoint], odataQuery);\r\n\t        this.getEvents(urlString, endpoint, function (error, result) { return callback(error, result); }, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.memberOfForUserAsync = function (userPrincipalName, odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.memberOfForUser(userPrincipalName, function (error, groups) { return error ? d.reject(error) : d.resolve(groups); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.memberOfForUser = function (userPrincipalName, callback, odataQuery) {\r\n\t        var scopes = [Scopes.Group.ReadAll];\r\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/memberOf\", odataQuery);\r\n\t        this.getGroups(urlString, callback, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.managerForUserAsync = function (userPrincipalName, odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.managerForUser(userPrincipalName, function (error, user) { return error ? d.reject(error) : d.resolve(user); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.managerForUser = function (userPrincipalName, callback, odataQuery) {\r\n\t        var scopes = [Scopes.Directory.ReadAll];\r\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/manager\", odataQuery);\r\n\t        this.getUser(urlString, callback, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.directReportsForUserAsync = function (userPrincipalName, odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.directReportsForUser(userPrincipalName, function (error, users) { return error ? d.reject(error) : d.resolve(users); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.directReportsForUser = function (userPrincipalName, callback, odataQuery) {\r\n\t        var scopes = [Scopes.Directory.ReadAll];\r\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/directReports\", odataQuery);\r\n\t        this.getUsers(urlString, callback, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.profilePhotoForUserAsync = function (userPrincipalName, odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.profilePhotoForUser(userPrincipalName, function (error, profilePhoto) { return error ? d.reject(error) : d.resolve(profilePhoto); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.profilePhotoForUser = function (userPrincipalName, callback, odataQuery) {\r\n\t        var scopes = [Scopes.User.ReadBasicAll];\r\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/photo\", odataQuery);\r\n\t        this.getPhoto(urlString, callback, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.profilePhotoValueForUserAsync = function (userPrincipalName, odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.profilePhotoValueForUser(userPrincipalName, function (error, result) { return error ? d.reject(error) : d.resolve(result); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.profilePhotoValueForUser = function (userPrincipalName, callback, odataQuery) {\r\n\t        var scopes = [Scopes.User.ReadBasicAll];\r\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/photo/$value\", odataQuery);\r\n\t        this.getPhotoValue(urlString, callback, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.messageAttachmentsForUserAsync = function (userPrincipalName, messageId, odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.messageAttachmentsForUser(userPrincipalName, messageId, function (error, result) { return error ? d.reject(error) : d.resolve(result); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.messageAttachmentsForUser = function (userPrincipalName, messageId, callback, odataQuery) {\r\n\t        var scopes = [Scopes.Mail.Read];\r\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages/\" + messageId + \"/attachments\", odataQuery);\r\n\t        this.getMessageAttachments(urlString, callback, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.messageAttachmentForUserAsync = function (userPrincipalName, messageId, attachmentId, odataQuery) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.messageAttachmentForUser(userPrincipalName, messageId, attachmentId, function (error, attachment) { return error ? d.reject(error) : d.resolve(attachment); }, odataQuery);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.messageAttachmentForUser = function (userPrincipalName, messageId, attachmentId, callback, odataQuery) {\r\n\t        var scopes = [Scopes.Mail.Read];\r\n\t        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages/\" + messageId + \"/attachments/\" + attachmentId, odataQuery);\r\n\t        this.getMessageAttachment(urlString, callback, this.scopesForV2(scopes));\r\n\t    };\r\n\t    Graph.prototype.getAsync = function (url) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.get(url, function (error, response) { return error ? d.reject(error) : d.resolve(response); });\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.get = function (url, callback, responseType, scopes) {\r\n\t        var _this = this;\r\n\t        var xhr = new XMLHttpRequest();\r\n\t        if (responseType)\r\n\t            xhr.responseType = responseType;\r\n\t        xhr.onreadystatechange = function () {\r\n\t            if (xhr.readyState === 4)\r\n\t                if (xhr.status === 200)\r\n\t                    callback(null, responseType ? xhr.response : xhr.responseText);\r\n\t                else\r\n\t                    callback(_this.generateError(xhr));\r\n\t        };\r\n\t        xhr.open(\"GET\", url);\r\n\t        this.addAccessTokenAndSend(xhr, function (addTokenError) {\r\n\t            if (addTokenError) {\r\n\t                callback(addTokenError);\r\n\t            }\r\n\t        }, scopes);\r\n\t    };\r\n\t    Graph.prototype.generateError = function (xhr) {\r\n\t        var response = new identity_1.Error();\r\n\t        response.status = xhr.status;\r\n\t        response.statusText = xhr.statusText;\r\n\t        if (xhr.responseType === '' || xhr.responseType === 'text')\r\n\t            response.text = xhr.responseText;\r\n\t        else\r\n\t            response.other = xhr.response;\r\n\t        return response;\r\n\t    };\r\n\t    Graph.prototype.endpointGet = function (endpoint) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.get(endpoint.pathWithQuery, function (error, result) {\r\n\t            var jsonResult = JSON.parse(result);\r\n\t            if (jsonResult.error) {\r\n\t                var errorODATA = new identity_1.Error();\r\n\t                errorODATA.other = jsonResult.error;\r\n\t                d.reject(errorODATA);\r\n\t                return;\r\n\t            }\r\n\t            d.resolve(jsonResult);\r\n\t        });\r\n\t        return d.promise;\r\n\t    };\r\n\t    Graph.prototype.getUsers = function (urlString, callback, scopes, basicProfileOnly) {\r\n\t        var _this = this;\r\n\t        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n\t        this.get(urlString, function (errorGet, result) {\r\n\t            if (errorGet) {\r\n\t                callback(errorGet);\r\n\t                return;\r\n\t            }\r\n\t            var usersODATA = JSON.parse(result);\r\n\t            if (usersODATA.error) {\r\n\t                var errorODATA = new identity_1.Error();\r\n\t                errorODATA.other = usersODATA.error;\r\n\t                callback(errorODATA);\r\n\t                return;\r\n\t            }\r\n\t            var resultsArray = (usersODATA.value ? usersODATA.value : [usersODATA]);\r\n\t            var users = new Users(_this, resultsArray.map(function (o) { return new User(_this, o); }));\r\n\t            var nextLink = usersODATA['@odata.nextLink'];\r\n\t            if (nextLink) {\r\n\t                users.nextLink = function (callback) {\r\n\t                    var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\r\n\t                    var d = new promises_1.Deferred();\r\n\t                    _this.getUsers(nextLink, function (error, result) {\r\n\t                        if (callback)\r\n\t                            callback(error, result);\r\n\t                        else\r\n\t                            error ? d.reject(error) : d.resolve(result);\r\n\t                    }, _this.scopesForV2(scopes), basicProfileOnly);\r\n\t                    return d.promise;\r\n\t                };\r\n\t            }\r\n\t            callback(null, users);\r\n\t        }, null, scopes);\r\n\t    };\r\n\t    Graph.prototype.getUser = function (urlString, callback, scopes) {\r\n\t        var _this = this;\r\n\t        this.get(urlString, function (errorGet, result) {\r\n\t            if (errorGet) {\r\n\t                callback(errorGet);\r\n\t                return;\r\n\t            }\r\n\t            var userODATA = JSON.parse(result);\r\n\t            if (userODATA.error) {\r\n\t                var errorODATA = new identity_1.Error();\r\n\t                errorODATA.other = userODATA.error;\r\n\t                callback(errorODATA);\r\n\t                return;\r\n\t            }\r\n\t            var user = new User(_this, userODATA);\r\n\t            callback(null, user);\r\n\t        }, null, scopes);\r\n\t    };\r\n\t    Graph.prototype.addAccessTokenAndSend = function (xhr, callback, scopes) {\r\n\t        if (this.accessToken) {\r\n\t            xhr.setRequestHeader('Authorization', 'Bearer ' + this.accessToken);\r\n\t            xhr.send();\r\n\t        }\r\n\t        else {\r\n\t            if (scopes) {\r\n\t                this.KurveIdentity.getAccessTokenForScopes(scopes, false, (function (token, error) {\r\n\t                    if (error)\r\n\t                        callback(error);\r\n\t                    else {\r\n\t                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\r\n\t                        xhr.send();\r\n\t                        callback(null);\r\n\t                    }\r\n\t                }));\r\n\t            }\r\n\t            else {\r\n\t                this.KurveIdentity.getAccessToken(this.defaultResourceID, (function (error, token) {\r\n\t                    if (error)\r\n\t                        callback(error);\r\n\t                    else {\r\n\t                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\r\n\t                        xhr.send();\r\n\t                        callback(null);\r\n\t                    }\r\n\t                }));\r\n\t            }\r\n\t        }\r\n\t    };\r\n\t    Graph.prototype.getMessage = function (urlString, messageId, callback, scopes) {\r\n\t        var _this = this;\r\n\t        this.get(urlString, function (errorGet, result) {\r\n\t            if (errorGet) {\r\n\t                callback(errorGet);\r\n\t                return;\r\n\t            }\r\n\t            var ODATA = JSON.parse(result);\r\n\t            if (ODATA.error) {\r\n\t                var ODATAError = new identity_1.Error();\r\n\t                ODATAError.other = ODATA.error;\r\n\t                callback(ODATAError);\r\n\t                return;\r\n\t            }\r\n\t            var message = new Message(_this, ODATA);\r\n\t            callback(null, message);\r\n\t        }, null, scopes);\r\n\t    };\r\n\t    Graph.prototype.getMessages = function (urlString, callback, scopes) {\r\n\t        var _this = this;\r\n\t        this.get(urlString, function (errorGet, result) {\r\n\t            if (errorGet) {\r\n\t                callback(errorGet);\r\n\t                return;\r\n\t            }\r\n\t            var messagesODATA = JSON.parse(result);\r\n\t            if (messagesODATA.error) {\r\n\t                var errorODATA = new identity_1.Error();\r\n\t                errorODATA.other = messagesODATA.error;\r\n\t                callback(errorODATA);\r\n\t                return;\r\n\t            }\r\n\t            var resultsArray = (messagesODATA.value ? messagesODATA.value : [messagesODATA]);\r\n\t            var messages = new Messages(_this, resultsArray.map(function (o) { return new Message(_this, o); }));\r\n\t            var nextLink = messagesODATA['@odata.nextLink'];\r\n\t            if (nextLink) {\r\n\t                messages.nextLink = function (callback) {\r\n\t                    var scopes = [Scopes.Mail.Read];\r\n\t                    var d = new promises_1.Deferred();\r\n\t                    _this.getMessages(nextLink, function (error, messages) {\r\n\t                        if (callback)\r\n\t                            callback(error, messages);\r\n\t                        else\r\n\t                            error ? d.reject(error) : d.resolve(messages);\r\n\t                    }, _this.scopesForV2(scopes));\r\n\t                    return d.promise;\r\n\t                };\r\n\t            }\r\n\t            callback(null, messages);\r\n\t        }, null, scopes);\r\n\t    };\r\n\t    Graph.prototype.getEvent = function (urlString, EventId, callback, scopes) {\r\n\t        var _this = this;\r\n\t        this.get(urlString, function (errorGet, result) {\r\n\t            if (errorGet) {\r\n\t                callback(errorGet);\r\n\t                return;\r\n\t            }\r\n\t            var ODATA = JSON.parse(result);\r\n\t            if (ODATA.error) {\r\n\t                var ODATAError = new identity_1.Error();\r\n\t                ODATAError.other = ODATA.error;\r\n\t                callback(ODATAError);\r\n\t                return;\r\n\t            }\r\n\t            var event = new Event(_this, ODATA);\r\n\t            callback(null, event);\r\n\t        }, null, scopes);\r\n\t    };\r\n\t    Graph.prototype.getEvents = function (urlString, endpoint, callback, scopes) {\r\n\t        var _this = this;\r\n\t        this.get(urlString, function (errorGet, result) {\r\n\t            if (errorGet) {\r\n\t                callback(errorGet);\r\n\t                return;\r\n\t            }\r\n\t            var odata = JSON.parse(result);\r\n\t            if (odata.error) {\r\n\t                var errorODATA = new identity_1.Error();\r\n\t                errorODATA.other = odata.error;\r\n\t                callback(errorODATA);\r\n\t                return;\r\n\t            }\r\n\t            var resultsArray = (odata.value ? odata.value : [odata]);\r\n\t            var events = new Events(_this, endpoint, resultsArray.map(function (o) { return new Event(_this, o); }));\r\n\t            var nextLink = odata['@odata.nextLink'];\r\n\t            if (nextLink) {\r\n\t                events.nextLink = function (callback) {\r\n\t                    var scopes = [Scopes.Mail.Read];\r\n\t                    var d = new promises_1.Deferred();\r\n\t                    _this.getEvents(nextLink, endpoint, function (error, result) {\r\n\t                        if (callback)\r\n\t                            callback(error, result);\r\n\t                        else\r\n\t                            error ? d.reject(error) : d.resolve(result);\r\n\t                    }, _this.scopesForV2(scopes));\r\n\t                    return d.promise;\r\n\t                };\r\n\t            }\r\n\t            callback(null, events);\r\n\t        }, null, scopes);\r\n\t    };\r\n\t    Graph.prototype.getGroups = function (urlString, callback, scopes) {\r\n\t        var _this = this;\r\n\t        this.get(urlString, function (errorGet, result) {\r\n\t            if (errorGet) {\r\n\t                callback(errorGet);\r\n\t                return;\r\n\t            }\r\n\t            var groupsODATA = JSON.parse(result);\r\n\t            if (groupsODATA.error) {\r\n\t                var errorODATA = new identity_1.Error();\r\n\t                errorODATA.other = groupsODATA.error;\r\n\t                callback(errorODATA);\r\n\t                return;\r\n\t            }\r\n\t            var resultsArray = (groupsODATA.value ? groupsODATA.value : [groupsODATA]);\r\n\t            var groups = new Groups(_this, resultsArray.map(function (o) { return new Group(_this, o); }));\r\n\t            var nextLink = groupsODATA['@odata.nextLink'];\r\n\t            if (nextLink) {\r\n\t                groups.nextLink = function (callback) {\r\n\t                    var scopes = [Scopes.Group.ReadAll];\r\n\t                    var d = new promises_1.Deferred();\r\n\t                    _this.getGroups(nextLink, function (error, result) {\r\n\t                        if (callback)\r\n\t                            callback(error, result);\r\n\t                        else\r\n\t                            error ? d.reject(error) : d.resolve(result);\r\n\t                    }, _this.scopesForV2(scopes));\r\n\t                    return d.promise;\r\n\t                };\r\n\t            }\r\n\t            callback(null, groups);\r\n\t        }, null, scopes);\r\n\t    };\r\n\t    Graph.prototype.getGroup = function (urlString, callback, scopes) {\r\n\t        var _this = this;\r\n\t        this.get(urlString, function (errorGet, result) {\r\n\t            if (errorGet) {\r\n\t                callback(errorGet);\r\n\t                return;\r\n\t            }\r\n\t            var ODATA = JSON.parse(result);\r\n\t            if (ODATA.error) {\r\n\t                var ODATAError = new identity_1.Error();\r\n\t                ODATAError.other = ODATA.error;\r\n\t                callback(ODATAError);\r\n\t                return;\r\n\t            }\r\n\t            var group = new Group(_this, ODATA);\r\n\t            callback(null, group);\r\n\t        }, null, scopes);\r\n\t    };\r\n\t    Graph.prototype.getPhoto = function (urlString, callback, scopes) {\r\n\t        var _this = this;\r\n\t        this.get(urlString, function (errorGet, result) {\r\n\t            if (errorGet) {\r\n\t                callback(errorGet);\r\n\t                return;\r\n\t            }\r\n\t            var ODATA = JSON.parse(result);\r\n\t            if (ODATA.error) {\r\n\t                var errorODATA = new identity_1.Error();\r\n\t                errorODATA.other = ODATA.error;\r\n\t                callback(errorODATA);\r\n\t                return;\r\n\t            }\r\n\t            var photo = new ProfilePhoto(_this, ODATA);\r\n\t            callback(null, photo);\r\n\t        }, null, scopes);\r\n\t    };\r\n\t    Graph.prototype.getPhotoValue = function (urlString, callback, scopes) {\r\n\t        this.get(urlString, function (errorGet, result) {\r\n\t            if (errorGet) {\r\n\t                callback(null, errorGet);\r\n\t                return;\r\n\t            }\r\n\t            callback(result);\r\n\t        }, \"blob\", scopes);\r\n\t    };\r\n\t    Graph.prototype.getMailFolders = function (urlString, callback, scopes) {\r\n\t        var _this = this;\r\n\t        this.get(urlString, function (errorGet, result) {\r\n\t            if (errorGet) {\r\n\t                callback(errorGet);\r\n\t                return;\r\n\t            }\r\n\t            var odata = JSON.parse(result);\r\n\t            if (odata.error) {\r\n\t                var errorODATA = new identity_1.Error();\r\n\t                errorODATA.other = odata.error;\r\n\t                callback(errorODATA);\r\n\t            }\r\n\t            var resultsArray = (odata.value ? odata.value : [odata]);\r\n\t            var mailFolders = new MailFolders(_this, resultsArray.map(function (o) { return new MailFolder(_this, o); }));\r\n\t            var nextLink = odata['@odata.nextLink'];\r\n\t            if (nextLink) {\r\n\t                mailFolders.nextLink = function (callback) {\r\n\t                    var scopes = [Scopes.User.ReadAll];\r\n\t                    var d = new promises_1.Deferred();\r\n\t                    _this.getMailFolders(nextLink, function (error, result) {\r\n\t                        if (callback)\r\n\t                            callback(error, result);\r\n\t                        else\r\n\t                            error ? d.reject(error) : d.resolve(result);\r\n\t                    }, _this.scopesForV2(scopes));\r\n\t                    return d.promise;\r\n\t                };\r\n\t            }\r\n\t            callback(null, mailFolders);\r\n\t        }, null, scopes);\r\n\t    };\r\n\t    Graph.prototype.getMessageAttachments = function (urlString, callback, scopes) {\r\n\t        var _this = this;\r\n\t        this.get(urlString, function (errorGet, result) {\r\n\t            if (errorGet) {\r\n\t                callback(errorGet);\r\n\t                return;\r\n\t            }\r\n\t            var attachmentsODATA = JSON.parse(result);\r\n\t            if (attachmentsODATA.error) {\r\n\t                var errorODATA = new identity_1.Error();\r\n\t                errorODATA.other = attachmentsODATA.error;\r\n\t                callback(errorODATA);\r\n\t                return;\r\n\t            }\r\n\t            var resultsArray = (attachmentsODATA.value ? attachmentsODATA.value : [attachmentsODATA]);\r\n\t            var attachments = new Attachments(_this, resultsArray.map(function (o) { return new Attachment(_this, o); }));\r\n\t            var nextLink = attachmentsODATA['@odata.nextLink'];\r\n\t            if (nextLink) {\r\n\t                attachments.nextLink = function (callback) {\r\n\t                    var scopes = [Scopes.Mail.Read];\r\n\t                    var d = new promises_1.Deferred();\r\n\t                    _this.getMessageAttachments(nextLink, function (error, attachments) {\r\n\t                        if (callback)\r\n\t                            callback(error, attachments);\r\n\t                        else\r\n\t                            error ? d.reject(error) : d.resolve(attachments);\r\n\t                    }, _this.scopesForV2(scopes));\r\n\t                    return d.promise;\r\n\t                };\r\n\t            }\r\n\t            callback(null, attachments);\r\n\t        }, null, scopes);\r\n\t    };\r\n\t    Graph.prototype.getMessageAttachment = function (urlString, callback, scopes) {\r\n\t        var _this = this;\r\n\t        this.get(urlString, function (errorGet, result) {\r\n\t            if (errorGet) {\r\n\t                callback(errorGet);\r\n\t                return;\r\n\t            }\r\n\t            var ODATA = JSON.parse(result);\r\n\t            if (ODATA.error) {\r\n\t                var ODATAError = new identity_1.Error();\r\n\t                ODATAError.other = ODATA.error;\r\n\t                callback(ODATAError);\r\n\t                return;\r\n\t            }\r\n\t            var attachment = new Attachment(_this, ODATA);\r\n\t            callback(null, attachment);\r\n\t        }, null, scopes);\r\n\t    };\r\n\t    Graph.prototype.buildUrl = function (root, path, odataQuery) {\r\n\t        return this.baseUrl + root + path + (odataQuery ? \"?\" + odataQuery : \"\");\r\n\t    };\r\n\t    Graph.prototype.buildMeUrl = function (path, odataQuery) {\r\n\t        if (path === void 0) { path = \"\"; }\r\n\t        return this.buildUrl(\"me/\", path, odataQuery);\r\n\t    };\r\n\t    Graph.prototype.buildUsersUrl = function (path, odataQuery) {\r\n\t        if (path === void 0) { path = \"\"; }\r\n\t        return this.buildUrl(\"users/\", path, odataQuery);\r\n\t    };\r\n\t    Graph.prototype.buildGroupsUrl = function (path, odataQuery) {\r\n\t        if (path === void 0) { path = \"\"; }\r\n\t        return this.buildUrl(\"groups/\", path, odataQuery);\r\n\t    };\r\n\t    return Graph;\r\n\t}());\r\n\texports.Graph = Graph;\r\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tfunction DispatchDeferred(closure) {\r\n\t    setTimeout(closure, 0);\r\n\t}\r\n\tvar PromiseState;\r\n\t(function (PromiseState) {\r\n\t    PromiseState[PromiseState[\"Pending\"] = 0] = \"Pending\";\r\n\t    PromiseState[PromiseState[\"ResolutionInProgress\"] = 1] = \"ResolutionInProgress\";\r\n\t    PromiseState[PromiseState[\"Resolved\"] = 2] = \"Resolved\";\r\n\t    PromiseState[PromiseState[\"Rejected\"] = 3] = \"Rejected\";\r\n\t})(PromiseState || (PromiseState = {}));\r\n\tvar Client = (function () {\r\n\t    function Client(_dispatcher, _successCB, _errorCB) {\r\n\t        this._dispatcher = _dispatcher;\r\n\t        this._successCB = _successCB;\r\n\t        this._errorCB = _errorCB;\r\n\t        this.result = new Deferred(_dispatcher);\r\n\t    }\r\n\t    Client.prototype.resolve = function (value, defer) {\r\n\t        var _this = this;\r\n\t        if (typeof (this._successCB) !== 'function') {\r\n\t            this.result.resolve(value);\r\n\t            return;\r\n\t        }\r\n\t        if (defer) {\r\n\t            this._dispatcher(function () { return _this._dispatchCallback(_this._successCB, value); });\r\n\t        }\r\n\t        else {\r\n\t            this._dispatchCallback(this._successCB, value);\r\n\t        }\r\n\t    };\r\n\t    Client.prototype.reject = function (error, defer) {\r\n\t        var _this = this;\r\n\t        if (typeof (this._errorCB) !== 'function') {\r\n\t            this.result.reject(error);\r\n\t            return;\r\n\t        }\r\n\t        if (defer) {\r\n\t            this._dispatcher(function () { return _this._dispatchCallback(_this._errorCB, error); });\r\n\t        }\r\n\t        else {\r\n\t            this._dispatchCallback(this._errorCB, error);\r\n\t        }\r\n\t    };\r\n\t    Client.prototype._dispatchCallback = function (callback, arg) {\r\n\t        var result, then, type;\r\n\t        try {\r\n\t            result = callback(arg);\r\n\t            this.result.resolve(result);\r\n\t        }\r\n\t        catch (err) {\r\n\t            this.result.reject(err);\r\n\t            return;\r\n\t        }\r\n\t    };\r\n\t    return Client;\r\n\t}());\r\n\tvar Deferred = (function () {\r\n\t    function Deferred(dispatcher) {\r\n\t        this._stack = [];\r\n\t        this._state = PromiseState.Pending;\r\n\t        if (dispatcher)\r\n\t            this._dispatcher = dispatcher;\r\n\t        else\r\n\t            this._dispatcher = DispatchDeferred;\r\n\t        this.promise = new Promise(this);\r\n\t    }\r\n\t    Deferred.prototype.DispatchDeferred = function (closure) {\r\n\t        setTimeout(closure, 0);\r\n\t    };\r\n\t    Deferred.prototype.then = function (successCB, errorCB) {\r\n\t        if (typeof (successCB) !== 'function' && typeof (errorCB) !== 'function') {\r\n\t            return this.promise;\r\n\t        }\r\n\t        var client = new Client(this._dispatcher, successCB, errorCB);\r\n\t        switch (this._state) {\r\n\t            case PromiseState.Pending:\r\n\t            case PromiseState.ResolutionInProgress:\r\n\t                this._stack.push(client);\r\n\t                break;\r\n\t            case PromiseState.Resolved:\r\n\t                client.resolve(this._value, true);\r\n\t                break;\r\n\t            case PromiseState.Rejected:\r\n\t                client.reject(this._error, true);\r\n\t                break;\r\n\t        }\r\n\t        return client.result.promise;\r\n\t    };\r\n\t    Deferred.prototype.resolve = function (value) {\r\n\t        if (this._state !== PromiseState.Pending) {\r\n\t            return this;\r\n\t        }\r\n\t        return this._resolve(value);\r\n\t    };\r\n\t    Deferred.prototype._resolve = function (value) {\r\n\t        var _this = this;\r\n\t        var type = typeof (value), then, pending = true;\r\n\t        try {\r\n\t            if (value !== null &&\r\n\t                (type === 'object' || type === 'function') &&\r\n\t                typeof (then = value.then) === 'function') {\r\n\t                if (value === this.promise) {\r\n\t                    throw new TypeError('recursive resolution');\r\n\t                }\r\n\t                this._state = PromiseState.ResolutionInProgress;\r\n\t                then.call(value, function (result) {\r\n\t                    if (pending) {\r\n\t                        pending = false;\r\n\t                        _this._resolve(result);\r\n\t                    }\r\n\t                }, function (error) {\r\n\t                    if (pending) {\r\n\t                        pending = false;\r\n\t                        _this._reject(error);\r\n\t                    }\r\n\t                });\r\n\t            }\r\n\t            else {\r\n\t                this._state = PromiseState.ResolutionInProgress;\r\n\t                this._dispatcher(function () {\r\n\t                    _this._state = PromiseState.Resolved;\r\n\t                    _this._value = value;\r\n\t                    var i, stackSize = _this._stack.length;\r\n\t                    for (i = 0; i < stackSize; i++) {\r\n\t                        _this._stack[i].resolve(value, false);\r\n\t                    }\r\n\t                    _this._stack.splice(0, stackSize);\r\n\t                });\r\n\t            }\r\n\t        }\r\n\t        catch (err) {\r\n\t            if (pending) {\r\n\t                this._reject(err);\r\n\t            }\r\n\t        }\r\n\t        return this;\r\n\t    };\r\n\t    Deferred.prototype.reject = function (error) {\r\n\t        if (this._state !== PromiseState.Pending) {\r\n\t            return this;\r\n\t        }\r\n\t        return this._reject(error);\r\n\t    };\r\n\t    Deferred.prototype._reject = function (error) {\r\n\t        var _this = this;\r\n\t        this._state = PromiseState.ResolutionInProgress;\r\n\t        this._dispatcher(function () {\r\n\t            _this._state = PromiseState.Rejected;\r\n\t            _this._error = error;\r\n\t            var stackSize = _this._stack.length, i = 0;\r\n\t            for (i = 0; i < stackSize; i++) {\r\n\t                _this._stack[i].reject(error, false);\r\n\t            }\r\n\t            _this._stack.splice(0, stackSize);\r\n\t        });\r\n\t        return this;\r\n\t    };\r\n\t    return Deferred;\r\n\t}());\r\n\texports.Deferred = Deferred;\r\n\tvar Promise = (function () {\r\n\t    function Promise(_deferred) {\r\n\t        this._deferred = _deferred;\r\n\t    }\r\n\t    Promise.prototype.then = function (successCallback, errorCallback) {\r\n\t        return this._deferred.then(successCallback, errorCallback);\r\n\t    };\r\n\t    Promise.prototype.fail = function (errorCallback) {\r\n\t        return this._deferred.then(undefined, errorCallback);\r\n\t    };\r\n\t    return Promise;\r\n\t}());\r\n\texports.Promise = Promise;\r\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\r\n\tvar promises_1 = __webpack_require__(2);\r\n\t(function (OAuthVersion) {\r\n\t    OAuthVersion[OAuthVersion[\"v1\"] = 1] = \"v1\";\r\n\t    OAuthVersion[OAuthVersion[\"v2\"] = 2] = \"v2\";\r\n\t})(exports.OAuthVersion || (exports.OAuthVersion = {}));\r\n\tvar OAuthVersion = exports.OAuthVersion;\r\n\tvar Error = (function () {\r\n\t    function Error() {\r\n\t    }\r\n\t    return Error;\r\n\t}());\r\n\texports.Error = Error;\r\n\tvar CachedToken = (function () {\r\n\t    function CachedToken(id, scopes, resource, token, expiry) {\r\n\t        this.id = id;\r\n\t        this.scopes = scopes;\r\n\t        this.resource = resource;\r\n\t        this.token = token;\r\n\t        this.expiry = expiry;\r\n\t    }\r\n\t    ;\r\n\t    Object.defineProperty(CachedToken.prototype, \"isExpired\", {\r\n\t        get: function () {\r\n\t            return this.expiry <= new Date(new Date().getTime() + 60000);\r\n\t        },\r\n\t        enumerable: true,\r\n\t        configurable: true\r\n\t    });\r\n\t    CachedToken.prototype.hasScopes = function (requiredScopes) {\r\n\t        var _this = this;\r\n\t        if (!this.scopes) {\r\n\t            return false;\r\n\t        }\r\n\t        return requiredScopes.every(function (requiredScope) {\r\n\t            return _this.scopes.some(function (actualScope) { return requiredScope === actualScope; });\r\n\t        });\r\n\t    };\r\n\t    return CachedToken;\r\n\t}());\r\n\tvar TokenCache = (function () {\r\n\t    function TokenCache(tokenStorage) {\r\n\t        var _this = this;\r\n\t        this.tokenStorage = tokenStorage;\r\n\t        this.cachedTokens = {};\r\n\t        if (tokenStorage) {\r\n\t            tokenStorage.getAll().forEach(function (_a) {\r\n\t                var id = _a.id, scopes = _a.scopes, resource = _a.resource, token = _a.token, expiry = _a.expiry;\r\n\t                var cachedToken = new CachedToken(id, scopes, resource, token, new Date(expiry));\r\n\t                if (cachedToken.isExpired) {\r\n\t                    _this.tokenStorage.remove(cachedToken.id);\r\n\t                }\r\n\t                else {\r\n\t                    _this.cachedTokens[cachedToken.id] = cachedToken;\r\n\t                }\r\n\t            });\r\n\t        }\r\n\t    }\r\n\t    TokenCache.prototype.add = function (token) {\r\n\t        this.cachedTokens[token.id] = token;\r\n\t        this.tokenStorage && this.tokenStorage.add(token.id, token);\r\n\t    };\r\n\t    TokenCache.prototype.getForResource = function (resource) {\r\n\t        var cachedToken = this.cachedTokens[resource];\r\n\t        if (cachedToken && cachedToken.isExpired) {\r\n\t            this.remove(resource);\r\n\t            return null;\r\n\t        }\r\n\t        return cachedToken;\r\n\t    };\r\n\t    TokenCache.prototype.getForScopes = function (scopes) {\r\n\t        for (var key in this.cachedTokens) {\r\n\t            var cachedToken = this.cachedTokens[key];\r\n\t            if (cachedToken.hasScopes(scopes)) {\r\n\t                if (cachedToken.isExpired) {\r\n\t                    this.remove(key);\r\n\t                }\r\n\t                else {\r\n\t                    return cachedToken;\r\n\t                }\r\n\t            }\r\n\t        }\r\n\t        return null;\r\n\t    };\r\n\t    TokenCache.prototype.clear = function () {\r\n\t        this.cachedTokens = {};\r\n\t        this.tokenStorage && this.tokenStorage.clear();\r\n\t    };\r\n\t    TokenCache.prototype.remove = function (key) {\r\n\t        this.tokenStorage && this.tokenStorage.remove(key);\r\n\t        delete this.cachedTokens[key];\r\n\t    };\r\n\t    return TokenCache;\r\n\t}());\r\n\tvar IdToken = (function () {\r\n\t    function IdToken() {\r\n\t    }\r\n\t    return IdToken;\r\n\t}());\r\n\texports.IdToken = IdToken;\r\n\tvar Identity = (function () {\r\n\t    function Identity(identitySettings) {\r\n\t        var _this = this;\r\n\t        this.policy = \"\";\r\n\t        this.clientId = identitySettings.clientId;\r\n\t        this.tokenProcessorUrl = identitySettings.tokenProcessingUri;\r\n\t        if (identitySettings.version)\r\n\t            this.version = identitySettings.version;\r\n\t        else\r\n\t            this.version = OAuthVersion.v1;\r\n\t        this.tokenCache = new TokenCache(identitySettings.tokenStorage);\r\n\t        window.addEventListener(\"message\", function (event) {\r\n\t            if (event.data.type === \"id_token\") {\r\n\t                if (event.data.error) {\r\n\t                    var e = new Error();\r\n\t                    e.text = event.data.error;\r\n\t                    _this.loginCallback(e);\r\n\t                }\r\n\t                else {\r\n\t                    if (_this.state !== event.data.state) {\r\n\t                        var error = new Error();\r\n\t                        error.statusText = \"Invalid state\";\r\n\t                        _this.loginCallback(error);\r\n\t                    }\r\n\t                    else {\r\n\t                        _this.decodeIdToken(event.data.token);\r\n\t                        _this.loginCallback(null);\r\n\t                    }\r\n\t                }\r\n\t            }\r\n\t            else if (event.data.type === \"access_token\") {\r\n\t                if (event.data.error) {\r\n\t                    var e = new Error();\r\n\t                    e.text = event.data.error;\r\n\t                    _this.getTokenCallback(null, e);\r\n\t                }\r\n\t                else {\r\n\t                    var token = event.data.token;\r\n\t                    var iframe = document.getElementById(\"tokenIFrame\");\r\n\t                    iframe.parentNode.removeChild(iframe);\r\n\t                    if (event.data.state !== _this.state) {\r\n\t                        var error = new Error();\r\n\t                        error.statusText = \"Invalid state\";\r\n\t                        _this.getTokenCallback(null, error);\r\n\t                    }\r\n\t                    else {\r\n\t                        _this.getTokenCallback(token, null);\r\n\t                    }\r\n\t                }\r\n\t            }\r\n\t        });\r\n\t    }\r\n\t    Identity.prototype.checkForIdentityRedirect = function () {\r\n\t        function token(s) {\r\n\t            var start = window.location.href.indexOf(s);\r\n\t            if (start < 0)\r\n\t                return null;\r\n\t            var end = window.location.href.indexOf(\"&\", start + s.length);\r\n\t            return window.location.href.substring(start, ((end > 0) ? end : window.location.href.length));\r\n\t        }\r\n\t        function parseQueryString(str) {\r\n\t            var queryString = str || window.location.search || '';\r\n\t            var keyValPairs = [];\r\n\t            var params = {};\r\n\t            queryString = queryString.replace(/.*?\\?/, \"\");\r\n\t            if (queryString.length) {\r\n\t                keyValPairs = queryString.split('&');\r\n\t                for (var pairNum in keyValPairs) {\r\n\t                    var key = keyValPairs[pairNum].split('=')[0];\r\n\t                    if (!key.length)\r\n\t                        continue;\r\n\t                    if (typeof params[key] === 'undefined')\r\n\t                        params[key] = [];\r\n\t                    params[key].push(keyValPairs[pairNum].split('=')[1]);\r\n\t                }\r\n\t            }\r\n\t            return params;\r\n\t        }\r\n\t        var params = parseQueryString(window.location.href);\r\n\t        var idToken = token(\"#id_token=\");\r\n\t        var accessToken = token(\"#access_token\");\r\n\t        if (idToken) {\r\n\t            if (true) {\r\n\t                this.decodeIdToken(idToken);\r\n\t                this.loginCallback && this.loginCallback(null);\r\n\t            }\r\n\t            else {\r\n\t                var error = new Error();\r\n\t                error.statusText = \"Invalid state\";\r\n\t                this.loginCallback && this.loginCallback(error);\r\n\t            }\r\n\t            return true;\r\n\t        }\r\n\t        else if (accessToken) {\r\n\t            throw \"Should not get here.  This should be handled via the iframe approach.\";\r\n\t        }\r\n\t        return false;\r\n\t    };\r\n\t    Identity.prototype.decodeIdToken = function (idToken) {\r\n\t        var _this = this;\r\n\t        var decodedToken = this.base64Decode(idToken.substring(idToken.indexOf('.') + 1, idToken.lastIndexOf('.')));\r\n\t        var decodedTokenJSON = JSON.parse(decodedToken);\r\n\t        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\r\n\t        this.idToken = new IdToken();\r\n\t        this.idToken.FullToken = decodedTokenJSON;\r\n\t        this.idToken.Token = idToken;\r\n\t        this.idToken.Expiry = expiryDate;\r\n\t        this.idToken.UPN = decodedTokenJSON.upn;\r\n\t        this.idToken.TenantId = decodedTokenJSON.tid;\r\n\t        this.idToken.FamilyName = decodedTokenJSON.family_name;\r\n\t        this.idToken.GivenName = decodedTokenJSON.given_name;\r\n\t        this.idToken.Name = decodedTokenJSON.name;\r\n\t        this.idToken.PreferredUsername = decodedTokenJSON.preferred_username;\r\n\t        var expiration = expiryDate.getTime() - new Date().getTime() - 300000;\r\n\t        this.refreshTimer = setTimeout((function () {\r\n\t            _this.renewIdToken();\r\n\t        }), expiration);\r\n\t    };\r\n\t    Identity.prototype.decodeAccessToken = function (accessToken, resource, scopes) {\r\n\t        var decodedToken = this.base64Decode(accessToken.substring(accessToken.indexOf('.') + 1, accessToken.lastIndexOf('.')));\r\n\t        var decodedTokenJSON = JSON.parse(decodedToken);\r\n\t        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\r\n\t        var key = resource || scopes.join(\" \");\r\n\t        var token = new CachedToken(key, scopes, resource, accessToken, expiryDate);\r\n\t        this.tokenCache.add(token);\r\n\t    };\r\n\t    Identity.prototype.getIdToken = function () {\r\n\t        return this.idToken;\r\n\t    };\r\n\t    Identity.prototype.isLoggedIn = function () {\r\n\t        if (!this.idToken)\r\n\t            return false;\r\n\t        return (this.idToken.Expiry > new Date());\r\n\t    };\r\n\t    Identity.prototype.renewIdToken = function () {\r\n\t        clearTimeout(this.refreshTimer);\r\n\t        this.login(function () { });\r\n\t    };\r\n\t    Identity.prototype.getCurrentOauthVersion = function () {\r\n\t        return this.version;\r\n\t    };\r\n\t    Identity.prototype.getAccessTokenAsync = function (resource) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.getAccessToken(resource, (function (error, token) {\r\n\t            if (error) {\r\n\t                d.reject(error);\r\n\t            }\r\n\t            else {\r\n\t                d.resolve(token);\r\n\t            }\r\n\t        }));\r\n\t        return d.promise;\r\n\t    };\r\n\t    Identity.prototype.getAccessToken = function (resource, callback) {\r\n\t        var _this = this;\r\n\t        if (this.version !== OAuthVersion.v1) {\r\n\t            var e = new Error();\r\n\t            e.statusText = \"Currently this identity class is using v2 OAuth mode. You need to use getAccessTokenForScopes() method\";\r\n\t            callback(e);\r\n\t            return;\r\n\t        }\r\n\t        var token = this.tokenCache.getForResource(resource);\r\n\t        if (token) {\r\n\t            return callback(null, token.token);\r\n\t        }\r\n\t        this.getTokenCallback = (function (token, error) {\r\n\t            if (error) {\r\n\t                callback(error);\r\n\t            }\r\n\t            else {\r\n\t                _this.decodeAccessToken(token, resource);\r\n\t                callback(null, token);\r\n\t            }\r\n\t        });\r\n\t        this.nonce = \"token\" + this.generateNonce();\r\n\t        this.state = \"token\" + this.generateNonce();\r\n\t        var iframe = document.createElement('iframe');\r\n\t        iframe.style.display = \"none\";\r\n\t        iframe.id = \"tokenIFrame\";\r\n\t        iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n\t            \"&resource=\" + encodeURIComponent(resource) +\r\n\t            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n\t            \"&state=\" + encodeURIComponent(this.state) +\r\n\t            \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n\t            \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n\t            \"&op=token\";\r\n\t        document.body.appendChild(iframe);\r\n\t    };\r\n\t    Identity.prototype.getAccessTokenForScopesAsync = function (scopes, promptForConsent) {\r\n\t        if (promptForConsent === void 0) { promptForConsent = false; }\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.getAccessTokenForScopes(scopes, promptForConsent, function (token, error) {\r\n\t            if (error) {\r\n\t                d.reject(error);\r\n\t            }\r\n\t            else {\r\n\t                d.resolve(token);\r\n\t            }\r\n\t        });\r\n\t        return d.promise;\r\n\t    };\r\n\t    Identity.prototype.getAccessTokenForScopes = function (scopes, promptForConsent, callback) {\r\n\t        var _this = this;\r\n\t        if (promptForConsent === void 0) { promptForConsent = false; }\r\n\t        if (this.version !== OAuthVersion.v2) {\r\n\t            var e = new Error();\r\n\t            e.statusText = \"Dynamic scopes require v2 mode. Currently this identity class is using v1\";\r\n\t            callback(null, e);\r\n\t            return;\r\n\t        }\r\n\t        var token = this.tokenCache.getForScopes(scopes);\r\n\t        if (token) {\r\n\t            return callback(token.token, null);\r\n\t        }\r\n\t        this.getTokenCallback = (function (token, error) {\r\n\t            if (error) {\r\n\t                if (promptForConsent || !error.text) {\r\n\t                    callback(null, error);\r\n\t                }\r\n\t                else if (error.text.indexOf(\"AADSTS65001\") >= 0) {\r\n\t                    _this.getAccessTokenForScopes(scopes, true, _this.getTokenCallback);\r\n\t                }\r\n\t                else {\r\n\t                    callback(null, error);\r\n\t                }\r\n\t            }\r\n\t            else {\r\n\t                _this.decodeAccessToken(token, null, scopes);\r\n\t                callback(token, null);\r\n\t            }\r\n\t        });\r\n\t        this.nonce = \"token\" + this.generateNonce();\r\n\t        this.state = \"token\" + this.generateNonce();\r\n\t        if (!promptForConsent) {\r\n\t            var iframe = document.createElement('iframe');\r\n\t            iframe.style.display = \"none\";\r\n\t            iframe.id = \"tokenIFrame\";\r\n\t            iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n\t                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\r\n\t                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n\t                \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n\t                \"&state=\" + encodeURIComponent(this.state) +\r\n\t                \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n\t                \"&login_hint=\" + encodeURIComponent(this.idToken.PreferredUsername) +\r\n\t                \"&domain_hint=\" + encodeURIComponent(this.idToken.TenantId === \"9188040d-6c67-4c5b-b112-36a304b66dad\" ? \"consumers\" : \"organizations\") +\r\n\t                \"&op=token\";\r\n\t            document.body.appendChild(iframe);\r\n\t        }\r\n\t        else {\r\n\t            window.open(this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n\t                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\r\n\t                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n\t                \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n\t                \"&state=\" + encodeURIComponent(this.state) +\r\n\t                \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n\t                \"&op=token\", \"_blank\");\r\n\t        }\r\n\t    };\r\n\t    Identity.prototype.loginAsync = function (loginSettings) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.login(function (error) {\r\n\t            if (error) {\r\n\t                d.reject(error);\r\n\t            }\r\n\t            else {\r\n\t                d.resolve(null);\r\n\t            }\r\n\t        }, loginSettings);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Identity.prototype.login = function (callback, loginSettings) {\r\n\t        this.loginCallback = callback;\r\n\t        if (!loginSettings)\r\n\t            loginSettings = {};\r\n\t        if (loginSettings.policy)\r\n\t            this.policy = loginSettings.policy;\r\n\t        if (loginSettings.scopes && this.version === OAuthVersion.v1) {\r\n\t            var e = new Error();\r\n\t            e.text = \"Scopes can only be used with OAuth v2.\";\r\n\t            callback(e);\r\n\t            return;\r\n\t        }\r\n\t        if (loginSettings.policy && !loginSettings.tenant) {\r\n\t            var e = new Error();\r\n\t            e.text = \"In order to use policy (AAD B2C) a tenant must be specified as well.\";\r\n\t            callback(e);\r\n\t            return;\r\n\t        }\r\n\t        this.state = \"login\" + this.generateNonce();\r\n\t        this.nonce = \"login\" + this.generateNonce();\r\n\t        var loginURL = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n\t            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n\t            \"&state=\" + encodeURIComponent(this.state) +\r\n\t            \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n\t            \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n\t            \"&op=login\" +\r\n\t            \"&p=\" + encodeURIComponent(this.policy);\r\n\t        if (loginSettings.tenant) {\r\n\t            loginURL += \"&tenant=\" + encodeURIComponent(loginSettings.tenant);\r\n\t        }\r\n\t        if (this.version === OAuthVersion.v2) {\r\n\t            if (!loginSettings.scopes)\r\n\t                loginSettings.scopes = [];\r\n\t            if (loginSettings.scopes.indexOf(\"profile\") < 0)\r\n\t                loginSettings.scopes.push(\"profile\");\r\n\t            if (loginSettings.scopes.indexOf(\"openid\") < 0)\r\n\t                loginSettings.scopes.push(\"openid\");\r\n\t            loginURL += \"&scopes=\" + encodeURIComponent(loginSettings.scopes.join(\" \"));\r\n\t        }\r\n\t        window.open(loginURL, \"_blank\");\r\n\t    };\r\n\t    Identity.prototype.loginNoWindowAsync = function (toUrl) {\r\n\t        var d = new promises_1.Deferred();\r\n\t        this.loginNoWindow(function (error) {\r\n\t            if (error) {\r\n\t                d.reject(error);\r\n\t            }\r\n\t            else {\r\n\t                d.resolve(null);\r\n\t            }\r\n\t        }, toUrl);\r\n\t        return d.promise;\r\n\t    };\r\n\t    Identity.prototype.loginNoWindow = function (callback, toUrl) {\r\n\t        this.loginCallback = callback;\r\n\t        this.state = \"clientId=\" + this.clientId + \"&\" + \"tokenProcessorUrl=\" + this.tokenProcessorUrl;\r\n\t        this.nonce = this.generateNonce();\r\n\t        var redirected = this.checkForIdentityRedirect();\r\n\t        if (!redirected) {\r\n\t            var redirectUri = (toUrl) ? toUrl : window.location.href.split(\"#\")[0];\r\n\t            var url = \"https://login.microsoftonline.com/common/oauth2/authorize?response_type=id_token\" +\r\n\t                \"&client_id=\" + encodeURIComponent(this.clientId) +\r\n\t                \"&redirect_uri=\" + encodeURIComponent(redirectUri) +\r\n\t                \"&state=\" + encodeURIComponent(this.state) +\r\n\t                \"&nonce=\" + encodeURIComponent(this.nonce);\r\n\t            window.location.href = url;\r\n\t        }\r\n\t    };\r\n\t    Identity.prototype.logOut = function () {\r\n\t        this.tokenCache.clear();\r\n\t        var url = \"https://login.microsoftonline.com/common/oauth2/logout?post_logout_redirect_uri=\" + encodeURI(window.location.href);\r\n\t        window.location.href = url;\r\n\t    };\r\n\t    Identity.prototype.base64Decode = function (encodedString) {\r\n\t        var e = {}, i, b = 0, c, x, l = 0, a, r = '', w = String.fromCharCode, L = encodedString.length;\r\n\t        var A = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\r\n\t        for (i = 0; i < 64; i++) {\r\n\t            e[A.charAt(i)] = i;\r\n\t        }\r\n\t        for (x = 0; x < L; x++) {\r\n\t            c = e[encodedString.charAt(x)];\r\n\t            b = (b << 6) + c;\r\n\t            l += 6;\r\n\t            while (l >= 8) {\r\n\t                ((a = (b >>> (l -= 8)) & 0xff) || (x < (L - 2))) && (r += w(a));\r\n\t            }\r\n\t        }\r\n\t        return r;\r\n\t    };\r\n\t    Identity.prototype.generateNonce = function () {\r\n\t        var text = \"\";\r\n\t        var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n\t        for (var i = 0; i < 32; i++) {\r\n\t            text += chars.charAt(Math.floor(Math.random() * chars.length));\r\n\t        }\r\n\t        return text;\r\n\t    };\r\n\t    return Identity;\r\n\t}());\r\n\texports.Identity = Identity;\r\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\r\n\tvar __extends = (this && this.__extends) || function (d, b) {\r\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\r\n\t    function __() { this.constructor = d; }\r\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n\t};\r\n\tvar Action = (function () {\r\n\t    function Action(pathWithQuery, scopes) {\r\n\t        this.pathWithQuery = pathWithQuery;\r\n\t        this.scopes = scopes;\r\n\t    }\r\n\t    return Action;\r\n\t}());\r\n\texports.Action = Action;\r\n\tfunction queryUnion(query1, query2) {\r\n\t    if (query1)\r\n\t        return query1 + (query2 ? \"&\" + query2 : \"\");\r\n\t    else\r\n\t        return query2;\r\n\t}\r\n\tvar pathWithQuery = function (path, query) { return path + (query ? \"?\" + query : \"\"); };\r\n\tvar Endpoint = (function () {\r\n\t    function Endpoint(path, query) {\r\n\t        var _this = this;\r\n\t        this.path = path;\r\n\t        this.query = query;\r\n\t        this.addQuery = function (query) { return new AddQuery(_this.path, queryUnion(_this.query, query), _this.actions); };\r\n\t        this.pathWithQuery = pathWithQuery(this.path, this.query);\r\n\t        this.path = path;\r\n\t        this.query = query;\r\n\t    }\r\n\t    return Endpoint;\r\n\t}());\r\n\texports.Endpoint = Endpoint;\r\n\tvar AddQuery = (function (_super) {\r\n\t    __extends(AddQuery, _super);\r\n\t    function AddQuery(path, query, actions) {\r\n\t        _super.call(this, path, query);\r\n\t        if (actions) {\r\n\t            for (var verb in actions)\r\n\t                actions[verb].pathWithQuery = pathWithQuery(path, query);\r\n\t            this.actions = actions;\r\n\t        }\r\n\t    }\r\n\t    return AddQuery;\r\n\t}(Endpoint));\r\n\texports.AddQuery = AddQuery;\r\n\tvar Attachment = (function (_super) {\r\n\t    __extends(Attachment, _super);\r\n\t    function Attachment(path, attachmentId) {\r\n\t        _super.call(this, path + \"/attachments/\" + attachmentId);\r\n\t        this.actions = {\r\n\t            GET: new Action(this.path)\r\n\t        };\r\n\t    }\r\n\t    return Attachment;\r\n\t}(Endpoint));\r\n\texports.Attachment = Attachment;\r\n\tvar attachment = function (path) { return function (attachmentId) { return new Attachment(path, attachmentId); }; };\r\n\tvar Attachments = (function (_super) {\r\n\t    __extends(Attachments, _super);\r\n\t    function Attachments(path) {\r\n\t        _super.call(this, path + \"/attachments\");\r\n\t        this.actions = {\r\n\t            GETCOLLECTION: new Action(this.path),\r\n\t        };\r\n\t    }\r\n\t    return Attachments;\r\n\t}(Endpoint));\r\n\texports.Attachments = Attachments;\r\n\tvar attachments = function (path) { return new Attachments(path); };\r\n\tvar Message = (function (_super) {\r\n\t    __extends(Message, _super);\r\n\t    function Message(path, messageId) {\r\n\t        _super.call(this, path + \"/messages/\" + messageId);\r\n\t        this.actions = {\r\n\t            GET: new Action(this.path),\r\n\t            POST: new Action(this.path)\r\n\t        };\r\n\t        this.attachment = attachment(this.path);\r\n\t        this.attachments = attachments(this.path);\r\n\t    }\r\n\t    return Message;\r\n\t}(Endpoint));\r\n\texports.Message = Message;\r\n\tvar message = function (path) { return function (messageId) { return new Message(path, messageId); }; };\r\n\tvar Messages = (function (_super) {\r\n\t    __extends(Messages, _super);\r\n\t    function Messages(path) {\r\n\t        _super.call(this, path + \"/messages/\");\r\n\t        this.actions = {\r\n\t            GETCOLLECTION: new Action(this.path),\r\n\t        };\r\n\t    }\r\n\t    return Messages;\r\n\t}(Endpoint));\r\n\texports.Messages = Messages;\r\n\tvar messages = function (path) { return new Messages(path); };\r\n\tvar Event = (function (_super) {\r\n\t    __extends(Event, _super);\r\n\t    function Event(path, eventId) {\r\n\t        _super.call(this, path + \"/events/\");\r\n\t        this.actions = {\r\n\t            GET: new Action(this.path),\r\n\t        };\r\n\t        this.attachment = attachment(this.path);\r\n\t        this.attachments = attachments(this.path);\r\n\t    }\r\n\t    return Event;\r\n\t}(Endpoint));\r\n\texports.Event = Event;\r\n\tvar event = function (path) { return function (eventId) { return new Event(path, eventId); }; };\r\n\tvar Events = (function (_super) {\r\n\t    __extends(Events, _super);\r\n\t    function Events(path) {\r\n\t        _super.call(this, path + \"/events/\");\r\n\t        this.actions = {\r\n\t            GETCOLLECTION: new Action(this.path),\r\n\t        };\r\n\t    }\r\n\t    return Events;\r\n\t}(Endpoint));\r\n\texports.Events = Events;\r\n\tvar events = function (path) { return new Events(path); };\r\n\tvar CalendarView = (function (_super) {\r\n\t    __extends(CalendarView, _super);\r\n\t    function CalendarView(path, startDate, endDate) {\r\n\t        _super.call(this, path + \"/calendarView\", \"startDateTime=\" + startDate.toString() + \"&endDateTime=\" + endDate.toString());\r\n\t        this.actions = {\r\n\t            GETCOLLECTION: new Action(pathWithQuery(this.path, this.query))\r\n\t        };\r\n\t    }\r\n\t    return CalendarView;\r\n\t}(Endpoint));\r\n\texports.CalendarView = CalendarView;\r\n\tvar calendarView = function (path) { return function (startDate, endDate) { return new CalendarView(path, startDate, endDate); }; };\r\n\tvar User = (function (_super) {\r\n\t    __extends(User, _super);\r\n\t    function User(path, userId) {\r\n\t        if (path === void 0) { path = \"\"; }\r\n\t        _super.call(this, userId ? path + \"/users/\" + userId : path + \"/me\");\r\n\t        this.actions = {\r\n\t            GET: new Action(this.path),\r\n\t        };\r\n\t        this.message = message(this.path);\r\n\t        this.messages = messages(this.path);\r\n\t        this.event = event(this.path);\r\n\t        this.events = events(this.path);\r\n\t        this.calendarView = calendarView(this.path);\r\n\t    }\r\n\t    return User;\r\n\t}(Endpoint));\r\n\texports.User = User;\r\n\tvar me = new User(\"https://graph.microsoft.com/v1.0\");\r\n\tvar user = function (userId) { return new User(\"\", userId); };\r\n\tvar Users = (function (_super) {\r\n\t    __extends(Users, _super);\r\n\t    function Users(path) {\r\n\t        if (path === void 0) { path = \"\"; }\r\n\t        _super.call(this, path + \"/users\");\r\n\t        this.actions = {\r\n\t            GETCOLLECTION: new Action(this.path),\r\n\t        };\r\n\t    }\r\n\t    return Users;\r\n\t}(Endpoint));\r\n\texports.Users = Users;\r\n\tvar users = new Users();\r\n\tvar Root = (function () {\r\n\t    function Root() {\r\n\t        this.me = me;\r\n\t        this.user = user;\r\n\t        this.users = users;\r\n\t    }\r\n\t    return Root;\r\n\t}());\r\n\texports.Root = Root;\r\n\tvar MockGraph = (function () {\r\n\t    function MockGraph() {\r\n\t    }\r\n\t    MockGraph.prototype.getUntypedCollection = function (path, scopes) {\r\n\t        return {};\r\n\t    };\r\n\t    MockGraph.prototype.getTypedCollection = function (path, scopes) {\r\n\t        return this.getUntyped(path, scopes);\r\n\t    };\r\n\t    MockGraph.prototype.getCollection = function (endpoint) {\r\n\t        var action = endpoint.actions && endpoint.actions.GETCOLLECTION;\r\n\t        if (!action) {\r\n\t            console.log(\"no GETCOLLECTION endpoint, sorry!\");\r\n\t        }\r\n\t        else {\r\n\t            console.log(\"GETCOLLECTION path\", action.pathWithQuery);\r\n\t            return this.getTypedCollection(action.pathWithQuery, action.scopes);\r\n\t        }\r\n\t    };\r\n\t    MockGraph.prototype.getUntyped = function (path, scopes) {\r\n\t        return {};\r\n\t    };\r\n\t    MockGraph.prototype.getTyped = function (path, scopes) {\r\n\t        return;\r\n\t    };\r\n\t    MockGraph.prototype.get = function (endpoint) {\r\n\t        var action = endpoint.actions && endpoint.actions.GET;\r\n\t        if (!action) {\r\n\t            console.log(\"no GET endpoint, sorry!\");\r\n\t        }\r\n\t        else {\r\n\t            console.log(\"GET path\", action.pathWithQuery);\r\n\t            return this.getTyped(action.pathWithQuery, action.scopes);\r\n\t        }\r\n\t    };\r\n\t    MockGraph.prototype.postUntyped = function (path, scopes, request) {\r\n\t        return {};\r\n\t    };\r\n\t    MockGraph.prototype.postTyped = function (path, scopes, request) {\r\n\t        return this.postUntyped(path, scopes, request);\r\n\t    };\r\n\t    MockGraph.prototype.post = function (endpoint, request) {\r\n\t        var action = endpoint.actions && endpoint.actions.POST;\r\n\t        if (!action) {\r\n\t            console.log(\"no POST endpoint, sorry!\");\r\n\t        }\r\n\t        else {\r\n\t            console.log(\"POST path\", action.pathWithQuery);\r\n\t            return this.postTyped(action.pathWithQuery, action.scopes, request);\r\n\t        }\r\n\t    };\r\n\t    MockGraph.prototype.patchUntyped = function (path, scopes, request) {\r\n\t        return {};\r\n\t    };\r\n\t    MockGraph.prototype.patchTyped = function (path, scopes, request) {\r\n\t        return this.patchUntyped(path, scopes, request);\r\n\t    };\r\n\t    MockGraph.prototype.patch = function (endpoint, request) {\r\n\t        var action = endpoint.actions && endpoint.actions.PATCH;\r\n\t        if (!action) {\r\n\t            console.log(\"no PATCH endpoint, sorry!\");\r\n\t        }\r\n\t        else {\r\n\t            console.log(\"PATCH path\", action.pathWithQuery);\r\n\t            return this.patchTyped(action.pathWithQuery, action.scopes, request);\r\n\t        }\r\n\t    };\r\n\t    MockGraph.prototype.deleteUntyped = function (path, scopes) {\r\n\t    };\r\n\t    MockGraph.prototype.deleteTyped = function (path, scopes) {\r\n\t    };\r\n\t    MockGraph.prototype.delete = function (endpoint) {\r\n\t        var action = endpoint.actions.DELETE;\r\n\t        if (!action) {\r\n\t            console.log(\"no DELETE endpoint, sorry!\");\r\n\t        }\r\n\t        else {\r\n\t            console.log(\"DELETE path\", action.pathWithQuery);\r\n\t            this.getTyped(action.pathWithQuery, action.scopes);\r\n\t        }\r\n\t    };\r\n\t    return MockGraph;\r\n\t}());\r\n\tvar rb = new Root();\r\n\tvar graph = new MockGraph();\r\n\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** dist/kurve.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 2d27f8fa67d02ff43a20\n **/","\"use strict\";\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n__export(require(\"./graph\"));\r\n__export(require(\"./identity\"));\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/kurve.ts\n ** module id = 0\n ** module chunks = 0\n **/","\"use strict\";\r\nvar __extends = (this && this.__extends) || function (d, b) {\r\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n};\r\nvar promises_1 = require(\"./promises\");\r\nvar identity_1 = require(\"./identity\");\r\nvar requestbuilder_1 = require(\"./requestbuilder\");\r\nvar Scopes;\r\n(function (Scopes) {\r\n    var Util = (function () {\r\n        function Util() {\r\n        }\r\n        Util.rootUrl = \"https://graph.microsoft.com/\";\r\n        return Util;\r\n    }());\r\n    var General = (function () {\r\n        function General() {\r\n        }\r\n        General.OpenId = \"openid\";\r\n        General.OfflineAccess = \"offline_access\";\r\n        return General;\r\n    }());\r\n    Scopes.General = General;\r\n    var User = (function () {\r\n        function User() {\r\n        }\r\n        User.Read = Util.rootUrl + \"User.Read\";\r\n        User.ReadWrite = Util.rootUrl + \"User.ReadWrite\";\r\n        User.ReadBasicAll = Util.rootUrl + \"User.ReadBasic.All\";\r\n        User.ReadAll = Util.rootUrl + \"User.Read.All\";\r\n        User.ReadWriteAll = Util.rootUrl + \"User.ReadWrite.All\";\r\n        return User;\r\n    }());\r\n    Scopes.User = User;\r\n    var Contacts = (function () {\r\n        function Contacts() {\r\n        }\r\n        Contacts.Read = Util.rootUrl + \"Contacts.Read\";\r\n        Contacts.ReadWrite = Util.rootUrl + \"Contacts.ReadWrite\";\r\n        return Contacts;\r\n    }());\r\n    Scopes.Contacts = Contacts;\r\n    var Directory = (function () {\r\n        function Directory() {\r\n        }\r\n        Directory.ReadAll = Util.rootUrl + \"Directory.Read.All\";\r\n        Directory.ReadWriteAll = Util.rootUrl + \"Directory.ReadWrite.All\";\r\n        Directory.AccessAsUserAll = Util.rootUrl + \"Directory.AccessAsUser.All\";\r\n        return Directory;\r\n    }());\r\n    Scopes.Directory = Directory;\r\n    var Group = (function () {\r\n        function Group() {\r\n        }\r\n        Group.ReadAll = Util.rootUrl + \"Group.Read.All\";\r\n        Group.ReadWriteAll = Util.rootUrl + \"Group.ReadWrite.All\";\r\n        Group.AccessAsUserAll = Util.rootUrl + \"Directory.AccessAsUser.All\";\r\n        return Group;\r\n    }());\r\n    Scopes.Group = Group;\r\n    var Mail = (function () {\r\n        function Mail() {\r\n        }\r\n        Mail.Read = Util.rootUrl + \"Mail.Read\";\r\n        Mail.ReadWrite = Util.rootUrl + \"Mail.ReadWrite\";\r\n        Mail.Send = Util.rootUrl + \"Mail.Send\";\r\n        return Mail;\r\n    }());\r\n    Scopes.Mail = Mail;\r\n    var Calendars = (function () {\r\n        function Calendars() {\r\n        }\r\n        Calendars.Read = Util.rootUrl + \"Calendars.Read\";\r\n        Calendars.ReadWrite = Util.rootUrl + \"Calendars.ReadWrite\";\r\n        return Calendars;\r\n    }());\r\n    Scopes.Calendars = Calendars;\r\n    var Files = (function () {\r\n        function Files() {\r\n        }\r\n        Files.Read = Util.rootUrl + \"Files.Read\";\r\n        Files.ReadAll = Util.rootUrl + \"Files.Read.All\";\r\n        Files.ReadWrite = Util.rootUrl + \"Files.ReadWrite\";\r\n        Files.ReadWriteAppFolder = Util.rootUrl + \"Files.ReadWrite.AppFolder\";\r\n        Files.ReadWriteSelected = Util.rootUrl + \"Files.ReadWrite.Selected\";\r\n        return Files;\r\n    }());\r\n    Scopes.Files = Files;\r\n    var Tasks = (function () {\r\n        function Tasks() {\r\n        }\r\n        Tasks.ReadWrite = Util.rootUrl + \"Tasks.ReadWrite\";\r\n        return Tasks;\r\n    }());\r\n    Scopes.Tasks = Tasks;\r\n    var People = (function () {\r\n        function People() {\r\n        }\r\n        People.Read = Util.rootUrl + \"People.Read\";\r\n        People.ReadWrite = Util.rootUrl + \"People.ReadWrite\";\r\n        return People;\r\n    }());\r\n    Scopes.People = People;\r\n    var Notes = (function () {\r\n        function Notes() {\r\n        }\r\n        Notes.Create = Util.rootUrl + \"Notes.Create\";\r\n        Notes.ReadWriteCreatedByApp = Util.rootUrl + \"Notes.ReadWrite.CreatedByApp\";\r\n        Notes.Read = Util.rootUrl + \"Notes.Read\";\r\n        Notes.ReadAll = Util.rootUrl + \"Notes.Read.All\";\r\n        Notes.ReadWriteAll = Util.rootUrl + \"Notes.ReadWrite.All\";\r\n        return Notes;\r\n    }());\r\n    Scopes.Notes = Notes;\r\n})(Scopes = exports.Scopes || (exports.Scopes = {}));\r\nvar DataModelWrapper = (function () {\r\n    function DataModelWrapper(graph, _data) {\r\n        this.graph = graph;\r\n        this._data = _data;\r\n    }\r\n    Object.defineProperty(DataModelWrapper.prototype, \"data\", {\r\n        get: function () { return this._data; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return DataModelWrapper;\r\n}());\r\nexports.DataModelWrapper = DataModelWrapper;\r\nvar DataModelListWrapper = (function (_super) {\r\n    __extends(DataModelListWrapper, _super);\r\n    function DataModelListWrapper() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return DataModelListWrapper;\r\n}(DataModelWrapper));\r\nexports.DataModelListWrapper = DataModelListWrapper;\r\nvar ProfilePhoto = (function (_super) {\r\n    __extends(ProfilePhoto, _super);\r\n    function ProfilePhoto() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return ProfilePhoto;\r\n}(DataModelWrapper));\r\nexports.ProfilePhoto = ProfilePhoto;\r\n(function (EventsEndpoint) {\r\n    EventsEndpoint[EventsEndpoint[\"events\"] = 0] = \"events\";\r\n    EventsEndpoint[EventsEndpoint[\"calendarView\"] = 1] = \"calendarView\";\r\n})(exports.EventsEndpoint || (exports.EventsEndpoint = {}));\r\nvar EventsEndpoint = exports.EventsEndpoint;\r\nvar User = (function (_super) {\r\n    __extends(User, _super);\r\n    function User() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    User.prototype.events = function (callback, odataQuery) {\r\n        this.graph.eventsForUser(this._data.userPrincipalName, EventsEndpoint.events, callback, odataQuery);\r\n    };\r\n    User.prototype.eventsAsync = function (odataQuery) {\r\n        return this.graph.eventsForUserAsync(this._data.userPrincipalName, EventsEndpoint.events, odataQuery);\r\n    };\r\n    User.prototype.memberOf = function (callback, Error, odataQuery) {\r\n        this.graph.memberOfForUser(this._data.userPrincipalName, callback, odataQuery);\r\n    };\r\n    User.prototype.memberOfAsync = function (odataQuery) {\r\n        return this.graph.memberOfForUserAsync(this._data.userPrincipalName, odataQuery);\r\n    };\r\n    User.prototype.messages = function (callback, odataQuery) {\r\n        this.graph.messagesForUser(this._data.userPrincipalName, callback, odataQuery);\r\n    };\r\n    User.prototype.messagesAsync = function (odataQuery) {\r\n        return this.graph.messagesForUserAsync(this._data.userPrincipalName, odataQuery);\r\n    };\r\n    User.prototype.manager = function (callback, odataQuery) {\r\n        this.graph.managerForUser(this._data.userPrincipalName, callback, odataQuery);\r\n    };\r\n    User.prototype.managerAsync = function (odataQuery) {\r\n        return this.graph.managerForUserAsync(this._data.userPrincipalName, odataQuery);\r\n    };\r\n    User.prototype.profilePhoto = function (callback, odataQuery) {\r\n        this.graph.profilePhotoForUser(this._data.userPrincipalName, callback, odataQuery);\r\n    };\r\n    User.prototype.profilePhotoAsync = function (odataQuery) {\r\n        return this.graph.profilePhotoForUserAsync(this._data.userPrincipalName, odataQuery);\r\n    };\r\n    User.prototype.profilePhotoValue = function (callback, odataQuery) {\r\n        this.graph.profilePhotoValueForUser(this._data.userPrincipalName, callback, odataQuery);\r\n    };\r\n    User.prototype.profilePhotoValueAsync = function (odataQuery) {\r\n        return this.graph.profilePhotoValueForUserAsync(this._data.userPrincipalName, odataQuery);\r\n    };\r\n    User.prototype.calendarView = function (callback, odataQuery) {\r\n        this.graph.eventsForUser(this._data.userPrincipalName, EventsEndpoint.calendarView, callback, odataQuery);\r\n    };\r\n    User.prototype.calendarViewAsync = function (odataQuery) {\r\n        return this.graph.eventsForUserAsync(this._data.userPrincipalName, EventsEndpoint.calendarView, odataQuery);\r\n    };\r\n    User.prototype.mailFolders = function (callback, odataQuery) {\r\n        this.graph.mailFoldersForUser(this._data.userPrincipalName, callback, odataQuery);\r\n    };\r\n    User.prototype.mailFoldersAsync = function (odataQuery) {\r\n        return this.graph.mailFoldersForUserAsync(this._data.userPrincipalName, odataQuery);\r\n    };\r\n    User.prototype.message = function (messageId, callback, odataQuery) {\r\n        this.graph.messageForUser(this._data.userPrincipalName, messageId, callback, odataQuery);\r\n    };\r\n    User.prototype.messageAsync = function (messageId, odataQuery) {\r\n        return this.graph.messageForUserAsync(this._data.userPrincipalName, messageId, odataQuery);\r\n    };\r\n    User.prototype.event = function (eventId, callback, odataQuery) {\r\n        this.graph.eventForUser(this._data.userPrincipalName, eventId, callback, odataQuery);\r\n    };\r\n    User.prototype.eventAsync = function (eventId, odataQuery) {\r\n        return this.graph.eventForUserAsync(this._data.userPrincipalName, eventId, odataQuery);\r\n    };\r\n    User.prototype.messageAttachment = function (messageId, attachmentId, callback, odataQuery) {\r\n        this.graph.messageAttachmentForUser(this._data.userPrincipalName, messageId, attachmentId, callback, odataQuery);\r\n    };\r\n    User.prototype.messageAttachmentAsync = function (messageId, attachmentId, odataQuery) {\r\n        return this.graph.messageAttachmentForUserAsync(this._data.userPrincipalName, messageId, attachmentId, odataQuery);\r\n    };\r\n    return User;\r\n}(DataModelWrapper));\r\nexports.User = User;\r\nvar Users = (function (_super) {\r\n    __extends(Users, _super);\r\n    function Users() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Users;\r\n}(DataModelListWrapper));\r\nexports.Users = Users;\r\nvar Message = (function (_super) {\r\n    __extends(Message, _super);\r\n    function Message() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Message;\r\n}(DataModelWrapper));\r\nexports.Message = Message;\r\nvar Messages = (function (_super) {\r\n    __extends(Messages, _super);\r\n    function Messages() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Messages;\r\n}(DataModelListWrapper));\r\nexports.Messages = Messages;\r\nvar Event = (function (_super) {\r\n    __extends(Event, _super);\r\n    function Event() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Event;\r\n}(DataModelWrapper));\r\nexports.Event = Event;\r\nvar Events = (function (_super) {\r\n    __extends(Events, _super);\r\n    function Events(graph, endpoint, _data) {\r\n        _super.call(this, graph, _data);\r\n        this.graph = graph;\r\n        this.endpoint = endpoint;\r\n        this._data = _data;\r\n    }\r\n    return Events;\r\n}(DataModelListWrapper));\r\nexports.Events = Events;\r\nvar Contact = (function () {\r\n    function Contact() {\r\n    }\r\n    return Contact;\r\n}());\r\nexports.Contact = Contact;\r\nvar Group = (function (_super) {\r\n    __extends(Group, _super);\r\n    function Group() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Group;\r\n}(DataModelWrapper));\r\nexports.Group = Group;\r\nvar Groups = (function (_super) {\r\n    __extends(Groups, _super);\r\n    function Groups() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Groups;\r\n}(DataModelListWrapper));\r\nexports.Groups = Groups;\r\nvar MailFolder = (function (_super) {\r\n    __extends(MailFolder, _super);\r\n    function MailFolder() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return MailFolder;\r\n}(DataModelWrapper));\r\nexports.MailFolder = MailFolder;\r\nvar MailFolders = (function (_super) {\r\n    __extends(MailFolders, _super);\r\n    function MailFolders() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return MailFolders;\r\n}(DataModelListWrapper));\r\nexports.MailFolders = MailFolders;\r\n(function (AttachmentType) {\r\n    AttachmentType[AttachmentType[\"fileAttachment\"] = 0] = \"fileAttachment\";\r\n    AttachmentType[AttachmentType[\"itemAttachment\"] = 1] = \"itemAttachment\";\r\n    AttachmentType[AttachmentType[\"referenceAttachment\"] = 2] = \"referenceAttachment\";\r\n})(exports.AttachmentType || (exports.AttachmentType = {}));\r\nvar AttachmentType = exports.AttachmentType;\r\nvar Attachment = (function (_super) {\r\n    __extends(Attachment, _super);\r\n    function Attachment() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    Attachment.prototype.getType = function () {\r\n        switch (this._data['@odata.type']) {\r\n            case \"#microsoft.graph.fileAttachment\":\r\n                return AttachmentType.fileAttachment;\r\n            case \"#microsoft.graph.itemAttachment\":\r\n                return AttachmentType.itemAttachment;\r\n            case \"#microsoft.graph.referenceAttachment\":\r\n                return AttachmentType.referenceAttachment;\r\n        }\r\n    };\r\n    return Attachment;\r\n}(DataModelWrapper));\r\nexports.Attachment = Attachment;\r\nvar Attachments = (function (_super) {\r\n    __extends(Attachments, _super);\r\n    function Attachments() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Attachments;\r\n}(DataModelListWrapper));\r\nexports.Attachments = Attachments;\r\nvar Graph = (function () {\r\n    function Graph(identityInfo) {\r\n        this.req = null;\r\n        this.accessToken = null;\r\n        this.KurveIdentity = null;\r\n        this.defaultResourceID = \"https://graph.microsoft.com\";\r\n        this.baseUrl = \"https://graph.microsoft.com/v1.0/\";\r\n        if (identityInfo.defaultAccessToken) {\r\n            this.accessToken = identityInfo.defaultAccessToken;\r\n        }\r\n        else {\r\n            this.KurveIdentity = identityInfo.identity;\r\n        }\r\n    }\r\n    Graph.prototype.scopesForV2 = function (scopes) {\r\n        if (!this.KurveIdentity)\r\n            return null;\r\n        if (this.KurveIdentity.getCurrentOauthVersion() === identity_1.OAuthVersion.v1)\r\n            return null;\r\n        else\r\n            return scopes;\r\n    };\r\n    Graph.prototype.meAsync = function (odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.me(function (error, user) { return error ? d.reject(error) : d.resolve(user); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.me = function (callback, odataQuery) {\r\n        var _this = this;\r\n        this.endpointGet(new requestbuilder_1.Root().me)\r\n            .then(function (result) { return callback(null, new User(_this, result)); })\r\n            .fail(function (error) { return callback(error); });\r\n    };\r\n    Graph.prototype.userAsync = function (userId, odataQuery, basicProfileOnly) {\r\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n        var d = new promises_1.Deferred();\r\n        this.user(userId, function (error, user) { return error ? d.reject(error) : d.resolve(user); }, odataQuery, basicProfileOnly);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.user = function (userId, callback, odataQuery, basicProfileOnly) {\r\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n        var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\r\n        var urlString = this.buildUsersUrl(userId, odataQuery);\r\n        this.getUser(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.usersAsync = function (odataQuery, basicProfileOnly) {\r\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n        var d = new promises_1.Deferred();\r\n        this.users(function (error, users) { return error ? d.reject(error) : d.resolve(users); }, odataQuery, basicProfileOnly);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.users = function (callback, odataQuery, basicProfileOnly) {\r\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n        var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\r\n        var urlString = this.buildUsersUrl(\"\", odataQuery);\r\n        this.getUsers(urlString, callback, this.scopesForV2(scopes), basicProfileOnly);\r\n    };\r\n    Graph.prototype.groupAsync = function (groupId, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.group(groupId, function (error, group) { return error ? d.reject(error) : d.resolve(group); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.group = function (groupId, callback, odataQuery) {\r\n        var scopes = [Scopes.Group.ReadAll];\r\n        var urlString = this.buildGroupsUrl(groupId, odataQuery);\r\n        this.getGroup(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.groupsAsync = function (odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.groups(function (error, groups) { return error ? d.reject(error) : d.resolve(groups); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.groups = function (callback, odataQuery) {\r\n        var scopes = [Scopes.Group.ReadAll];\r\n        var urlString = this.buildGroupsUrl(\"\", odataQuery);\r\n        this.getGroups(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.messageForUserAsync = function (userPrincipalName, messageId, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.messageForUser(userPrincipalName, messageId, function (error, message) { return error ? d.reject(error) : d.resolve(message); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.messageForUser = function (userPrincipalName, messageId, callback, odataQuery) {\r\n        var scopes = [Scopes.Mail.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages/\" + messageId, odataQuery);\r\n        this.getMessage(urlString, messageId, function (error, result) { return callback(error, result); }, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.messagesForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.messagesForUser(userPrincipalName, function (error, messages) { return error ? d.reject(error) : d.resolve(messages); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.messagesForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.Mail.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages\", odataQuery);\r\n        this.getMessages(urlString, function (error, result) { return callback(error, result); }, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.mailFoldersForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.mailFoldersForUser(userPrincipalName, function (error, messages) { return error ? d.reject(error) : d.resolve(messages); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.mailFoldersForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.Mail.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/mailFolders\", odataQuery);\r\n        this.getMailFolders(urlString, function (error, result) { return callback(error, result); }, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.eventForUserAsync = function (userPrincipalName, eventId, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.eventForUser(userPrincipalName, eventId, function (error, event) { return error ? d.reject(error) : d.resolve(event); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.eventForUser = function (userPrincipalName, eventId, callback, odataQuery) {\r\n        var scopes = [Scopes.Calendars.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/events/\" + eventId, odataQuery);\r\n        this.getEvent(urlString, eventId, function (error, result) { return callback(error, result); }, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.eventsForUserAsync = function (userPrincipalName, endpoint, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.eventsForUser(userPrincipalName, endpoint, function (error, events) { return error ? d.reject(error) : d.resolve(events); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.eventsForUser = function (userPrincipalName, endpoint, callback, odataQuery) {\r\n        var scopes = [Scopes.Calendars.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/\" + EventsEndpoint[endpoint], odataQuery);\r\n        this.getEvents(urlString, endpoint, function (error, result) { return callback(error, result); }, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.memberOfForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.memberOfForUser(userPrincipalName, function (error, groups) { return error ? d.reject(error) : d.resolve(groups); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.memberOfForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.Group.ReadAll];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/memberOf\", odataQuery);\r\n        this.getGroups(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.managerForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.managerForUser(userPrincipalName, function (error, user) { return error ? d.reject(error) : d.resolve(user); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.managerForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.Directory.ReadAll];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/manager\", odataQuery);\r\n        this.getUser(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.directReportsForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.directReportsForUser(userPrincipalName, function (error, users) { return error ? d.reject(error) : d.resolve(users); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.directReportsForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.Directory.ReadAll];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/directReports\", odataQuery);\r\n        this.getUsers(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.profilePhotoForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.profilePhotoForUser(userPrincipalName, function (error, profilePhoto) { return error ? d.reject(error) : d.resolve(profilePhoto); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.profilePhotoForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.User.ReadBasicAll];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/photo\", odataQuery);\r\n        this.getPhoto(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.profilePhotoValueForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.profilePhotoValueForUser(userPrincipalName, function (error, result) { return error ? d.reject(error) : d.resolve(result); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.profilePhotoValueForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.User.ReadBasicAll];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/photo/$value\", odataQuery);\r\n        this.getPhotoValue(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.messageAttachmentsForUserAsync = function (userPrincipalName, messageId, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.messageAttachmentsForUser(userPrincipalName, messageId, function (error, result) { return error ? d.reject(error) : d.resolve(result); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.messageAttachmentsForUser = function (userPrincipalName, messageId, callback, odataQuery) {\r\n        var scopes = [Scopes.Mail.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages/\" + messageId + \"/attachments\", odataQuery);\r\n        this.getMessageAttachments(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.messageAttachmentForUserAsync = function (userPrincipalName, messageId, attachmentId, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.messageAttachmentForUser(userPrincipalName, messageId, attachmentId, function (error, attachment) { return error ? d.reject(error) : d.resolve(attachment); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.messageAttachmentForUser = function (userPrincipalName, messageId, attachmentId, callback, odataQuery) {\r\n        var scopes = [Scopes.Mail.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages/\" + messageId + \"/attachments/\" + attachmentId, odataQuery);\r\n        this.getMessageAttachment(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.getAsync = function (url) {\r\n        var d = new promises_1.Deferred();\r\n        this.get(url, function (error, response) { return error ? d.reject(error) : d.resolve(response); });\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.get = function (url, callback, responseType, scopes) {\r\n        var _this = this;\r\n        var xhr = new XMLHttpRequest();\r\n        if (responseType)\r\n            xhr.responseType = responseType;\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState === 4)\r\n                if (xhr.status === 200)\r\n                    callback(null, responseType ? xhr.response : xhr.responseText);\r\n                else\r\n                    callback(_this.generateError(xhr));\r\n        };\r\n        xhr.open(\"GET\", url);\r\n        this.addAccessTokenAndSend(xhr, function (addTokenError) {\r\n            if (addTokenError) {\r\n                callback(addTokenError);\r\n            }\r\n        }, scopes);\r\n    };\r\n    Graph.prototype.generateError = function (xhr) {\r\n        var response = new identity_1.Error();\r\n        response.status = xhr.status;\r\n        response.statusText = xhr.statusText;\r\n        if (xhr.responseType === '' || xhr.responseType === 'text')\r\n            response.text = xhr.responseText;\r\n        else\r\n            response.other = xhr.response;\r\n        return response;\r\n    };\r\n    Graph.prototype.endpointGet = function (endpoint) {\r\n        var d = new promises_1.Deferred();\r\n        this.get(endpoint.pathWithQuery, function (error, result) {\r\n            var jsonResult = JSON.parse(result);\r\n            if (jsonResult.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = jsonResult.error;\r\n                d.reject(errorODATA);\r\n                return;\r\n            }\r\n            d.resolve(jsonResult);\r\n        });\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.getUsers = function (urlString, callback, scopes, basicProfileOnly) {\r\n        var _this = this;\r\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n        this.get(urlString, function (errorGet, result) {\r\n            if (errorGet) {\r\n                callback(errorGet);\r\n                return;\r\n            }\r\n            var usersODATA = JSON.parse(result);\r\n            if (usersODATA.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = usersODATA.error;\r\n                callback(errorODATA);\r\n                return;\r\n            }\r\n            var resultsArray = (usersODATA.value ? usersODATA.value : [usersODATA]);\r\n            var users = new Users(_this, resultsArray.map(function (o) { return new User(_this, o); }));\r\n            var nextLink = usersODATA['@odata.nextLink'];\r\n            if (nextLink) {\r\n                users.nextLink = function (callback) {\r\n                    var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\r\n                    var d = new promises_1.Deferred();\r\n                    _this.getUsers(nextLink, function (error, result) {\r\n                        if (callback)\r\n                            callback(error, result);\r\n                        else\r\n                            error ? d.reject(error) : d.resolve(result);\r\n                    }, _this.scopesForV2(scopes), basicProfileOnly);\r\n                    return d.promise;\r\n                };\r\n            }\r\n            callback(null, users);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getUser = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (errorGet, result) {\r\n            if (errorGet) {\r\n                callback(errorGet);\r\n                return;\r\n            }\r\n            var userODATA = JSON.parse(result);\r\n            if (userODATA.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = userODATA.error;\r\n                callback(errorODATA);\r\n                return;\r\n            }\r\n            var user = new User(_this, userODATA);\r\n            callback(null, user);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.addAccessTokenAndSend = function (xhr, callback, scopes) {\r\n        if (this.accessToken) {\r\n            xhr.setRequestHeader('Authorization', 'Bearer ' + this.accessToken);\r\n            xhr.send();\r\n        }\r\n        else {\r\n            if (scopes) {\r\n                this.KurveIdentity.getAccessTokenForScopes(scopes, false, (function (token, error) {\r\n                    if (error)\r\n                        callback(error);\r\n                    else {\r\n                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\r\n                        xhr.send();\r\n                        callback(null);\r\n                    }\r\n                }));\r\n            }\r\n            else {\r\n                this.KurveIdentity.getAccessToken(this.defaultResourceID, (function (error, token) {\r\n                    if (error)\r\n                        callback(error);\r\n                    else {\r\n                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\r\n                        xhr.send();\r\n                        callback(null);\r\n                    }\r\n                }));\r\n            }\r\n        }\r\n    };\r\n    Graph.prototype.getMessage = function (urlString, messageId, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (errorGet, result) {\r\n            if (errorGet) {\r\n                callback(errorGet);\r\n                return;\r\n            }\r\n            var ODATA = JSON.parse(result);\r\n            if (ODATA.error) {\r\n                var ODATAError = new identity_1.Error();\r\n                ODATAError.other = ODATA.error;\r\n                callback(ODATAError);\r\n                return;\r\n            }\r\n            var message = new Message(_this, ODATA);\r\n            callback(null, message);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getMessages = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (errorGet, result) {\r\n            if (errorGet) {\r\n                callback(errorGet);\r\n                return;\r\n            }\r\n            var messagesODATA = JSON.parse(result);\r\n            if (messagesODATA.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = messagesODATA.error;\r\n                callback(errorODATA);\r\n                return;\r\n            }\r\n            var resultsArray = (messagesODATA.value ? messagesODATA.value : [messagesODATA]);\r\n            var messages = new Messages(_this, resultsArray.map(function (o) { return new Message(_this, o); }));\r\n            var nextLink = messagesODATA['@odata.nextLink'];\r\n            if (nextLink) {\r\n                messages.nextLink = function (callback) {\r\n                    var scopes = [Scopes.Mail.Read];\r\n                    var d = new promises_1.Deferred();\r\n                    _this.getMessages(nextLink, function (error, messages) {\r\n                        if (callback)\r\n                            callback(error, messages);\r\n                        else\r\n                            error ? d.reject(error) : d.resolve(messages);\r\n                    }, _this.scopesForV2(scopes));\r\n                    return d.promise;\r\n                };\r\n            }\r\n            callback(null, messages);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getEvent = function (urlString, EventId, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (errorGet, result) {\r\n            if (errorGet) {\r\n                callback(errorGet);\r\n                return;\r\n            }\r\n            var ODATA = JSON.parse(result);\r\n            if (ODATA.error) {\r\n                var ODATAError = new identity_1.Error();\r\n                ODATAError.other = ODATA.error;\r\n                callback(ODATAError);\r\n                return;\r\n            }\r\n            var event = new Event(_this, ODATA);\r\n            callback(null, event);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getEvents = function (urlString, endpoint, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (errorGet, result) {\r\n            if (errorGet) {\r\n                callback(errorGet);\r\n                return;\r\n            }\r\n            var odata = JSON.parse(result);\r\n            if (odata.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = odata.error;\r\n                callback(errorODATA);\r\n                return;\r\n            }\r\n            var resultsArray = (odata.value ? odata.value : [odata]);\r\n            var events = new Events(_this, endpoint, resultsArray.map(function (o) { return new Event(_this, o); }));\r\n            var nextLink = odata['@odata.nextLink'];\r\n            if (nextLink) {\r\n                events.nextLink = function (callback) {\r\n                    var scopes = [Scopes.Mail.Read];\r\n                    var d = new promises_1.Deferred();\r\n                    _this.getEvents(nextLink, endpoint, function (error, result) {\r\n                        if (callback)\r\n                            callback(error, result);\r\n                        else\r\n                            error ? d.reject(error) : d.resolve(result);\r\n                    }, _this.scopesForV2(scopes));\r\n                    return d.promise;\r\n                };\r\n            }\r\n            callback(null, events);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getGroups = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (errorGet, result) {\r\n            if (errorGet) {\r\n                callback(errorGet);\r\n                return;\r\n            }\r\n            var groupsODATA = JSON.parse(result);\r\n            if (groupsODATA.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = groupsODATA.error;\r\n                callback(errorODATA);\r\n                return;\r\n            }\r\n            var resultsArray = (groupsODATA.value ? groupsODATA.value : [groupsODATA]);\r\n            var groups = new Groups(_this, resultsArray.map(function (o) { return new Group(_this, o); }));\r\n            var nextLink = groupsODATA['@odata.nextLink'];\r\n            if (nextLink) {\r\n                groups.nextLink = function (callback) {\r\n                    var scopes = [Scopes.Group.ReadAll];\r\n                    var d = new promises_1.Deferred();\r\n                    _this.getGroups(nextLink, function (error, result) {\r\n                        if (callback)\r\n                            callback(error, result);\r\n                        else\r\n                            error ? d.reject(error) : d.resolve(result);\r\n                    }, _this.scopesForV2(scopes));\r\n                    return d.promise;\r\n                };\r\n            }\r\n            callback(null, groups);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getGroup = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (errorGet, result) {\r\n            if (errorGet) {\r\n                callback(errorGet);\r\n                return;\r\n            }\r\n            var ODATA = JSON.parse(result);\r\n            if (ODATA.error) {\r\n                var ODATAError = new identity_1.Error();\r\n                ODATAError.other = ODATA.error;\r\n                callback(ODATAError);\r\n                return;\r\n            }\r\n            var group = new Group(_this, ODATA);\r\n            callback(null, group);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getPhoto = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (errorGet, result) {\r\n            if (errorGet) {\r\n                callback(errorGet);\r\n                return;\r\n            }\r\n            var ODATA = JSON.parse(result);\r\n            if (ODATA.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = ODATA.error;\r\n                callback(errorODATA);\r\n                return;\r\n            }\r\n            var photo = new ProfilePhoto(_this, ODATA);\r\n            callback(null, photo);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getPhotoValue = function (urlString, callback, scopes) {\r\n        this.get(urlString, function (errorGet, result) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            callback(result);\r\n        }, \"blob\", scopes);\r\n    };\r\n    Graph.prototype.getMailFolders = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (errorGet, result) {\r\n            if (errorGet) {\r\n                callback(errorGet);\r\n                return;\r\n            }\r\n            var odata = JSON.parse(result);\r\n            if (odata.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = odata.error;\r\n                callback(errorODATA);\r\n            }\r\n            var resultsArray = (odata.value ? odata.value : [odata]);\r\n            var mailFolders = new MailFolders(_this, resultsArray.map(function (o) { return new MailFolder(_this, o); }));\r\n            var nextLink = odata['@odata.nextLink'];\r\n            if (nextLink) {\r\n                mailFolders.nextLink = function (callback) {\r\n                    var scopes = [Scopes.User.ReadAll];\r\n                    var d = new promises_1.Deferred();\r\n                    _this.getMailFolders(nextLink, function (error, result) {\r\n                        if (callback)\r\n                            callback(error, result);\r\n                        else\r\n                            error ? d.reject(error) : d.resolve(result);\r\n                    }, _this.scopesForV2(scopes));\r\n                    return d.promise;\r\n                };\r\n            }\r\n            callback(null, mailFolders);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getMessageAttachments = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (errorGet, result) {\r\n            if (errorGet) {\r\n                callback(errorGet);\r\n                return;\r\n            }\r\n            var attachmentsODATA = JSON.parse(result);\r\n            if (attachmentsODATA.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = attachmentsODATA.error;\r\n                callback(errorODATA);\r\n                return;\r\n            }\r\n            var resultsArray = (attachmentsODATA.value ? attachmentsODATA.value : [attachmentsODATA]);\r\n            var attachments = new Attachments(_this, resultsArray.map(function (o) { return new Attachment(_this, o); }));\r\n            var nextLink = attachmentsODATA['@odata.nextLink'];\r\n            if (nextLink) {\r\n                attachments.nextLink = function (callback) {\r\n                    var scopes = [Scopes.Mail.Read];\r\n                    var d = new promises_1.Deferred();\r\n                    _this.getMessageAttachments(nextLink, function (error, attachments) {\r\n                        if (callback)\r\n                            callback(error, attachments);\r\n                        else\r\n                            error ? d.reject(error) : d.resolve(attachments);\r\n                    }, _this.scopesForV2(scopes));\r\n                    return d.promise;\r\n                };\r\n            }\r\n            callback(null, attachments);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getMessageAttachment = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (errorGet, result) {\r\n            if (errorGet) {\r\n                callback(errorGet);\r\n                return;\r\n            }\r\n            var ODATA = JSON.parse(result);\r\n            if (ODATA.error) {\r\n                var ODATAError = new identity_1.Error();\r\n                ODATAError.other = ODATA.error;\r\n                callback(ODATAError);\r\n                return;\r\n            }\r\n            var attachment = new Attachment(_this, ODATA);\r\n            callback(null, attachment);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.buildUrl = function (root, path, odataQuery) {\r\n        return this.baseUrl + root + path + (odataQuery ? \"?\" + odataQuery : \"\");\r\n    };\r\n    Graph.prototype.buildMeUrl = function (path, odataQuery) {\r\n        if (path === void 0) { path = \"\"; }\r\n        return this.buildUrl(\"me/\", path, odataQuery);\r\n    };\r\n    Graph.prototype.buildUsersUrl = function (path, odataQuery) {\r\n        if (path === void 0) { path = \"\"; }\r\n        return this.buildUrl(\"users/\", path, odataQuery);\r\n    };\r\n    Graph.prototype.buildGroupsUrl = function (path, odataQuery) {\r\n        if (path === void 0) { path = \"\"; }\r\n        return this.buildUrl(\"groups/\", path, odataQuery);\r\n    };\r\n    return Graph;\r\n}());\r\nexports.Graph = Graph;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/graph.ts\n ** module id = 1\n ** module chunks = 0\n **/","\"use strict\";\r\nfunction DispatchDeferred(closure) {\r\n    setTimeout(closure, 0);\r\n}\r\nvar PromiseState;\r\n(function (PromiseState) {\r\n    PromiseState[PromiseState[\"Pending\"] = 0] = \"Pending\";\r\n    PromiseState[PromiseState[\"ResolutionInProgress\"] = 1] = \"ResolutionInProgress\";\r\n    PromiseState[PromiseState[\"Resolved\"] = 2] = \"Resolved\";\r\n    PromiseState[PromiseState[\"Rejected\"] = 3] = \"Rejected\";\r\n})(PromiseState || (PromiseState = {}));\r\nvar Client = (function () {\r\n    function Client(_dispatcher, _successCB, _errorCB) {\r\n        this._dispatcher = _dispatcher;\r\n        this._successCB = _successCB;\r\n        this._errorCB = _errorCB;\r\n        this.result = new Deferred(_dispatcher);\r\n    }\r\n    Client.prototype.resolve = function (value, defer) {\r\n        var _this = this;\r\n        if (typeof (this._successCB) !== 'function') {\r\n            this.result.resolve(value);\r\n            return;\r\n        }\r\n        if (defer) {\r\n            this._dispatcher(function () { return _this._dispatchCallback(_this._successCB, value); });\r\n        }\r\n        else {\r\n            this._dispatchCallback(this._successCB, value);\r\n        }\r\n    };\r\n    Client.prototype.reject = function (error, defer) {\r\n        var _this = this;\r\n        if (typeof (this._errorCB) !== 'function') {\r\n            this.result.reject(error);\r\n            return;\r\n        }\r\n        if (defer) {\r\n            this._dispatcher(function () { return _this._dispatchCallback(_this._errorCB, error); });\r\n        }\r\n        else {\r\n            this._dispatchCallback(this._errorCB, error);\r\n        }\r\n    };\r\n    Client.prototype._dispatchCallback = function (callback, arg) {\r\n        var result, then, type;\r\n        try {\r\n            result = callback(arg);\r\n            this.result.resolve(result);\r\n        }\r\n        catch (err) {\r\n            this.result.reject(err);\r\n            return;\r\n        }\r\n    };\r\n    return Client;\r\n}());\r\nvar Deferred = (function () {\r\n    function Deferred(dispatcher) {\r\n        this._stack = [];\r\n        this._state = PromiseState.Pending;\r\n        if (dispatcher)\r\n            this._dispatcher = dispatcher;\r\n        else\r\n            this._dispatcher = DispatchDeferred;\r\n        this.promise = new Promise(this);\r\n    }\r\n    Deferred.prototype.DispatchDeferred = function (closure) {\r\n        setTimeout(closure, 0);\r\n    };\r\n    Deferred.prototype.then = function (successCB, errorCB) {\r\n        if (typeof (successCB) !== 'function' && typeof (errorCB) !== 'function') {\r\n            return this.promise;\r\n        }\r\n        var client = new Client(this._dispatcher, successCB, errorCB);\r\n        switch (this._state) {\r\n            case PromiseState.Pending:\r\n            case PromiseState.ResolutionInProgress:\r\n                this._stack.push(client);\r\n                break;\r\n            case PromiseState.Resolved:\r\n                client.resolve(this._value, true);\r\n                break;\r\n            case PromiseState.Rejected:\r\n                client.reject(this._error, true);\r\n                break;\r\n        }\r\n        return client.result.promise;\r\n    };\r\n    Deferred.prototype.resolve = function (value) {\r\n        if (this._state !== PromiseState.Pending) {\r\n            return this;\r\n        }\r\n        return this._resolve(value);\r\n    };\r\n    Deferred.prototype._resolve = function (value) {\r\n        var _this = this;\r\n        var type = typeof (value), then, pending = true;\r\n        try {\r\n            if (value !== null &&\r\n                (type === 'object' || type === 'function') &&\r\n                typeof (then = value.then) === 'function') {\r\n                if (value === this.promise) {\r\n                    throw new TypeError('recursive resolution');\r\n                }\r\n                this._state = PromiseState.ResolutionInProgress;\r\n                then.call(value, function (result) {\r\n                    if (pending) {\r\n                        pending = false;\r\n                        _this._resolve(result);\r\n                    }\r\n                }, function (error) {\r\n                    if (pending) {\r\n                        pending = false;\r\n                        _this._reject(error);\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                this._state = PromiseState.ResolutionInProgress;\r\n                this._dispatcher(function () {\r\n                    _this._state = PromiseState.Resolved;\r\n                    _this._value = value;\r\n                    var i, stackSize = _this._stack.length;\r\n                    for (i = 0; i < stackSize; i++) {\r\n                        _this._stack[i].resolve(value, false);\r\n                    }\r\n                    _this._stack.splice(0, stackSize);\r\n                });\r\n            }\r\n        }\r\n        catch (err) {\r\n            if (pending) {\r\n                this._reject(err);\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    Deferred.prototype.reject = function (error) {\r\n        if (this._state !== PromiseState.Pending) {\r\n            return this;\r\n        }\r\n        return this._reject(error);\r\n    };\r\n    Deferred.prototype._reject = function (error) {\r\n        var _this = this;\r\n        this._state = PromiseState.ResolutionInProgress;\r\n        this._dispatcher(function () {\r\n            _this._state = PromiseState.Rejected;\r\n            _this._error = error;\r\n            var stackSize = _this._stack.length, i = 0;\r\n            for (i = 0; i < stackSize; i++) {\r\n                _this._stack[i].reject(error, false);\r\n            }\r\n            _this._stack.splice(0, stackSize);\r\n        });\r\n        return this;\r\n    };\r\n    return Deferred;\r\n}());\r\nexports.Deferred = Deferred;\r\nvar Promise = (function () {\r\n    function Promise(_deferred) {\r\n        this._deferred = _deferred;\r\n    }\r\n    Promise.prototype.then = function (successCallback, errorCallback) {\r\n        return this._deferred.then(successCallback, errorCallback);\r\n    };\r\n    Promise.prototype.fail = function (errorCallback) {\r\n        return this._deferred.then(undefined, errorCallback);\r\n    };\r\n    return Promise;\r\n}());\r\nexports.Promise = Promise;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/promises.ts\n ** module id = 2\n ** module chunks = 0\n **/","\"use strict\";\r\nvar promises_1 = require(\"./promises\");\r\n(function (OAuthVersion) {\r\n    OAuthVersion[OAuthVersion[\"v1\"] = 1] = \"v1\";\r\n    OAuthVersion[OAuthVersion[\"v2\"] = 2] = \"v2\";\r\n})(exports.OAuthVersion || (exports.OAuthVersion = {}));\r\nvar OAuthVersion = exports.OAuthVersion;\r\nvar Error = (function () {\r\n    function Error() {\r\n    }\r\n    return Error;\r\n}());\r\nexports.Error = Error;\r\nvar CachedToken = (function () {\r\n    function CachedToken(id, scopes, resource, token, expiry) {\r\n        this.id = id;\r\n        this.scopes = scopes;\r\n        this.resource = resource;\r\n        this.token = token;\r\n        this.expiry = expiry;\r\n    }\r\n    ;\r\n    Object.defineProperty(CachedToken.prototype, \"isExpired\", {\r\n        get: function () {\r\n            return this.expiry <= new Date(new Date().getTime() + 60000);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CachedToken.prototype.hasScopes = function (requiredScopes) {\r\n        var _this = this;\r\n        if (!this.scopes) {\r\n            return false;\r\n        }\r\n        return requiredScopes.every(function (requiredScope) {\r\n            return _this.scopes.some(function (actualScope) { return requiredScope === actualScope; });\r\n        });\r\n    };\r\n    return CachedToken;\r\n}());\r\nvar TokenCache = (function () {\r\n    function TokenCache(tokenStorage) {\r\n        var _this = this;\r\n        this.tokenStorage = tokenStorage;\r\n        this.cachedTokens = {};\r\n        if (tokenStorage) {\r\n            tokenStorage.getAll().forEach(function (_a) {\r\n                var id = _a.id, scopes = _a.scopes, resource = _a.resource, token = _a.token, expiry = _a.expiry;\r\n                var cachedToken = new CachedToken(id, scopes, resource, token, new Date(expiry));\r\n                if (cachedToken.isExpired) {\r\n                    _this.tokenStorage.remove(cachedToken.id);\r\n                }\r\n                else {\r\n                    _this.cachedTokens[cachedToken.id] = cachedToken;\r\n                }\r\n            });\r\n        }\r\n    }\r\n    TokenCache.prototype.add = function (token) {\r\n        this.cachedTokens[token.id] = token;\r\n        this.tokenStorage && this.tokenStorage.add(token.id, token);\r\n    };\r\n    TokenCache.prototype.getForResource = function (resource) {\r\n        var cachedToken = this.cachedTokens[resource];\r\n        if (cachedToken && cachedToken.isExpired) {\r\n            this.remove(resource);\r\n            return null;\r\n        }\r\n        return cachedToken;\r\n    };\r\n    TokenCache.prototype.getForScopes = function (scopes) {\r\n        for (var key in this.cachedTokens) {\r\n            var cachedToken = this.cachedTokens[key];\r\n            if (cachedToken.hasScopes(scopes)) {\r\n                if (cachedToken.isExpired) {\r\n                    this.remove(key);\r\n                }\r\n                else {\r\n                    return cachedToken;\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    TokenCache.prototype.clear = function () {\r\n        this.cachedTokens = {};\r\n        this.tokenStorage && this.tokenStorage.clear();\r\n    };\r\n    TokenCache.prototype.remove = function (key) {\r\n        this.tokenStorage && this.tokenStorage.remove(key);\r\n        delete this.cachedTokens[key];\r\n    };\r\n    return TokenCache;\r\n}());\r\nvar IdToken = (function () {\r\n    function IdToken() {\r\n    }\r\n    return IdToken;\r\n}());\r\nexports.IdToken = IdToken;\r\nvar Identity = (function () {\r\n    function Identity(identitySettings) {\r\n        var _this = this;\r\n        this.policy = \"\";\r\n        this.clientId = identitySettings.clientId;\r\n        this.tokenProcessorUrl = identitySettings.tokenProcessingUri;\r\n        if (identitySettings.version)\r\n            this.version = identitySettings.version;\r\n        else\r\n            this.version = OAuthVersion.v1;\r\n        this.tokenCache = new TokenCache(identitySettings.tokenStorage);\r\n        window.addEventListener(\"message\", function (event) {\r\n            if (event.data.type === \"id_token\") {\r\n                if (event.data.error) {\r\n                    var e = new Error();\r\n                    e.text = event.data.error;\r\n                    _this.loginCallback(e);\r\n                }\r\n                else {\r\n                    if (_this.state !== event.data.state) {\r\n                        var error = new Error();\r\n                        error.statusText = \"Invalid state\";\r\n                        _this.loginCallback(error);\r\n                    }\r\n                    else {\r\n                        _this.decodeIdToken(event.data.token);\r\n                        _this.loginCallback(null);\r\n                    }\r\n                }\r\n            }\r\n            else if (event.data.type === \"access_token\") {\r\n                if (event.data.error) {\r\n                    var e = new Error();\r\n                    e.text = event.data.error;\r\n                    _this.getTokenCallback(null, e);\r\n                }\r\n                else {\r\n                    var token = event.data.token;\r\n                    var iframe = document.getElementById(\"tokenIFrame\");\r\n                    iframe.parentNode.removeChild(iframe);\r\n                    if (event.data.state !== _this.state) {\r\n                        var error = new Error();\r\n                        error.statusText = \"Invalid state\";\r\n                        _this.getTokenCallback(null, error);\r\n                    }\r\n                    else {\r\n                        _this.getTokenCallback(token, null);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n    Identity.prototype.checkForIdentityRedirect = function () {\r\n        function token(s) {\r\n            var start = window.location.href.indexOf(s);\r\n            if (start < 0)\r\n                return null;\r\n            var end = window.location.href.indexOf(\"&\", start + s.length);\r\n            return window.location.href.substring(start, ((end > 0) ? end : window.location.href.length));\r\n        }\r\n        function parseQueryString(str) {\r\n            var queryString = str || window.location.search || '';\r\n            var keyValPairs = [];\r\n            var params = {};\r\n            queryString = queryString.replace(/.*?\\?/, \"\");\r\n            if (queryString.length) {\r\n                keyValPairs = queryString.split('&');\r\n                for (var pairNum in keyValPairs) {\r\n                    var key = keyValPairs[pairNum].split('=')[0];\r\n                    if (!key.length)\r\n                        continue;\r\n                    if (typeof params[key] === 'undefined')\r\n                        params[key] = [];\r\n                    params[key].push(keyValPairs[pairNum].split('=')[1]);\r\n                }\r\n            }\r\n            return params;\r\n        }\r\n        var params = parseQueryString(window.location.href);\r\n        var idToken = token(\"#id_token=\");\r\n        var accessToken = token(\"#access_token\");\r\n        if (idToken) {\r\n            if (true || this.state === params[\"state\"][0]) {\r\n                this.decodeIdToken(idToken);\r\n                this.loginCallback && this.loginCallback(null);\r\n            }\r\n            else {\r\n                var error = new Error();\r\n                error.statusText = \"Invalid state\";\r\n                this.loginCallback && this.loginCallback(error);\r\n            }\r\n            return true;\r\n        }\r\n        else if (accessToken) {\r\n            throw \"Should not get here.  This should be handled via the iframe approach.\";\r\n        }\r\n        return false;\r\n    };\r\n    Identity.prototype.decodeIdToken = function (idToken) {\r\n        var _this = this;\r\n        var decodedToken = this.base64Decode(idToken.substring(idToken.indexOf('.') + 1, idToken.lastIndexOf('.')));\r\n        var decodedTokenJSON = JSON.parse(decodedToken);\r\n        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\r\n        this.idToken = new IdToken();\r\n        this.idToken.FullToken = decodedTokenJSON;\r\n        this.idToken.Token = idToken;\r\n        this.idToken.Expiry = expiryDate;\r\n        this.idToken.UPN = decodedTokenJSON.upn;\r\n        this.idToken.TenantId = decodedTokenJSON.tid;\r\n        this.idToken.FamilyName = decodedTokenJSON.family_name;\r\n        this.idToken.GivenName = decodedTokenJSON.given_name;\r\n        this.idToken.Name = decodedTokenJSON.name;\r\n        this.idToken.PreferredUsername = decodedTokenJSON.preferred_username;\r\n        var expiration = expiryDate.getTime() - new Date().getTime() - 300000;\r\n        this.refreshTimer = setTimeout((function () {\r\n            _this.renewIdToken();\r\n        }), expiration);\r\n    };\r\n    Identity.prototype.decodeAccessToken = function (accessToken, resource, scopes) {\r\n        var decodedToken = this.base64Decode(accessToken.substring(accessToken.indexOf('.') + 1, accessToken.lastIndexOf('.')));\r\n        var decodedTokenJSON = JSON.parse(decodedToken);\r\n        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\r\n        var key = resource || scopes.join(\" \");\r\n        var token = new CachedToken(key, scopes, resource, accessToken, expiryDate);\r\n        this.tokenCache.add(token);\r\n    };\r\n    Identity.prototype.getIdToken = function () {\r\n        return this.idToken;\r\n    };\r\n    Identity.prototype.isLoggedIn = function () {\r\n        if (!this.idToken)\r\n            return false;\r\n        return (this.idToken.Expiry > new Date());\r\n    };\r\n    Identity.prototype.renewIdToken = function () {\r\n        clearTimeout(this.refreshTimer);\r\n        this.login(function () { });\r\n    };\r\n    Identity.prototype.getCurrentOauthVersion = function () {\r\n        return this.version;\r\n    };\r\n    Identity.prototype.getAccessTokenAsync = function (resource) {\r\n        var d = new promises_1.Deferred();\r\n        this.getAccessToken(resource, (function (error, token) {\r\n            if (error) {\r\n                d.reject(error);\r\n            }\r\n            else {\r\n                d.resolve(token);\r\n            }\r\n        }));\r\n        return d.promise;\r\n    };\r\n    Identity.prototype.getAccessToken = function (resource, callback) {\r\n        var _this = this;\r\n        if (this.version !== OAuthVersion.v1) {\r\n            var e = new Error();\r\n            e.statusText = \"Currently this identity class is using v2 OAuth mode. You need to use getAccessTokenForScopes() method\";\r\n            callback(e);\r\n            return;\r\n        }\r\n        var token = this.tokenCache.getForResource(resource);\r\n        if (token) {\r\n            return callback(null, token.token);\r\n        }\r\n        this.getTokenCallback = (function (token, error) {\r\n            if (error) {\r\n                callback(error);\r\n            }\r\n            else {\r\n                _this.decodeAccessToken(token, resource);\r\n                callback(null, token);\r\n            }\r\n        });\r\n        this.nonce = \"token\" + this.generateNonce();\r\n        this.state = \"token\" + this.generateNonce();\r\n        var iframe = document.createElement('iframe');\r\n        iframe.style.display = \"none\";\r\n        iframe.id = \"tokenIFrame\";\r\n        iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n            \"&resource=\" + encodeURIComponent(resource) +\r\n            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n            \"&state=\" + encodeURIComponent(this.state) +\r\n            \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n            \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n            \"&op=token\";\r\n        document.body.appendChild(iframe);\r\n    };\r\n    Identity.prototype.getAccessTokenForScopesAsync = function (scopes, promptForConsent) {\r\n        if (promptForConsent === void 0) { promptForConsent = false; }\r\n        var d = new promises_1.Deferred();\r\n        this.getAccessTokenForScopes(scopes, promptForConsent, function (token, error) {\r\n            if (error) {\r\n                d.reject(error);\r\n            }\r\n            else {\r\n                d.resolve(token);\r\n            }\r\n        });\r\n        return d.promise;\r\n    };\r\n    Identity.prototype.getAccessTokenForScopes = function (scopes, promptForConsent, callback) {\r\n        var _this = this;\r\n        if (promptForConsent === void 0) { promptForConsent = false; }\r\n        if (this.version !== OAuthVersion.v2) {\r\n            var e = new Error();\r\n            e.statusText = \"Dynamic scopes require v2 mode. Currently this identity class is using v1\";\r\n            callback(null, e);\r\n            return;\r\n        }\r\n        var token = this.tokenCache.getForScopes(scopes);\r\n        if (token) {\r\n            return callback(token.token, null);\r\n        }\r\n        this.getTokenCallback = (function (token, error) {\r\n            if (error) {\r\n                if (promptForConsent || !error.text) {\r\n                    callback(null, error);\r\n                }\r\n                else if (error.text.indexOf(\"AADSTS65001\") >= 0) {\r\n                    _this.getAccessTokenForScopes(scopes, true, _this.getTokenCallback);\r\n                }\r\n                else {\r\n                    callback(null, error);\r\n                }\r\n            }\r\n            else {\r\n                _this.decodeAccessToken(token, null, scopes);\r\n                callback(token, null);\r\n            }\r\n        });\r\n        this.nonce = \"token\" + this.generateNonce();\r\n        this.state = \"token\" + this.generateNonce();\r\n        if (!promptForConsent) {\r\n            var iframe = document.createElement('iframe');\r\n            iframe.style.display = \"none\";\r\n            iframe.id = \"tokenIFrame\";\r\n            iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\r\n                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n                \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n                \"&state=\" + encodeURIComponent(this.state) +\r\n                \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n                \"&login_hint=\" + encodeURIComponent(this.idToken.PreferredUsername) +\r\n                \"&domain_hint=\" + encodeURIComponent(this.idToken.TenantId === \"9188040d-6c67-4c5b-b112-36a304b66dad\" ? \"consumers\" : \"organizations\") +\r\n                \"&op=token\";\r\n            document.body.appendChild(iframe);\r\n        }\r\n        else {\r\n            window.open(this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\r\n                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n                \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n                \"&state=\" + encodeURIComponent(this.state) +\r\n                \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n                \"&op=token\", \"_blank\");\r\n        }\r\n    };\r\n    Identity.prototype.loginAsync = function (loginSettings) {\r\n        var d = new promises_1.Deferred();\r\n        this.login(function (error) {\r\n            if (error) {\r\n                d.reject(error);\r\n            }\r\n            else {\r\n                d.resolve(null);\r\n            }\r\n        }, loginSettings);\r\n        return d.promise;\r\n    };\r\n    Identity.prototype.login = function (callback, loginSettings) {\r\n        this.loginCallback = callback;\r\n        if (!loginSettings)\r\n            loginSettings = {};\r\n        if (loginSettings.policy)\r\n            this.policy = loginSettings.policy;\r\n        if (loginSettings.scopes && this.version === OAuthVersion.v1) {\r\n            var e = new Error();\r\n            e.text = \"Scopes can only be used with OAuth v2.\";\r\n            callback(e);\r\n            return;\r\n        }\r\n        if (loginSettings.policy && !loginSettings.tenant) {\r\n            var e = new Error();\r\n            e.text = \"In order to use policy (AAD B2C) a tenant must be specified as well.\";\r\n            callback(e);\r\n            return;\r\n        }\r\n        this.state = \"login\" + this.generateNonce();\r\n        this.nonce = \"login\" + this.generateNonce();\r\n        var loginURL = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n            \"&state=\" + encodeURIComponent(this.state) +\r\n            \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n            \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n            \"&op=login\" +\r\n            \"&p=\" + encodeURIComponent(this.policy);\r\n        if (loginSettings.tenant) {\r\n            loginURL += \"&tenant=\" + encodeURIComponent(loginSettings.tenant);\r\n        }\r\n        if (this.version === OAuthVersion.v2) {\r\n            if (!loginSettings.scopes)\r\n                loginSettings.scopes = [];\r\n            if (loginSettings.scopes.indexOf(\"profile\") < 0)\r\n                loginSettings.scopes.push(\"profile\");\r\n            if (loginSettings.scopes.indexOf(\"openid\") < 0)\r\n                loginSettings.scopes.push(\"openid\");\r\n            loginURL += \"&scopes=\" + encodeURIComponent(loginSettings.scopes.join(\" \"));\r\n        }\r\n        window.open(loginURL, \"_blank\");\r\n    };\r\n    Identity.prototype.loginNoWindowAsync = function (toUrl) {\r\n        var d = new promises_1.Deferred();\r\n        this.loginNoWindow(function (error) {\r\n            if (error) {\r\n                d.reject(error);\r\n            }\r\n            else {\r\n                d.resolve(null);\r\n            }\r\n        }, toUrl);\r\n        return d.promise;\r\n    };\r\n    Identity.prototype.loginNoWindow = function (callback, toUrl) {\r\n        this.loginCallback = callback;\r\n        this.state = \"clientId=\" + this.clientId + \"&\" + \"tokenProcessorUrl=\" + this.tokenProcessorUrl;\r\n        this.nonce = this.generateNonce();\r\n        var redirected = this.checkForIdentityRedirect();\r\n        if (!redirected) {\r\n            var redirectUri = (toUrl) ? toUrl : window.location.href.split(\"#\")[0];\r\n            var url = \"https://login.microsoftonline.com/common/oauth2/authorize?response_type=id_token\" +\r\n                \"&client_id=\" + encodeURIComponent(this.clientId) +\r\n                \"&redirect_uri=\" + encodeURIComponent(redirectUri) +\r\n                \"&state=\" + encodeURIComponent(this.state) +\r\n                \"&nonce=\" + encodeURIComponent(this.nonce);\r\n            window.location.href = url;\r\n        }\r\n    };\r\n    Identity.prototype.logOut = function () {\r\n        this.tokenCache.clear();\r\n        var url = \"https://login.microsoftonline.com/common/oauth2/logout?post_logout_redirect_uri=\" + encodeURI(window.location.href);\r\n        window.location.href = url;\r\n    };\r\n    Identity.prototype.base64Decode = function (encodedString) {\r\n        var e = {}, i, b = 0, c, x, l = 0, a, r = '', w = String.fromCharCode, L = encodedString.length;\r\n        var A = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\r\n        for (i = 0; i < 64; i++) {\r\n            e[A.charAt(i)] = i;\r\n        }\r\n        for (x = 0; x < L; x++) {\r\n            c = e[encodedString.charAt(x)];\r\n            b = (b << 6) + c;\r\n            l += 6;\r\n            while (l >= 8) {\r\n                ((a = (b >>> (l -= 8)) & 0xff) || (x < (L - 2))) && (r += w(a));\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n    Identity.prototype.generateNonce = function () {\r\n        var text = \"\";\r\n        var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n        for (var i = 0; i < 32; i++) {\r\n            text += chars.charAt(Math.floor(Math.random() * chars.length));\r\n        }\r\n        return text;\r\n    };\r\n    return Identity;\r\n}());\r\nexports.Identity = Identity;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/identity.ts\n ** module id = 3\n ** module chunks = 0\n **/","\"use strict\";\r\nvar __extends = (this && this.__extends) || function (d, b) {\r\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n};\r\nvar Action = (function () {\r\n    function Action(pathWithQuery, scopes) {\r\n        this.pathWithQuery = pathWithQuery;\r\n        this.scopes = scopes;\r\n    }\r\n    return Action;\r\n}());\r\nexports.Action = Action;\r\nfunction queryUnion(query1, query2) {\r\n    if (query1)\r\n        return query1 + (query2 ? \"&\" + query2 : \"\");\r\n    else\r\n        return query2;\r\n}\r\nvar pathWithQuery = function (path, query) { return path + (query ? \"?\" + query : \"\"); };\r\nvar Endpoint = (function () {\r\n    function Endpoint(path, query) {\r\n        var _this = this;\r\n        this.path = path;\r\n        this.query = query;\r\n        this.addQuery = function (query) { return new AddQuery(_this.path, queryUnion(_this.query, query), _this.actions); };\r\n        this.pathWithQuery = pathWithQuery(this.path, this.query);\r\n        this.path = path;\r\n        this.query = query;\r\n    }\r\n    return Endpoint;\r\n}());\r\nexports.Endpoint = Endpoint;\r\nvar AddQuery = (function (_super) {\r\n    __extends(AddQuery, _super);\r\n    function AddQuery(path, query, actions) {\r\n        _super.call(this, path, query);\r\n        if (actions) {\r\n            for (var verb in actions)\r\n                actions[verb].pathWithQuery = pathWithQuery(path, query);\r\n            this.actions = actions;\r\n        }\r\n    }\r\n    return AddQuery;\r\n}(Endpoint));\r\nexports.AddQuery = AddQuery;\r\nvar Attachment = (function (_super) {\r\n    __extends(Attachment, _super);\r\n    function Attachment(path, attachmentId) {\r\n        _super.call(this, path + \"/attachments/\" + attachmentId);\r\n        this.actions = {\r\n            GET: new Action(this.path)\r\n        };\r\n    }\r\n    return Attachment;\r\n}(Endpoint));\r\nexports.Attachment = Attachment;\r\nvar attachment = function (path) { return function (attachmentId) { return new Attachment(path, attachmentId); }; };\r\nvar Attachments = (function (_super) {\r\n    __extends(Attachments, _super);\r\n    function Attachments(path) {\r\n        _super.call(this, path + \"/attachments\");\r\n        this.actions = {\r\n            GETCOLLECTION: new Action(this.path),\r\n        };\r\n    }\r\n    return Attachments;\r\n}(Endpoint));\r\nexports.Attachments = Attachments;\r\nvar attachments = function (path) { return new Attachments(path); };\r\nvar Message = (function (_super) {\r\n    __extends(Message, _super);\r\n    function Message(path, messageId) {\r\n        _super.call(this, path + \"/messages/\" + messageId);\r\n        this.actions = {\r\n            GET: new Action(this.path),\r\n            POST: new Action(this.path)\r\n        };\r\n        this.attachment = attachment(this.path);\r\n        this.attachments = attachments(this.path);\r\n    }\r\n    return Message;\r\n}(Endpoint));\r\nexports.Message = Message;\r\nvar message = function (path) { return function (messageId) { return new Message(path, messageId); }; };\r\nvar Messages = (function (_super) {\r\n    __extends(Messages, _super);\r\n    function Messages(path) {\r\n        _super.call(this, path + \"/messages/\");\r\n        this.actions = {\r\n            GETCOLLECTION: new Action(this.path),\r\n        };\r\n    }\r\n    return Messages;\r\n}(Endpoint));\r\nexports.Messages = Messages;\r\nvar messages = function (path) { return new Messages(path); };\r\nvar Event = (function (_super) {\r\n    __extends(Event, _super);\r\n    function Event(path, eventId) {\r\n        _super.call(this, path + \"/events/\");\r\n        this.actions = {\r\n            GET: new Action(this.path),\r\n        };\r\n        this.attachment = attachment(this.path);\r\n        this.attachments = attachments(this.path);\r\n    }\r\n    return Event;\r\n}(Endpoint));\r\nexports.Event = Event;\r\nvar event = function (path) { return function (eventId) { return new Event(path, eventId); }; };\r\nvar Events = (function (_super) {\r\n    __extends(Events, _super);\r\n    function Events(path) {\r\n        _super.call(this, path + \"/events/\");\r\n        this.actions = {\r\n            GETCOLLECTION: new Action(this.path),\r\n        };\r\n    }\r\n    return Events;\r\n}(Endpoint));\r\nexports.Events = Events;\r\nvar events = function (path) { return new Events(path); };\r\nvar CalendarView = (function (_super) {\r\n    __extends(CalendarView, _super);\r\n    function CalendarView(path, startDate, endDate) {\r\n        _super.call(this, path + \"/calendarView\", \"startDateTime=\" + startDate.toString() + \"&endDateTime=\" + endDate.toString());\r\n        this.actions = {\r\n            GETCOLLECTION: new Action(pathWithQuery(this.path, this.query))\r\n        };\r\n    }\r\n    return CalendarView;\r\n}(Endpoint));\r\nexports.CalendarView = CalendarView;\r\nvar calendarView = function (path) { return function (startDate, endDate) { return new CalendarView(path, startDate, endDate); }; };\r\nvar User = (function (_super) {\r\n    __extends(User, _super);\r\n    function User(path, userId) {\r\n        if (path === void 0) { path = \"\"; }\r\n        _super.call(this, userId ? path + \"/users/\" + userId : path + \"/me\");\r\n        this.actions = {\r\n            GET: new Action(this.path),\r\n        };\r\n        this.message = message(this.path);\r\n        this.messages = messages(this.path);\r\n        this.event = event(this.path);\r\n        this.events = events(this.path);\r\n        this.calendarView = calendarView(this.path);\r\n    }\r\n    return User;\r\n}(Endpoint));\r\nexports.User = User;\r\nvar me = new User(\"https://graph.microsoft.com/v1.0\");\r\nvar user = function (userId) { return new User(\"\", userId); };\r\nvar Users = (function (_super) {\r\n    __extends(Users, _super);\r\n    function Users(path) {\r\n        if (path === void 0) { path = \"\"; }\r\n        _super.call(this, path + \"/users\");\r\n        this.actions = {\r\n            GETCOLLECTION: new Action(this.path),\r\n        };\r\n    }\r\n    return Users;\r\n}(Endpoint));\r\nexports.Users = Users;\r\nvar users = new Users();\r\nvar Root = (function () {\r\n    function Root() {\r\n        this.me = me;\r\n        this.user = user;\r\n        this.users = users;\r\n    }\r\n    return Root;\r\n}());\r\nexports.Root = Root;\r\nvar MockGraph = (function () {\r\n    function MockGraph() {\r\n    }\r\n    MockGraph.prototype.getUntypedCollection = function (path, scopes) {\r\n        return {};\r\n    };\r\n    MockGraph.prototype.getTypedCollection = function (path, scopes) {\r\n        return this.getUntyped(path, scopes);\r\n    };\r\n    MockGraph.prototype.getCollection = function (endpoint) {\r\n        var action = endpoint.actions && endpoint.actions.GETCOLLECTION;\r\n        if (!action) {\r\n            console.log(\"no GETCOLLECTION endpoint, sorry!\");\r\n        }\r\n        else {\r\n            console.log(\"GETCOLLECTION path\", action.pathWithQuery);\r\n            return this.getTypedCollection(action.pathWithQuery, action.scopes);\r\n        }\r\n    };\r\n    MockGraph.prototype.getUntyped = function (path, scopes) {\r\n        return {};\r\n    };\r\n    MockGraph.prototype.getTyped = function (path, scopes) {\r\n        return;\r\n    };\r\n    MockGraph.prototype.get = function (endpoint) {\r\n        var action = endpoint.actions && endpoint.actions.GET;\r\n        if (!action) {\r\n            console.log(\"no GET endpoint, sorry!\");\r\n        }\r\n        else {\r\n            console.log(\"GET path\", action.pathWithQuery);\r\n            return this.getTyped(action.pathWithQuery, action.scopes);\r\n        }\r\n    };\r\n    MockGraph.prototype.postUntyped = function (path, scopes, request) {\r\n        return {};\r\n    };\r\n    MockGraph.prototype.postTyped = function (path, scopes, request) {\r\n        return this.postUntyped(path, scopes, request);\r\n    };\r\n    MockGraph.prototype.post = function (endpoint, request) {\r\n        var action = endpoint.actions && endpoint.actions.POST;\r\n        if (!action) {\r\n            console.log(\"no POST endpoint, sorry!\");\r\n        }\r\n        else {\r\n            console.log(\"POST path\", action.pathWithQuery);\r\n            return this.postTyped(action.pathWithQuery, action.scopes, request);\r\n        }\r\n    };\r\n    MockGraph.prototype.patchUntyped = function (path, scopes, request) {\r\n        return {};\r\n    };\r\n    MockGraph.prototype.patchTyped = function (path, scopes, request) {\r\n        return this.patchUntyped(path, scopes, request);\r\n    };\r\n    MockGraph.prototype.patch = function (endpoint, request) {\r\n        var action = endpoint.actions && endpoint.actions.PATCH;\r\n        if (!action) {\r\n            console.log(\"no PATCH endpoint, sorry!\");\r\n        }\r\n        else {\r\n            console.log(\"PATCH path\", action.pathWithQuery);\r\n            return this.patchTyped(action.pathWithQuery, action.scopes, request);\r\n        }\r\n    };\r\n    MockGraph.prototype.deleteUntyped = function (path, scopes) {\r\n    };\r\n    MockGraph.prototype.deleteTyped = function (path, scopes) {\r\n    };\r\n    MockGraph.prototype.delete = function (endpoint) {\r\n        var action = endpoint.actions.DELETE;\r\n        if (!action) {\r\n            console.log(\"no DELETE endpoint, sorry!\");\r\n        }\r\n        else {\r\n            console.log(\"DELETE path\", action.pathWithQuery);\r\n            this.getTyped(action.pathWithQuery, action.scopes);\r\n        }\r\n    };\r\n    return MockGraph;\r\n}());\r\nvar rb = new Root();\r\nvar graph = new MockGraph();\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/requestbuilder.ts\n ** module id = 4\n ** module chunks = 0\n **/"],"sourceRoot":""}