{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///dist/kurve.min.js","webpack:///webpack/bootstrap 4eeb93de5dd2baf0eb75","webpack:///./src/kurve.ts","webpack:///./src/graph.ts","webpack:///./src/promises.ts","webpack:///./src/identity.ts","webpack:///./src/requestbuilder.ts"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","__export","hasOwnProperty","promises_1","identity_1","requestbuilder_1","Graph","identityInfo","_this","req","accessToken","KurveIdentity","defaultResourceID","baseUrl","GET","path","scopes","Get","GETCOLLECTION","GetCollection","me","UserNode","user","userId","users","UsersNode","defaultAccessToken","identity","prototype","console","log","d","Deferred","get","error","result","jsonResult","JSON","parse","errorODATA","Error","other","reject","resolve","promise","resultsArray","value","objects","scopesForV2","getCurrentOauthVersion","OAuthVersion","v1","getAsync","url","response","callback","responseType","xhr","XMLHttpRequest","onreadystatechange","readyState","status","responseText","generateError","open","addAccessTokenAndSend","addTokenError","statusText","text","setRequestHeader","send","getAccessTokenForScopes","token","getAccessToken","DispatchDeferred","closure","setTimeout","PromiseState","Client","_dispatcher","_successCB","_errorCB","defer","_dispatchCallback","arg","err","dispatcher","_stack","_state","Pending","Promise","then","successCB","errorCB","client","ResolutionInProgress","push","Resolved","_value","Rejected","_error","_resolve","type","pending","i","stackSize","length","splice","TypeError","_reject","_deferred","successCallback","errorCallback","fail","undefined","CachedToken","resource","expiry","Object","defineProperty","Date","getTime","enumerable","configurable","hasScopes","requiredScopes","every","requiredScope","some","actualScope","TokenCache","tokenStorage","cachedTokens","getAll","forEach","_a","cachedToken","isExpired","remove","add","getForResource","getForScopes","key","clear","IdToken","Identity","identitySettings","policy","clientId","tokenProcessorUrl","tokenProcessingUri","version","tokenCache","window","addEventListener","event","data","e","loginCallback","state","decodeIdToken","getTokenCallback","iframe","document","getElementById","parentNode","removeChild","checkForIdentityRedirect","s","start","location","href","indexOf","end","substring","parseQueryString","str","queryString","search","keyValPairs","params","replace","split","pairNum","idToken","decodedToken","base64Decode","lastIndexOf","decodedTokenJSON","expiryDate","parseInt","exp","FullToken","Token","Expiry","UPN","upn","TenantId","tid","FamilyName","family_name","GivenName","given_name","Name","name","PreferredUsername","preferred_username","expiration","refreshTimer","renewIdToken","decodeAccessToken","join","getIdToken","isLoggedIn","clearTimeout","login","getAccessTokenAsync","nonce","generateNonce","createElement","style","display","src","encodeURIComponent","toString","body","appendChild","getAccessTokenForScopesAsync","promptForConsent","v2","loginAsync","loginSettings","tenant","loginURL","loginNoWindowAsync","toUrl","loginNoWindow","redirected","redirectUri","logOut","encodeURI","encodedString","x","a","b","l","r","w","String","fromCharCode","L","A","charAt","chars","Math","floor","random","__extends","__","constructor","create","queryUnion","query1","query2","pathWithQuery","query","selectQuery","fields","orderByQuery","Node","graph","AttachmentEndpoint","_super","apply","arguments","GetAttachment","addQuery","AttachmentsEndpoint","select","_i","orderby","AttachmentNode","attachmentId","attachment","GetAttachments","AttachmentsNode","attachments","MessageEndpoint","GetMessage","MessageNode","messageId","message","MessagesEndpoint","GetMessages","MessagesNode","messages","EventEndpoint","GetEvent","EventNode","eventId","EventsEndpoint","GetEvents","EventsNode","events","CalendarViewEndpoint","GetCalendarView","CalendarViewNode","startDate","endDate","toISOString","calendarView","MailFoldersEndpoint","GetMailFolders","MailFoldersNode","UserEndpoint","GetUser","mailFolders","UsersEndpoint","GetUsers"],"mappings":"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","file":"dist/kurve.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Kurve\"] = factory();\n\telse\n\t\troot[\"Kurve\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Kurve\"] = factory();\n\telse\n\t\troot[\"Kurve\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tfunction __export(m) {\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t}\n\t__export(__webpack_require__(1));\n\t__export(__webpack_require__(3));\n\t__export(__webpack_require__(4));\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar promises_1 = __webpack_require__(2);\n\tvar identity_1 = __webpack_require__(3);\n\tvar requestbuilder_1 = __webpack_require__(4);\n\tvar Graph = (function () {\n\t    function Graph(identityInfo) {\n\t        var _this = this;\n\t        this.req = null;\n\t        this.accessToken = null;\n\t        this.KurveIdentity = null;\n\t        this.defaultResourceID = \"https://graph.microsoft.com\";\n\t        this.baseUrl = \"https://graph.microsoft.com/v1.0\";\n\t        this.GET = function (path, scopes) { return function () { return _this.Get(path, scopes); }; };\n\t        this.GETCOLLECTION = function (path, scopes) { return function () { return _this.GetCollection(path, scopes); }; };\n\t        this.me = new requestbuilder_1.UserNode(this, this.baseUrl);\n\t        this.user = function (userId) { return new requestbuilder_1.UserNode(_this, _this.baseUrl, userId); };\n\t        this.users = new requestbuilder_1.UsersNode(this, this.baseUrl);\n\t        if (identityInfo.defaultAccessToken) {\n\t            this.accessToken = identityInfo.defaultAccessToken;\n\t        }\n\t        else {\n\t            this.KurveIdentity = identityInfo.identity;\n\t        }\n\t    }\n\t    Graph.prototype.Get = function (path, scopes) {\n\t        console.log(\"GET\", path);\n\t        var d = new promises_1.Deferred();\n\t        this.get(path, function (error, result) {\n\t            var jsonResult = JSON.parse(result);\n\t            if (jsonResult.error) {\n\t                var errorODATA = new identity_1.Error();\n\t                errorODATA.other = jsonResult.error;\n\t                d.reject(errorODATA);\n\t                return;\n\t            }\n\t            d.resolve(jsonResult);\n\t        });\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.GetCollection = function (path, scopes) {\n\t        console.log(\"GETCOLLECTION\", path);\n\t        var d = new promises_1.Deferred();\n\t        this.get(path, function (error, result) {\n\t            var jsonResult = JSON.parse(result);\n\t            if (jsonResult.error) {\n\t                var errorODATA = new identity_1.Error();\n\t                errorODATA.other = jsonResult.error;\n\t                d.reject(errorODATA);\n\t                return;\n\t            }\n\t            var resultsArray = (jsonResult.value ? jsonResult.value : [jsonResult]);\n\t            d.resolve({ objects: resultsArray });\n\t        });\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.scopesForV2 = function (scopes) {\n\t        if (!this.KurveIdentity)\n\t            return null;\n\t        if (this.KurveIdentity.getCurrentOauthVersion() === identity_1.OAuthVersion.v1)\n\t            return null;\n\t        else\n\t            return scopes;\n\t    };\n\t    Graph.prototype.getAsync = function (url) {\n\t        var d = new promises_1.Deferred();\n\t        this.get(url, function (error, response) { return error ? d.reject(error) : d.resolve(response); });\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.get = function (url, callback, responseType, scopes) {\n\t        var _this = this;\n\t        var xhr = new XMLHttpRequest();\n\t        if (responseType)\n\t            xhr.responseType = responseType;\n\t        xhr.onreadystatechange = function () {\n\t            if (xhr.readyState === 4)\n\t                if (xhr.status === 200)\n\t                    callback(null, responseType ? xhr.response : xhr.responseText);\n\t                else\n\t                    callback(_this.generateError(xhr));\n\t        };\n\t        xhr.open(\"GET\", url);\n\t        this.addAccessTokenAndSend(xhr, function (addTokenError) {\n\t            if (addTokenError) {\n\t                callback(addTokenError);\n\t            }\n\t        }, scopes);\n\t    };\n\t    Graph.prototype.generateError = function (xhr) {\n\t        var response = new identity_1.Error();\n\t        response.status = xhr.status;\n\t        response.statusText = xhr.statusText;\n\t        if (xhr.responseType === '' || xhr.responseType === 'text')\n\t            response.text = xhr.responseText;\n\t        else\n\t            response.other = xhr.response;\n\t        return response;\n\t    };\n\t    Graph.prototype.addAccessTokenAndSend = function (xhr, callback, scopes) {\n\t        if (this.accessToken) {\n\t            xhr.setRequestHeader('Authorization', 'Bearer ' + this.accessToken);\n\t            xhr.send();\n\t        }\n\t        else {\n\t            if (scopes) {\n\t                this.KurveIdentity.getAccessTokenForScopes(scopes, false, (function (token, error) {\n\t                    if (error)\n\t                        callback(error);\n\t                    else {\n\t                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\n\t                        xhr.send();\n\t                        callback(null);\n\t                    }\n\t                }));\n\t            }\n\t            else {\n\t                this.KurveIdentity.getAccessToken(this.defaultResourceID, (function (error, token) {\n\t                    if (error)\n\t                        callback(error);\n\t                    else {\n\t                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\n\t                        xhr.send();\n\t                        callback(null);\n\t                    }\n\t                }));\n\t            }\n\t        }\n\t    };\n\t    return Graph;\n\t}());\n\texports.Graph = Graph;\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\tfunction DispatchDeferred(closure) {\n\t    setTimeout(closure, 0);\n\t}\n\tvar PromiseState;\n\t(function (PromiseState) {\n\t    PromiseState[PromiseState[\"Pending\"] = 0] = \"Pending\";\n\t    PromiseState[PromiseState[\"ResolutionInProgress\"] = 1] = \"ResolutionInProgress\";\n\t    PromiseState[PromiseState[\"Resolved\"] = 2] = \"Resolved\";\n\t    PromiseState[PromiseState[\"Rejected\"] = 3] = \"Rejected\";\n\t})(PromiseState || (PromiseState = {}));\n\tvar Client = (function () {\n\t    function Client(_dispatcher, _successCB, _errorCB) {\n\t        this._dispatcher = _dispatcher;\n\t        this._successCB = _successCB;\n\t        this._errorCB = _errorCB;\n\t        this.result = new Deferred(_dispatcher);\n\t    }\n\t    Client.prototype.resolve = function (value, defer) {\n\t        var _this = this;\n\t        if (typeof (this._successCB) !== 'function') {\n\t            this.result.resolve(value);\n\t            return;\n\t        }\n\t        if (defer) {\n\t            this._dispatcher(function () { return _this._dispatchCallback(_this._successCB, value); });\n\t        }\n\t        else {\n\t            this._dispatchCallback(this._successCB, value);\n\t        }\n\t    };\n\t    Client.prototype.reject = function (error, defer) {\n\t        var _this = this;\n\t        if (typeof (this._errorCB) !== 'function') {\n\t            this.result.reject(error);\n\t            return;\n\t        }\n\t        if (defer) {\n\t            this._dispatcher(function () { return _this._dispatchCallback(_this._errorCB, error); });\n\t        }\n\t        else {\n\t            this._dispatchCallback(this._errorCB, error);\n\t        }\n\t    };\n\t    Client.prototype._dispatchCallback = function (callback, arg) {\n\t        var result, then, type;\n\t        try {\n\t            result = callback(arg);\n\t            this.result.resolve(result);\n\t        }\n\t        catch (err) {\n\t            this.result.reject(err);\n\t            return;\n\t        }\n\t    };\n\t    return Client;\n\t}());\n\tvar Deferred = (function () {\n\t    function Deferred(dispatcher) {\n\t        this._stack = [];\n\t        this._state = PromiseState.Pending;\n\t        if (dispatcher)\n\t            this._dispatcher = dispatcher;\n\t        else\n\t            this._dispatcher = DispatchDeferred;\n\t        this.promise = new Promise(this);\n\t    }\n\t    Deferred.prototype.DispatchDeferred = function (closure) {\n\t        setTimeout(closure, 0);\n\t    };\n\t    Deferred.prototype.then = function (successCB, errorCB) {\n\t        if (typeof (successCB) !== 'function' && typeof (errorCB) !== 'function') {\n\t            return this.promise;\n\t        }\n\t        var client = new Client(this._dispatcher, successCB, errorCB);\n\t        switch (this._state) {\n\t            case PromiseState.Pending:\n\t            case PromiseState.ResolutionInProgress:\n\t                this._stack.push(client);\n\t                break;\n\t            case PromiseState.Resolved:\n\t                client.resolve(this._value, true);\n\t                break;\n\t            case PromiseState.Rejected:\n\t                client.reject(this._error, true);\n\t                break;\n\t        }\n\t        return client.result.promise;\n\t    };\n\t    Deferred.prototype.resolve = function (value) {\n\t        if (this._state !== PromiseState.Pending) {\n\t            return this;\n\t        }\n\t        return this._resolve(value);\n\t    };\n\t    Deferred.prototype._resolve = function (value) {\n\t        var _this = this;\n\t        var type = typeof (value), then, pending = true;\n\t        try {\n\t            if (value !== null &&\n\t                (type === 'object' || type === 'function') &&\n\t                typeof (then = value.then) === 'function') {\n\t                if (value === this.promise) {\n\t                    throw new TypeError('recursive resolution');\n\t                }\n\t                this._state = PromiseState.ResolutionInProgress;\n\t                then.call(value, function (result) {\n\t                    if (pending) {\n\t                        pending = false;\n\t                        _this._resolve(result);\n\t                    }\n\t                }, function (error) {\n\t                    if (pending) {\n\t                        pending = false;\n\t                        _this._reject(error);\n\t                    }\n\t                });\n\t            }\n\t            else {\n\t                this._state = PromiseState.ResolutionInProgress;\n\t                this._dispatcher(function () {\n\t                    _this._state = PromiseState.Resolved;\n\t                    _this._value = value;\n\t                    var i, stackSize = _this._stack.length;\n\t                    for (i = 0; i < stackSize; i++) {\n\t                        _this._stack[i].resolve(value, false);\n\t                    }\n\t                    _this._stack.splice(0, stackSize);\n\t                });\n\t            }\n\t        }\n\t        catch (err) {\n\t            if (pending) {\n\t                this._reject(err);\n\t            }\n\t        }\n\t        return this;\n\t    };\n\t    Deferred.prototype.reject = function (error) {\n\t        if (this._state !== PromiseState.Pending) {\n\t            return this;\n\t        }\n\t        return this._reject(error);\n\t    };\n\t    Deferred.prototype._reject = function (error) {\n\t        var _this = this;\n\t        this._state = PromiseState.ResolutionInProgress;\n\t        this._dispatcher(function () {\n\t            _this._state = PromiseState.Rejected;\n\t            _this._error = error;\n\t            var stackSize = _this._stack.length, i = 0;\n\t            for (i = 0; i < stackSize; i++) {\n\t                _this._stack[i].reject(error, false);\n\t            }\n\t            _this._stack.splice(0, stackSize);\n\t        });\n\t        return this;\n\t    };\n\t    return Deferred;\n\t}());\n\texports.Deferred = Deferred;\n\tvar Promise = (function () {\n\t    function Promise(_deferred) {\n\t        this._deferred = _deferred;\n\t    }\n\t    Promise.prototype.then = function (successCallback, errorCallback) {\n\t        return this._deferred.then(successCallback, errorCallback);\n\t    };\n\t    Promise.prototype.fail = function (errorCallback) {\n\t        return this._deferred.then(undefined, errorCallback);\n\t    };\n\t    return Promise;\n\t}());\n\texports.Promise = Promise;\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar promises_1 = __webpack_require__(2);\n\t(function (OAuthVersion) {\n\t    OAuthVersion[OAuthVersion[\"v1\"] = 1] = \"v1\";\n\t    OAuthVersion[OAuthVersion[\"v2\"] = 2] = \"v2\";\n\t})(exports.OAuthVersion || (exports.OAuthVersion = {}));\n\tvar OAuthVersion = exports.OAuthVersion;\n\tvar Error = (function () {\n\t    function Error() {\n\t    }\n\t    return Error;\n\t}());\n\texports.Error = Error;\n\tvar CachedToken = (function () {\n\t    function CachedToken(id, scopes, resource, token, expiry) {\n\t        this.id = id;\n\t        this.scopes = scopes;\n\t        this.resource = resource;\n\t        this.token = token;\n\t        this.expiry = expiry;\n\t    }\n\t    ;\n\t    Object.defineProperty(CachedToken.prototype, \"isExpired\", {\n\t        get: function () {\n\t            return this.expiry <= new Date(new Date().getTime() + 60000);\n\t        },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    CachedToken.prototype.hasScopes = function (requiredScopes) {\n\t        var _this = this;\n\t        if (!this.scopes) {\n\t            return false;\n\t        }\n\t        return requiredScopes.every(function (requiredScope) {\n\t            return _this.scopes.some(function (actualScope) { return requiredScope === actualScope; });\n\t        });\n\t    };\n\t    return CachedToken;\n\t}());\n\tvar TokenCache = (function () {\n\t    function TokenCache(tokenStorage) {\n\t        var _this = this;\n\t        this.tokenStorage = tokenStorage;\n\t        this.cachedTokens = {};\n\t        if (tokenStorage) {\n\t            tokenStorage.getAll().forEach(function (_a) {\n\t                var id = _a.id, scopes = _a.scopes, resource = _a.resource, token = _a.token, expiry = _a.expiry;\n\t                var cachedToken = new CachedToken(id, scopes, resource, token, new Date(expiry));\n\t                if (cachedToken.isExpired) {\n\t                    _this.tokenStorage.remove(cachedToken.id);\n\t                }\n\t                else {\n\t                    _this.cachedTokens[cachedToken.id] = cachedToken;\n\t                }\n\t            });\n\t        }\n\t    }\n\t    TokenCache.prototype.add = function (token) {\n\t        this.cachedTokens[token.id] = token;\n\t        this.tokenStorage && this.tokenStorage.add(token.id, token);\n\t    };\n\t    TokenCache.prototype.getForResource = function (resource) {\n\t        var cachedToken = this.cachedTokens[resource];\n\t        if (cachedToken && cachedToken.isExpired) {\n\t            this.remove(resource);\n\t            return null;\n\t        }\n\t        return cachedToken;\n\t    };\n\t    TokenCache.prototype.getForScopes = function (scopes) {\n\t        for (var key in this.cachedTokens) {\n\t            var cachedToken = this.cachedTokens[key];\n\t            if (cachedToken.hasScopes(scopes)) {\n\t                if (cachedToken.isExpired) {\n\t                    this.remove(key);\n\t                }\n\t                else {\n\t                    return cachedToken;\n\t                }\n\t            }\n\t        }\n\t        return null;\n\t    };\n\t    TokenCache.prototype.clear = function () {\n\t        this.cachedTokens = {};\n\t        this.tokenStorage && this.tokenStorage.clear();\n\t    };\n\t    TokenCache.prototype.remove = function (key) {\n\t        this.tokenStorage && this.tokenStorage.remove(key);\n\t        delete this.cachedTokens[key];\n\t    };\n\t    return TokenCache;\n\t}());\n\tvar IdToken = (function () {\n\t    function IdToken() {\n\t    }\n\t    return IdToken;\n\t}());\n\texports.IdToken = IdToken;\n\tvar Identity = (function () {\n\t    function Identity(identitySettings) {\n\t        var _this = this;\n\t        this.policy = \"\";\n\t        this.clientId = identitySettings.clientId;\n\t        this.tokenProcessorUrl = identitySettings.tokenProcessingUri;\n\t        if (identitySettings.version)\n\t            this.version = identitySettings.version;\n\t        else\n\t            this.version = OAuthVersion.v1;\n\t        this.tokenCache = new TokenCache(identitySettings.tokenStorage);\n\t        window.addEventListener(\"message\", function (event) {\n\t            if (event.data.type === \"id_token\") {\n\t                if (event.data.error) {\n\t                    var e = new Error();\n\t                    e.text = event.data.error;\n\t                    _this.loginCallback(e);\n\t                }\n\t                else {\n\t                    if (_this.state !== event.data.state) {\n\t                        var error = new Error();\n\t                        error.statusText = \"Invalid state\";\n\t                        _this.loginCallback(error);\n\t                    }\n\t                    else {\n\t                        _this.decodeIdToken(event.data.token);\n\t                        _this.loginCallback(null);\n\t                    }\n\t                }\n\t            }\n\t            else if (event.data.type === \"access_token\") {\n\t                if (event.data.error) {\n\t                    var e = new Error();\n\t                    e.text = event.data.error;\n\t                    _this.getTokenCallback(null, e);\n\t                }\n\t                else {\n\t                    var token = event.data.token;\n\t                    var iframe = document.getElementById(\"tokenIFrame\");\n\t                    iframe.parentNode.removeChild(iframe);\n\t                    if (event.data.state !== _this.state) {\n\t                        var error = new Error();\n\t                        error.statusText = \"Invalid state\";\n\t                        _this.getTokenCallback(null, error);\n\t                    }\n\t                    else {\n\t                        _this.getTokenCallback(token, null);\n\t                    }\n\t                }\n\t            }\n\t        });\n\t    }\n\t    Identity.prototype.checkForIdentityRedirect = function () {\n\t        function token(s) {\n\t            var start = window.location.href.indexOf(s);\n\t            if (start < 0)\n\t                return null;\n\t            var end = window.location.href.indexOf(\"&\", start + s.length);\n\t            return window.location.href.substring(start, ((end > 0) ? end : window.location.href.length));\n\t        }\n\t        function parseQueryString(str) {\n\t            var queryString = str || window.location.search || '';\n\t            var keyValPairs = [];\n\t            var params = {};\n\t            queryString = queryString.replace(/.*?\\?/, \"\");\n\t            if (queryString.length) {\n\t                keyValPairs = queryString.split('&');\n\t                for (var pairNum in keyValPairs) {\n\t                    var key = keyValPairs[pairNum].split('=')[0];\n\t                    if (!key.length)\n\t                        continue;\n\t                    if (typeof params[key] === 'undefined')\n\t                        params[key] = [];\n\t                    params[key].push(keyValPairs[pairNum].split('=')[1]);\n\t                }\n\t            }\n\t            return params;\n\t        }\n\t        var params = parseQueryString(window.location.href);\n\t        var idToken = token(\"#id_token=\");\n\t        var accessToken = token(\"#access_token\");\n\t        if (idToken) {\n\t            if (true) {\n\t                this.decodeIdToken(idToken);\n\t                this.loginCallback && this.loginCallback(null);\n\t            }\n\t            else {\n\t                var error = new Error();\n\t                error.statusText = \"Invalid state\";\n\t                this.loginCallback && this.loginCallback(error);\n\t            }\n\t            return true;\n\t        }\n\t        else if (accessToken) {\n\t            throw \"Should not get here.  This should be handled via the iframe approach.\";\n\t        }\n\t        return false;\n\t    };\n\t    Identity.prototype.decodeIdToken = function (idToken) {\n\t        var _this = this;\n\t        var decodedToken = this.base64Decode(idToken.substring(idToken.indexOf('.') + 1, idToken.lastIndexOf('.')));\n\t        var decodedTokenJSON = JSON.parse(decodedToken);\n\t        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\n\t        this.idToken = new IdToken();\n\t        this.idToken.FullToken = decodedTokenJSON;\n\t        this.idToken.Token = idToken;\n\t        this.idToken.Expiry = expiryDate;\n\t        this.idToken.UPN = decodedTokenJSON.upn;\n\t        this.idToken.TenantId = decodedTokenJSON.tid;\n\t        this.idToken.FamilyName = decodedTokenJSON.family_name;\n\t        this.idToken.GivenName = decodedTokenJSON.given_name;\n\t        this.idToken.Name = decodedTokenJSON.name;\n\t        this.idToken.PreferredUsername = decodedTokenJSON.preferred_username;\n\t        var expiration = expiryDate.getTime() - new Date().getTime() - 300000;\n\t        this.refreshTimer = setTimeout((function () {\n\t            _this.renewIdToken();\n\t        }), expiration);\n\t    };\n\t    Identity.prototype.decodeAccessToken = function (accessToken, resource, scopes) {\n\t        var decodedToken = this.base64Decode(accessToken.substring(accessToken.indexOf('.') + 1, accessToken.lastIndexOf('.')));\n\t        var decodedTokenJSON = JSON.parse(decodedToken);\n\t        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\n\t        var key = resource || scopes.join(\" \");\n\t        var token = new CachedToken(key, scopes, resource, accessToken, expiryDate);\n\t        this.tokenCache.add(token);\n\t    };\n\t    Identity.prototype.getIdToken = function () {\n\t        return this.idToken;\n\t    };\n\t    Identity.prototype.isLoggedIn = function () {\n\t        if (!this.idToken)\n\t            return false;\n\t        return (this.idToken.Expiry > new Date());\n\t    };\n\t    Identity.prototype.renewIdToken = function () {\n\t        clearTimeout(this.refreshTimer);\n\t        this.login(function () { });\n\t    };\n\t    Identity.prototype.getCurrentOauthVersion = function () {\n\t        return this.version;\n\t    };\n\t    Identity.prototype.getAccessTokenAsync = function (resource) {\n\t        var d = new promises_1.Deferred();\n\t        this.getAccessToken(resource, (function (error, token) {\n\t            if (error) {\n\t                d.reject(error);\n\t            }\n\t            else {\n\t                d.resolve(token);\n\t            }\n\t        }));\n\t        return d.promise;\n\t    };\n\t    Identity.prototype.getAccessToken = function (resource, callback) {\n\t        var _this = this;\n\t        if (this.version !== OAuthVersion.v1) {\n\t            var e = new Error();\n\t            e.statusText = \"Currently this identity class is using v2 OAuth mode. You need to use getAccessTokenForScopes() method\";\n\t            callback(e);\n\t            return;\n\t        }\n\t        var token = this.tokenCache.getForResource(resource);\n\t        if (token) {\n\t            return callback(null, token.token);\n\t        }\n\t        this.getTokenCallback = (function (token, error) {\n\t            if (error) {\n\t                callback(error);\n\t            }\n\t            else {\n\t                _this.decodeAccessToken(token, resource);\n\t                callback(null, token);\n\t            }\n\t        });\n\t        this.nonce = \"token\" + this.generateNonce();\n\t        this.state = \"token\" + this.generateNonce();\n\t        var iframe = document.createElement('iframe');\n\t        iframe.style.display = \"none\";\n\t        iframe.id = \"tokenIFrame\";\n\t        iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n\t            \"&resource=\" + encodeURIComponent(resource) +\n\t            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n\t            \"&state=\" + encodeURIComponent(this.state) +\n\t            \"&version=\" + encodeURIComponent(this.version.toString()) +\n\t            \"&nonce=\" + encodeURIComponent(this.nonce) +\n\t            \"&op=token\";\n\t        document.body.appendChild(iframe);\n\t    };\n\t    Identity.prototype.getAccessTokenForScopesAsync = function (scopes, promptForConsent) {\n\t        if (promptForConsent === void 0) { promptForConsent = false; }\n\t        var d = new promises_1.Deferred();\n\t        this.getAccessTokenForScopes(scopes, promptForConsent, function (token, error) {\n\t            if (error) {\n\t                d.reject(error);\n\t            }\n\t            else {\n\t                d.resolve(token);\n\t            }\n\t        });\n\t        return d.promise;\n\t    };\n\t    Identity.prototype.getAccessTokenForScopes = function (scopes, promptForConsent, callback) {\n\t        var _this = this;\n\t        if (promptForConsent === void 0) { promptForConsent = false; }\n\t        if (this.version !== OAuthVersion.v2) {\n\t            var e = new Error();\n\t            e.statusText = \"Dynamic scopes require v2 mode. Currently this identity class is using v1\";\n\t            callback(null, e);\n\t            return;\n\t        }\n\t        var token = this.tokenCache.getForScopes(scopes);\n\t        if (token) {\n\t            return callback(token.token, null);\n\t        }\n\t        this.getTokenCallback = (function (token, error) {\n\t            if (error) {\n\t                if (promptForConsent || !error.text) {\n\t                    callback(null, error);\n\t                }\n\t                else if (error.text.indexOf(\"AADSTS65001\") >= 0) {\n\t                    _this.getAccessTokenForScopes(scopes, true, _this.getTokenCallback);\n\t                }\n\t                else {\n\t                    callback(null, error);\n\t                }\n\t            }\n\t            else {\n\t                _this.decodeAccessToken(token, null, scopes);\n\t                callback(token, null);\n\t            }\n\t        });\n\t        this.nonce = \"token\" + this.generateNonce();\n\t        this.state = \"token\" + this.generateNonce();\n\t        if (!promptForConsent) {\n\t            var iframe = document.createElement('iframe');\n\t            iframe.style.display = \"none\";\n\t            iframe.id = \"tokenIFrame\";\n\t            iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n\t                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\n\t                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n\t                \"&version=\" + encodeURIComponent(this.version.toString()) +\n\t                \"&state=\" + encodeURIComponent(this.state) +\n\t                \"&nonce=\" + encodeURIComponent(this.nonce) +\n\t                \"&login_hint=\" + encodeURIComponent(this.idToken.PreferredUsername) +\n\t                \"&domain_hint=\" + encodeURIComponent(this.idToken.TenantId === \"9188040d-6c67-4c5b-b112-36a304b66dad\" ? \"consumers\" : \"organizations\") +\n\t                \"&op=token\";\n\t            document.body.appendChild(iframe);\n\t        }\n\t        else {\n\t            window.open(this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n\t                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\n\t                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n\t                \"&version=\" + encodeURIComponent(this.version.toString()) +\n\t                \"&state=\" + encodeURIComponent(this.state) +\n\t                \"&nonce=\" + encodeURIComponent(this.nonce) +\n\t                \"&op=token\", \"_blank\");\n\t        }\n\t    };\n\t    Identity.prototype.loginAsync = function (loginSettings) {\n\t        var d = new promises_1.Deferred();\n\t        this.login(function (error) {\n\t            if (error) {\n\t                d.reject(error);\n\t            }\n\t            else {\n\t                d.resolve(null);\n\t            }\n\t        }, loginSettings);\n\t        return d.promise;\n\t    };\n\t    Identity.prototype.login = function (callback, loginSettings) {\n\t        this.loginCallback = callback;\n\t        if (!loginSettings)\n\t            loginSettings = {};\n\t        if (loginSettings.policy)\n\t            this.policy = loginSettings.policy;\n\t        if (loginSettings.scopes && this.version === OAuthVersion.v1) {\n\t            var e = new Error();\n\t            e.text = \"Scopes can only be used with OAuth v2.\";\n\t            callback(e);\n\t            return;\n\t        }\n\t        if (loginSettings.policy && !loginSettings.tenant) {\n\t            var e = new Error();\n\t            e.text = \"In order to use policy (AAD B2C) a tenant must be specified as well.\";\n\t            callback(e);\n\t            return;\n\t        }\n\t        this.state = \"login\" + this.generateNonce();\n\t        this.nonce = \"login\" + this.generateNonce();\n\t        var loginURL = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n\t            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n\t            \"&state=\" + encodeURIComponent(this.state) +\n\t            \"&nonce=\" + encodeURIComponent(this.nonce) +\n\t            \"&version=\" + encodeURIComponent(this.version.toString()) +\n\t            \"&op=login\" +\n\t            \"&p=\" + encodeURIComponent(this.policy);\n\t        if (loginSettings.tenant) {\n\t            loginURL += \"&tenant=\" + encodeURIComponent(loginSettings.tenant);\n\t        }\n\t        if (this.version === OAuthVersion.v2) {\n\t            if (!loginSettings.scopes)\n\t                loginSettings.scopes = [];\n\t            if (loginSettings.scopes.indexOf(\"profile\") < 0)\n\t                loginSettings.scopes.push(\"profile\");\n\t            if (loginSettings.scopes.indexOf(\"openid\") < 0)\n\t                loginSettings.scopes.push(\"openid\");\n\t            loginURL += \"&scopes=\" + encodeURIComponent(loginSettings.scopes.join(\" \"));\n\t        }\n\t        window.open(loginURL, \"_blank\");\n\t    };\n\t    Identity.prototype.loginNoWindowAsync = function (toUrl) {\n\t        var d = new promises_1.Deferred();\n\t        this.loginNoWindow(function (error) {\n\t            if (error) {\n\t                d.reject(error);\n\t            }\n\t            else {\n\t                d.resolve(null);\n\t            }\n\t        }, toUrl);\n\t        return d.promise;\n\t    };\n\t    Identity.prototype.loginNoWindow = function (callback, toUrl) {\n\t        this.loginCallback = callback;\n\t        this.state = \"clientId=\" + this.clientId + \"&\" + \"tokenProcessorUrl=\" + this.tokenProcessorUrl;\n\t        this.nonce = this.generateNonce();\n\t        var redirected = this.checkForIdentityRedirect();\n\t        if (!redirected) {\n\t            var redirectUri = (toUrl) ? toUrl : window.location.href.split(\"#\")[0];\n\t            var url = \"https://login.microsoftonline.com/common/oauth2/authorize?response_type=id_token\" +\n\t                \"&client_id=\" + encodeURIComponent(this.clientId) +\n\t                \"&redirect_uri=\" + encodeURIComponent(redirectUri) +\n\t                \"&state=\" + encodeURIComponent(this.state) +\n\t                \"&nonce=\" + encodeURIComponent(this.nonce);\n\t            window.location.href = url;\n\t        }\n\t    };\n\t    Identity.prototype.logOut = function () {\n\t        this.tokenCache.clear();\n\t        var url = \"https://login.microsoftonline.com/common/oauth2/logout?post_logout_redirect_uri=\" + encodeURI(window.location.href);\n\t        window.location.href = url;\n\t    };\n\t    Identity.prototype.base64Decode = function (encodedString) {\n\t        var e = {}, i, b = 0, c, x, l = 0, a, r = '', w = String.fromCharCode, L = encodedString.length;\n\t        var A = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\t        for (i = 0; i < 64; i++) {\n\t            e[A.charAt(i)] = i;\n\t        }\n\t        for (x = 0; x < L; x++) {\n\t            c = e[encodedString.charAt(x)];\n\t            b = (b << 6) + c;\n\t            l += 6;\n\t            while (l >= 8) {\n\t                ((a = (b >>> (l -= 8)) & 0xff) || (x < (L - 2))) && (r += w(a));\n\t            }\n\t        }\n\t        return r;\n\t    };\n\t    Identity.prototype.generateNonce = function () {\n\t        var text = \"\";\n\t        var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\t        for (var i = 0; i < 32; i++) {\n\t            text += chars.charAt(Math.floor(Math.random() * chars.length));\n\t        }\n\t        return text;\n\t    };\n\t    return Identity;\n\t}());\n\texports.Identity = Identity;\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\texports.queryUnion = function (query1, query2) { return (query1 ? query1 + (query2 ? \"&\" + query2 : \"\") : query2); };\n\texports.pathWithQuery = function (path, query1, query2) {\n\t    var query = exports.queryUnion(query1, query2);\n\t    return path + (query ? \"?\" + query : \"\");\n\t};\n\tvar selectQuery = function (fields) { return (\"$select=\" + fields.join(\",\")); };\n\tvar orderByQuery = function (fields) { return (\"$orderby=\" + fields.join(\",\")); };\n\tvar Node = (function () {\n\t    function Node(graph, path, query) {\n\t        this.graph = graph;\n\t        this.path = path;\n\t        this.query = query;\n\t        this.pathWithQuery = exports.pathWithQuery(this.path, this.query);\n\t    }\n\t    return Node;\n\t}());\n\texports.Node = Node;\n\tvar AttachmentEndpoint = (function (_super) {\n\t    __extends(AttachmentEndpoint, _super);\n\t    function AttachmentEndpoint() {\n\t        var _this = this;\n\t        _super.apply(this, arguments);\n\t        this.GetAttachment = this.graph.GET(this.pathWithQuery);\n\t        this.addQuery = function (query) { return new AttachmentsEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n\t        this.select = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(selectQuery(fields));\n\t        };\n\t        this.orderby = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(orderByQuery(fields));\n\t        };\n\t    }\n\t    return AttachmentEndpoint;\n\t}(Node));\n\texports.AttachmentEndpoint = AttachmentEndpoint;\n\tvar AttachmentNode = (function (_super) {\n\t    __extends(AttachmentNode, _super);\n\t    function AttachmentNode(graph, path, attachmentId) {\n\t        _super.call(this, graph, path + \"/attachments/\" + attachmentId);\n\t    }\n\t    return AttachmentNode;\n\t}(AttachmentEndpoint));\n\texports.AttachmentNode = AttachmentNode;\n\tvar attachment = function (graph, path) { return function (attachmentId) { return new AttachmentNode(graph, path, attachmentId); }; };\n\tvar AttachmentsEndpoint = (function (_super) {\n\t    __extends(AttachmentsEndpoint, _super);\n\t    function AttachmentsEndpoint() {\n\t        var _this = this;\n\t        _super.apply(this, arguments);\n\t        this.GetAttachments = this.graph.GETCOLLECTION(this.pathWithQuery);\n\t        this.addQuery = function (query) { return new AttachmentsEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n\t        this.select = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(selectQuery(fields));\n\t        };\n\t        this.orderby = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(orderByQuery(fields));\n\t        };\n\t    }\n\t    return AttachmentsEndpoint;\n\t}(Node));\n\texports.AttachmentsEndpoint = AttachmentsEndpoint;\n\tvar AttachmentsNode = (function (_super) {\n\t    __extends(AttachmentsNode, _super);\n\t    function AttachmentsNode(graph, path) {\n\t        _super.call(this, graph, path + \"/attachments\");\n\t    }\n\t    return AttachmentsNode;\n\t}(AttachmentsEndpoint));\n\texports.AttachmentsNode = AttachmentsNode;\n\tvar attachments = function (graph, path) { return new AttachmentsNode(graph, path); };\n\tvar MessageEndpoint = (function (_super) {\n\t    __extends(MessageEndpoint, _super);\n\t    function MessageEndpoint() {\n\t        var _this = this;\n\t        _super.apply(this, arguments);\n\t        this.GetMessage = this.graph.GET(this.pathWithQuery);\n\t        this.addQuery = function (query) { return new MessageEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n\t        this.select = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(selectQuery(fields));\n\t        };\n\t        this.orderby = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(orderByQuery(fields));\n\t        };\n\t    }\n\t    return MessageEndpoint;\n\t}(Node));\n\texports.MessageEndpoint = MessageEndpoint;\n\tvar MessageNode = (function (_super) {\n\t    __extends(MessageNode, _super);\n\t    function MessageNode(graph, path, messageId) {\n\t        _super.call(this, graph, path + \"/messages/\" + messageId);\n\t        this.attachment = attachment(this.graph, this.path);\n\t        this.attachments = attachments(this.graph, this.path);\n\t    }\n\t    return MessageNode;\n\t}(MessageEndpoint));\n\texports.MessageNode = MessageNode;\n\tvar message = function (graph, path) { return function (messageId) { return new MessageNode(graph, path, messageId); }; };\n\tvar MessagesEndpoint = (function (_super) {\n\t    __extends(MessagesEndpoint, _super);\n\t    function MessagesEndpoint() {\n\t        var _this = this;\n\t        _super.apply(this, arguments);\n\t        this.GetMessages = this.graph.GETCOLLECTION(this.pathWithQuery);\n\t        this.addQuery = function (query) { return new MessagesEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n\t        this.select = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(selectQuery(fields));\n\t        };\n\t        this.orderby = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(orderByQuery(fields));\n\t        };\n\t    }\n\t    return MessagesEndpoint;\n\t}(Node));\n\texports.MessagesEndpoint = MessagesEndpoint;\n\tvar MessagesNode = (function (_super) {\n\t    __extends(MessagesNode, _super);\n\t    function MessagesNode(graph, path) {\n\t        _super.call(this, graph, path + \"/messages/\");\n\t    }\n\t    return MessagesNode;\n\t}(MessagesEndpoint));\n\texports.MessagesNode = MessagesNode;\n\tvar messages = function (graph, path) { return new MessagesNode(graph, path); };\n\tvar EventEndpoint = (function (_super) {\n\t    __extends(EventEndpoint, _super);\n\t    function EventEndpoint() {\n\t        var _this = this;\n\t        _super.apply(this, arguments);\n\t        this.GetEvent = this.graph.GET(this.pathWithQuery);\n\t        this.addQuery = function (query) { return new EventEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n\t        this.select = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(selectQuery(fields));\n\t        };\n\t        this.orderby = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(orderByQuery(fields));\n\t        };\n\t    }\n\t    return EventEndpoint;\n\t}(Node));\n\texports.EventEndpoint = EventEndpoint;\n\tvar EventNode = (function (_super) {\n\t    __extends(EventNode, _super);\n\t    function EventNode(graph, path, eventId) {\n\t        _super.call(this, graph, path + \"/events/\");\n\t        this.attachment = attachment(this.graph, this.path);\n\t        this.attachments = attachments(this.graph, this.path);\n\t    }\n\t    return EventNode;\n\t}(EventEndpoint));\n\texports.EventNode = EventNode;\n\tvar event = function (graph, path) { return function (eventId) { return new EventNode(graph, path, eventId); }; };\n\tvar EventsEndpoint = (function (_super) {\n\t    __extends(EventsEndpoint, _super);\n\t    function EventsEndpoint() {\n\t        var _this = this;\n\t        _super.apply(this, arguments);\n\t        this.GetEvents = this.graph.GETCOLLECTION(this.pathWithQuery);\n\t        this.addQuery = function (query) { return new EventsEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n\t        this.select = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(selectQuery(fields));\n\t        };\n\t        this.orderby = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(orderByQuery(fields));\n\t        };\n\t    }\n\t    return EventsEndpoint;\n\t}(Node));\n\texports.EventsEndpoint = EventsEndpoint;\n\tvar EventsNode = (function (_super) {\n\t    __extends(EventsNode, _super);\n\t    function EventsNode(graph, path) {\n\t        _super.call(this, graph, path + \"/events/\");\n\t    }\n\t    return EventsNode;\n\t}(EventsEndpoint));\n\texports.EventsNode = EventsNode;\n\tvar events = function (graph, path) { return new EventsNode(graph, path); };\n\tvar CalendarViewEndpoint = (function (_super) {\n\t    __extends(CalendarViewEndpoint, _super);\n\t    function CalendarViewEndpoint() {\n\t        var _this = this;\n\t        _super.apply(this, arguments);\n\t        this.GetCalendarView = this.graph.GETCOLLECTION(this.pathWithQuery);\n\t        this.addQuery = function (query) { return new CalendarViewEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n\t        this.select = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(selectQuery(fields));\n\t        };\n\t        this.orderby = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(orderByQuery(fields));\n\t        };\n\t    }\n\t    return CalendarViewEndpoint;\n\t}(Node));\n\texports.CalendarViewEndpoint = CalendarViewEndpoint;\n\tvar CalendarViewNode = (function (_super) {\n\t    __extends(CalendarViewNode, _super);\n\t    function CalendarViewNode(graph, path, startDate, endDate) {\n\t        _super.call(this, graph, path + \"/calendarView\", \"startDateTime=\" + startDate.toISOString() + \"&endDateTime=\" + endDate.toISOString());\n\t    }\n\t    return CalendarViewNode;\n\t}(CalendarViewEndpoint));\n\texports.CalendarViewNode = CalendarViewNode;\n\tvar calendarView = function (graph, path) { return function (startDate, endDate) { return new CalendarViewNode(graph, path, startDate, endDate); }; };\n\tvar MailFoldersEndpoint = (function (_super) {\n\t    __extends(MailFoldersEndpoint, _super);\n\t    function MailFoldersEndpoint() {\n\t        var _this = this;\n\t        _super.apply(this, arguments);\n\t        this.GetMailFolders = this.graph.GETCOLLECTION(this.pathWithQuery);\n\t        this.addQuery = function (query) { return new MailFoldersEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n\t        this.select = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(selectQuery(fields));\n\t        };\n\t        this.orderby = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(orderByQuery(fields));\n\t        };\n\t    }\n\t    return MailFoldersEndpoint;\n\t}(Node));\n\texports.MailFoldersEndpoint = MailFoldersEndpoint;\n\tvar MailFoldersNode = (function (_super) {\n\t    __extends(MailFoldersNode, _super);\n\t    function MailFoldersNode(graph, path) {\n\t        _super.call(this, graph, path + \"/mailFolders\");\n\t    }\n\t    return MailFoldersNode;\n\t}(MailFoldersEndpoint));\n\texports.MailFoldersNode = MailFoldersNode;\n\tvar UserEndpoint = (function (_super) {\n\t    __extends(UserEndpoint, _super);\n\t    function UserEndpoint() {\n\t        var _this = this;\n\t        _super.apply(this, arguments);\n\t        this.GetUser = this.graph.GET(this.pathWithQuery);\n\t        this.addQuery = function (query) { return new UserEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n\t        this.select = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(selectQuery(fields));\n\t        };\n\t        this.orderby = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(orderByQuery(fields));\n\t        };\n\t    }\n\t    return UserEndpoint;\n\t}(Node));\n\texports.UserEndpoint = UserEndpoint;\n\tvar UserNode = (function (_super) {\n\t    __extends(UserNode, _super);\n\t    function UserNode(graph, path, userId) {\n\t        if (path === void 0) { path = \"\"; }\n\t        _super.call(this, graph, userId ? path + \"/users/\" + userId : path + \"/me\");\n\t        this.graph = graph;\n\t        this.message = message(this.graph, this.path);\n\t        this.messages = messages(this.graph, this.path);\n\t        this.event = event(this.graph, this.path);\n\t        this.events = events(this.graph, this.path);\n\t        this.calendarView = calendarView(this.graph, this.path);\n\t        this.mailFolders = new MailFoldersNode(this.graph, this.path);\n\t    }\n\t    return UserNode;\n\t}(UserEndpoint));\n\texports.UserNode = UserNode;\n\tvar UsersEndpoint = (function (_super) {\n\t    __extends(UsersEndpoint, _super);\n\t    function UsersEndpoint() {\n\t        var _this = this;\n\t        _super.apply(this, arguments);\n\t        this.GetUsers = this.graph.GETCOLLECTION(this.pathWithQuery);\n\t        this.addQuery = function (query) { return new UsersEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n\t        this.select = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(selectQuery(fields));\n\t        };\n\t        this.orderby = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.addQuery(orderByQuery(fields));\n\t        };\n\t    }\n\t    return UsersEndpoint;\n\t}(Node));\n\texports.UsersEndpoint = UsersEndpoint;\n\tvar UsersNode = (function (_super) {\n\t    __extends(UsersNode, _super);\n\t    function UsersNode(graph, path) {\n\t        if (path === void 0) { path = \"\"; }\n\t        _super.call(this, graph, path + \"/users\");\n\t    }\n\t    return UsersNode;\n\t}(Node));\n\texports.UsersNode = UsersNode;\n\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** dist/kurve.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 4eeb93de5dd2baf0eb75\n **/","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\n__export(require(\"./graph\"));\n__export(require(\"./identity\"));\n__export(require(\"./requestbuilder\"));\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/kurve.ts\n ** module id = 0\n ** module chunks = 0\n **/","\"use strict\";\nvar promises_1 = require(\"./promises\");\nvar identity_1 = require(\"./identity\");\nvar requestbuilder_1 = require(\"./requestbuilder\");\nvar Graph = (function () {\n    function Graph(identityInfo) {\n        var _this = this;\n        this.req = null;\n        this.accessToken = null;\n        this.KurveIdentity = null;\n        this.defaultResourceID = \"https://graph.microsoft.com\";\n        this.baseUrl = \"https://graph.microsoft.com/v1.0\";\n        this.GET = function (path, scopes) { return function () { return _this.Get(path, scopes); }; };\n        this.GETCOLLECTION = function (path, scopes) { return function () { return _this.GetCollection(path, scopes); }; };\n        this.me = new requestbuilder_1.UserNode(this, this.baseUrl);\n        this.user = function (userId) { return new requestbuilder_1.UserNode(_this, _this.baseUrl, userId); };\n        this.users = new requestbuilder_1.UsersNode(this, this.baseUrl);\n        if (identityInfo.defaultAccessToken) {\n            this.accessToken = identityInfo.defaultAccessToken;\n        }\n        else {\n            this.KurveIdentity = identityInfo.identity;\n        }\n    }\n    Graph.prototype.Get = function (path, scopes) {\n        console.log(\"GET\", path);\n        var d = new promises_1.Deferred();\n        this.get(path, function (error, result) {\n            var jsonResult = JSON.parse(result);\n            if (jsonResult.error) {\n                var errorODATA = new identity_1.Error();\n                errorODATA.other = jsonResult.error;\n                d.reject(errorODATA);\n                return;\n            }\n            d.resolve(jsonResult);\n        });\n        return d.promise;\n    };\n    Graph.prototype.GetCollection = function (path, scopes) {\n        console.log(\"GETCOLLECTION\", path);\n        var d = new promises_1.Deferred();\n        this.get(path, function (error, result) {\n            var jsonResult = JSON.parse(result);\n            if (jsonResult.error) {\n                var errorODATA = new identity_1.Error();\n                errorODATA.other = jsonResult.error;\n                d.reject(errorODATA);\n                return;\n            }\n            var resultsArray = (jsonResult.value ? jsonResult.value : [jsonResult]);\n            d.resolve({ objects: resultsArray });\n        });\n        return d.promise;\n    };\n    Graph.prototype.scopesForV2 = function (scopes) {\n        if (!this.KurveIdentity)\n            return null;\n        if (this.KurveIdentity.getCurrentOauthVersion() === identity_1.OAuthVersion.v1)\n            return null;\n        else\n            return scopes;\n    };\n    Graph.prototype.getAsync = function (url) {\n        var d = new promises_1.Deferred();\n        this.get(url, function (error, response) { return error ? d.reject(error) : d.resolve(response); });\n        return d.promise;\n    };\n    Graph.prototype.get = function (url, callback, responseType, scopes) {\n        var _this = this;\n        var xhr = new XMLHttpRequest();\n        if (responseType)\n            xhr.responseType = responseType;\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4)\n                if (xhr.status === 200)\n                    callback(null, responseType ? xhr.response : xhr.responseText);\n                else\n                    callback(_this.generateError(xhr));\n        };\n        xhr.open(\"GET\", url);\n        this.addAccessTokenAndSend(xhr, function (addTokenError) {\n            if (addTokenError) {\n                callback(addTokenError);\n            }\n        }, scopes);\n    };\n    Graph.prototype.generateError = function (xhr) {\n        var response = new identity_1.Error();\n        response.status = xhr.status;\n        response.statusText = xhr.statusText;\n        if (xhr.responseType === '' || xhr.responseType === 'text')\n            response.text = xhr.responseText;\n        else\n            response.other = xhr.response;\n        return response;\n    };\n    Graph.prototype.addAccessTokenAndSend = function (xhr, callback, scopes) {\n        if (this.accessToken) {\n            xhr.setRequestHeader('Authorization', 'Bearer ' + this.accessToken);\n            xhr.send();\n        }\n        else {\n            if (scopes) {\n                this.KurveIdentity.getAccessTokenForScopes(scopes, false, (function (token, error) {\n                    if (error)\n                        callback(error);\n                    else {\n                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\n                        xhr.send();\n                        callback(null);\n                    }\n                }));\n            }\n            else {\n                this.KurveIdentity.getAccessToken(this.defaultResourceID, (function (error, token) {\n                    if (error)\n                        callback(error);\n                    else {\n                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\n                        xhr.send();\n                        callback(null);\n                    }\n                }));\n            }\n        }\n    };\n    return Graph;\n}());\nexports.Graph = Graph;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/graph.ts\n ** module id = 1\n ** module chunks = 0\n **/","\"use strict\";\nfunction DispatchDeferred(closure) {\n    setTimeout(closure, 0);\n}\nvar PromiseState;\n(function (PromiseState) {\n    PromiseState[PromiseState[\"Pending\"] = 0] = \"Pending\";\n    PromiseState[PromiseState[\"ResolutionInProgress\"] = 1] = \"ResolutionInProgress\";\n    PromiseState[PromiseState[\"Resolved\"] = 2] = \"Resolved\";\n    PromiseState[PromiseState[\"Rejected\"] = 3] = \"Rejected\";\n})(PromiseState || (PromiseState = {}));\nvar Client = (function () {\n    function Client(_dispatcher, _successCB, _errorCB) {\n        this._dispatcher = _dispatcher;\n        this._successCB = _successCB;\n        this._errorCB = _errorCB;\n        this.result = new Deferred(_dispatcher);\n    }\n    Client.prototype.resolve = function (value, defer) {\n        var _this = this;\n        if (typeof (this._successCB) !== 'function') {\n            this.result.resolve(value);\n            return;\n        }\n        if (defer) {\n            this._dispatcher(function () { return _this._dispatchCallback(_this._successCB, value); });\n        }\n        else {\n            this._dispatchCallback(this._successCB, value);\n        }\n    };\n    Client.prototype.reject = function (error, defer) {\n        var _this = this;\n        if (typeof (this._errorCB) !== 'function') {\n            this.result.reject(error);\n            return;\n        }\n        if (defer) {\n            this._dispatcher(function () { return _this._dispatchCallback(_this._errorCB, error); });\n        }\n        else {\n            this._dispatchCallback(this._errorCB, error);\n        }\n    };\n    Client.prototype._dispatchCallback = function (callback, arg) {\n        var result, then, type;\n        try {\n            result = callback(arg);\n            this.result.resolve(result);\n        }\n        catch (err) {\n            this.result.reject(err);\n            return;\n        }\n    };\n    return Client;\n}());\nvar Deferred = (function () {\n    function Deferred(dispatcher) {\n        this._stack = [];\n        this._state = PromiseState.Pending;\n        if (dispatcher)\n            this._dispatcher = dispatcher;\n        else\n            this._dispatcher = DispatchDeferred;\n        this.promise = new Promise(this);\n    }\n    Deferred.prototype.DispatchDeferred = function (closure) {\n        setTimeout(closure, 0);\n    };\n    Deferred.prototype.then = function (successCB, errorCB) {\n        if (typeof (successCB) !== 'function' && typeof (errorCB) !== 'function') {\n            return this.promise;\n        }\n        var client = new Client(this._dispatcher, successCB, errorCB);\n        switch (this._state) {\n            case PromiseState.Pending:\n            case PromiseState.ResolutionInProgress:\n                this._stack.push(client);\n                break;\n            case PromiseState.Resolved:\n                client.resolve(this._value, true);\n                break;\n            case PromiseState.Rejected:\n                client.reject(this._error, true);\n                break;\n        }\n        return client.result.promise;\n    };\n    Deferred.prototype.resolve = function (value) {\n        if (this._state !== PromiseState.Pending) {\n            return this;\n        }\n        return this._resolve(value);\n    };\n    Deferred.prototype._resolve = function (value) {\n        var _this = this;\n        var type = typeof (value), then, pending = true;\n        try {\n            if (value !== null &&\n                (type === 'object' || type === 'function') &&\n                typeof (then = value.then) === 'function') {\n                if (value === this.promise) {\n                    throw new TypeError('recursive resolution');\n                }\n                this._state = PromiseState.ResolutionInProgress;\n                then.call(value, function (result) {\n                    if (pending) {\n                        pending = false;\n                        _this._resolve(result);\n                    }\n                }, function (error) {\n                    if (pending) {\n                        pending = false;\n                        _this._reject(error);\n                    }\n                });\n            }\n            else {\n                this._state = PromiseState.ResolutionInProgress;\n                this._dispatcher(function () {\n                    _this._state = PromiseState.Resolved;\n                    _this._value = value;\n                    var i, stackSize = _this._stack.length;\n                    for (i = 0; i < stackSize; i++) {\n                        _this._stack[i].resolve(value, false);\n                    }\n                    _this._stack.splice(0, stackSize);\n                });\n            }\n        }\n        catch (err) {\n            if (pending) {\n                this._reject(err);\n            }\n        }\n        return this;\n    };\n    Deferred.prototype.reject = function (error) {\n        if (this._state !== PromiseState.Pending) {\n            return this;\n        }\n        return this._reject(error);\n    };\n    Deferred.prototype._reject = function (error) {\n        var _this = this;\n        this._state = PromiseState.ResolutionInProgress;\n        this._dispatcher(function () {\n            _this._state = PromiseState.Rejected;\n            _this._error = error;\n            var stackSize = _this._stack.length, i = 0;\n            for (i = 0; i < stackSize; i++) {\n                _this._stack[i].reject(error, false);\n            }\n            _this._stack.splice(0, stackSize);\n        });\n        return this;\n    };\n    return Deferred;\n}());\nexports.Deferred = Deferred;\nvar Promise = (function () {\n    function Promise(_deferred) {\n        this._deferred = _deferred;\n    }\n    Promise.prototype.then = function (successCallback, errorCallback) {\n        return this._deferred.then(successCallback, errorCallback);\n    };\n    Promise.prototype.fail = function (errorCallback) {\n        return this._deferred.then(undefined, errorCallback);\n    };\n    return Promise;\n}());\nexports.Promise = Promise;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/promises.ts\n ** module id = 2\n ** module chunks = 0\n **/","\"use strict\";\nvar promises_1 = require(\"./promises\");\n(function (OAuthVersion) {\n    OAuthVersion[OAuthVersion[\"v1\"] = 1] = \"v1\";\n    OAuthVersion[OAuthVersion[\"v2\"] = 2] = \"v2\";\n})(exports.OAuthVersion || (exports.OAuthVersion = {}));\nvar OAuthVersion = exports.OAuthVersion;\nvar Error = (function () {\n    function Error() {\n    }\n    return Error;\n}());\nexports.Error = Error;\nvar CachedToken = (function () {\n    function CachedToken(id, scopes, resource, token, expiry) {\n        this.id = id;\n        this.scopes = scopes;\n        this.resource = resource;\n        this.token = token;\n        this.expiry = expiry;\n    }\n    ;\n    Object.defineProperty(CachedToken.prototype, \"isExpired\", {\n        get: function () {\n            return this.expiry <= new Date(new Date().getTime() + 60000);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CachedToken.prototype.hasScopes = function (requiredScopes) {\n        var _this = this;\n        if (!this.scopes) {\n            return false;\n        }\n        return requiredScopes.every(function (requiredScope) {\n            return _this.scopes.some(function (actualScope) { return requiredScope === actualScope; });\n        });\n    };\n    return CachedToken;\n}());\nvar TokenCache = (function () {\n    function TokenCache(tokenStorage) {\n        var _this = this;\n        this.tokenStorage = tokenStorage;\n        this.cachedTokens = {};\n        if (tokenStorage) {\n            tokenStorage.getAll().forEach(function (_a) {\n                var id = _a.id, scopes = _a.scopes, resource = _a.resource, token = _a.token, expiry = _a.expiry;\n                var cachedToken = new CachedToken(id, scopes, resource, token, new Date(expiry));\n                if (cachedToken.isExpired) {\n                    _this.tokenStorage.remove(cachedToken.id);\n                }\n                else {\n                    _this.cachedTokens[cachedToken.id] = cachedToken;\n                }\n            });\n        }\n    }\n    TokenCache.prototype.add = function (token) {\n        this.cachedTokens[token.id] = token;\n        this.tokenStorage && this.tokenStorage.add(token.id, token);\n    };\n    TokenCache.prototype.getForResource = function (resource) {\n        var cachedToken = this.cachedTokens[resource];\n        if (cachedToken && cachedToken.isExpired) {\n            this.remove(resource);\n            return null;\n        }\n        return cachedToken;\n    };\n    TokenCache.prototype.getForScopes = function (scopes) {\n        for (var key in this.cachedTokens) {\n            var cachedToken = this.cachedTokens[key];\n            if (cachedToken.hasScopes(scopes)) {\n                if (cachedToken.isExpired) {\n                    this.remove(key);\n                }\n                else {\n                    return cachedToken;\n                }\n            }\n        }\n        return null;\n    };\n    TokenCache.prototype.clear = function () {\n        this.cachedTokens = {};\n        this.tokenStorage && this.tokenStorage.clear();\n    };\n    TokenCache.prototype.remove = function (key) {\n        this.tokenStorage && this.tokenStorage.remove(key);\n        delete this.cachedTokens[key];\n    };\n    return TokenCache;\n}());\nvar IdToken = (function () {\n    function IdToken() {\n    }\n    return IdToken;\n}());\nexports.IdToken = IdToken;\nvar Identity = (function () {\n    function Identity(identitySettings) {\n        var _this = this;\n        this.policy = \"\";\n        this.clientId = identitySettings.clientId;\n        this.tokenProcessorUrl = identitySettings.tokenProcessingUri;\n        if (identitySettings.version)\n            this.version = identitySettings.version;\n        else\n            this.version = OAuthVersion.v1;\n        this.tokenCache = new TokenCache(identitySettings.tokenStorage);\n        window.addEventListener(\"message\", function (event) {\n            if (event.data.type === \"id_token\") {\n                if (event.data.error) {\n                    var e = new Error();\n                    e.text = event.data.error;\n                    _this.loginCallback(e);\n                }\n                else {\n                    if (_this.state !== event.data.state) {\n                        var error = new Error();\n                        error.statusText = \"Invalid state\";\n                        _this.loginCallback(error);\n                    }\n                    else {\n                        _this.decodeIdToken(event.data.token);\n                        _this.loginCallback(null);\n                    }\n                }\n            }\n            else if (event.data.type === \"access_token\") {\n                if (event.data.error) {\n                    var e = new Error();\n                    e.text = event.data.error;\n                    _this.getTokenCallback(null, e);\n                }\n                else {\n                    var token = event.data.token;\n                    var iframe = document.getElementById(\"tokenIFrame\");\n                    iframe.parentNode.removeChild(iframe);\n                    if (event.data.state !== _this.state) {\n                        var error = new Error();\n                        error.statusText = \"Invalid state\";\n                        _this.getTokenCallback(null, error);\n                    }\n                    else {\n                        _this.getTokenCallback(token, null);\n                    }\n                }\n            }\n        });\n    }\n    Identity.prototype.checkForIdentityRedirect = function () {\n        function token(s) {\n            var start = window.location.href.indexOf(s);\n            if (start < 0)\n                return null;\n            var end = window.location.href.indexOf(\"&\", start + s.length);\n            return window.location.href.substring(start, ((end > 0) ? end : window.location.href.length));\n        }\n        function parseQueryString(str) {\n            var queryString = str || window.location.search || '';\n            var keyValPairs = [];\n            var params = {};\n            queryString = queryString.replace(/.*?\\?/, \"\");\n            if (queryString.length) {\n                keyValPairs = queryString.split('&');\n                for (var pairNum in keyValPairs) {\n                    var key = keyValPairs[pairNum].split('=')[0];\n                    if (!key.length)\n                        continue;\n                    if (typeof params[key] === 'undefined')\n                        params[key] = [];\n                    params[key].push(keyValPairs[pairNum].split('=')[1]);\n                }\n            }\n            return params;\n        }\n        var params = parseQueryString(window.location.href);\n        var idToken = token(\"#id_token=\");\n        var accessToken = token(\"#access_token\");\n        if (idToken) {\n            if (true || this.state === params[\"state\"][0]) {\n                this.decodeIdToken(idToken);\n                this.loginCallback && this.loginCallback(null);\n            }\n            else {\n                var error = new Error();\n                error.statusText = \"Invalid state\";\n                this.loginCallback && this.loginCallback(error);\n            }\n            return true;\n        }\n        else if (accessToken) {\n            throw \"Should not get here.  This should be handled via the iframe approach.\";\n        }\n        return false;\n    };\n    Identity.prototype.decodeIdToken = function (idToken) {\n        var _this = this;\n        var decodedToken = this.base64Decode(idToken.substring(idToken.indexOf('.') + 1, idToken.lastIndexOf('.')));\n        var decodedTokenJSON = JSON.parse(decodedToken);\n        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\n        this.idToken = new IdToken();\n        this.idToken.FullToken = decodedTokenJSON;\n        this.idToken.Token = idToken;\n        this.idToken.Expiry = expiryDate;\n        this.idToken.UPN = decodedTokenJSON.upn;\n        this.idToken.TenantId = decodedTokenJSON.tid;\n        this.idToken.FamilyName = decodedTokenJSON.family_name;\n        this.idToken.GivenName = decodedTokenJSON.given_name;\n        this.idToken.Name = decodedTokenJSON.name;\n        this.idToken.PreferredUsername = decodedTokenJSON.preferred_username;\n        var expiration = expiryDate.getTime() - new Date().getTime() - 300000;\n        this.refreshTimer = setTimeout((function () {\n            _this.renewIdToken();\n        }), expiration);\n    };\n    Identity.prototype.decodeAccessToken = function (accessToken, resource, scopes) {\n        var decodedToken = this.base64Decode(accessToken.substring(accessToken.indexOf('.') + 1, accessToken.lastIndexOf('.')));\n        var decodedTokenJSON = JSON.parse(decodedToken);\n        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\n        var key = resource || scopes.join(\" \");\n        var token = new CachedToken(key, scopes, resource, accessToken, expiryDate);\n        this.tokenCache.add(token);\n    };\n    Identity.prototype.getIdToken = function () {\n        return this.idToken;\n    };\n    Identity.prototype.isLoggedIn = function () {\n        if (!this.idToken)\n            return false;\n        return (this.idToken.Expiry > new Date());\n    };\n    Identity.prototype.renewIdToken = function () {\n        clearTimeout(this.refreshTimer);\n        this.login(function () { });\n    };\n    Identity.prototype.getCurrentOauthVersion = function () {\n        return this.version;\n    };\n    Identity.prototype.getAccessTokenAsync = function (resource) {\n        var d = new promises_1.Deferred();\n        this.getAccessToken(resource, (function (error, token) {\n            if (error) {\n                d.reject(error);\n            }\n            else {\n                d.resolve(token);\n            }\n        }));\n        return d.promise;\n    };\n    Identity.prototype.getAccessToken = function (resource, callback) {\n        var _this = this;\n        if (this.version !== OAuthVersion.v1) {\n            var e = new Error();\n            e.statusText = \"Currently this identity class is using v2 OAuth mode. You need to use getAccessTokenForScopes() method\";\n            callback(e);\n            return;\n        }\n        var token = this.tokenCache.getForResource(resource);\n        if (token) {\n            return callback(null, token.token);\n        }\n        this.getTokenCallback = (function (token, error) {\n            if (error) {\n                callback(error);\n            }\n            else {\n                _this.decodeAccessToken(token, resource);\n                callback(null, token);\n            }\n        });\n        this.nonce = \"token\" + this.generateNonce();\n        this.state = \"token\" + this.generateNonce();\n        var iframe = document.createElement('iframe');\n        iframe.style.display = \"none\";\n        iframe.id = \"tokenIFrame\";\n        iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n            \"&resource=\" + encodeURIComponent(resource) +\n            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n            \"&state=\" + encodeURIComponent(this.state) +\n            \"&version=\" + encodeURIComponent(this.version.toString()) +\n            \"&nonce=\" + encodeURIComponent(this.nonce) +\n            \"&op=token\";\n        document.body.appendChild(iframe);\n    };\n    Identity.prototype.getAccessTokenForScopesAsync = function (scopes, promptForConsent) {\n        if (promptForConsent === void 0) { promptForConsent = false; }\n        var d = new promises_1.Deferred();\n        this.getAccessTokenForScopes(scopes, promptForConsent, function (token, error) {\n            if (error) {\n                d.reject(error);\n            }\n            else {\n                d.resolve(token);\n            }\n        });\n        return d.promise;\n    };\n    Identity.prototype.getAccessTokenForScopes = function (scopes, promptForConsent, callback) {\n        var _this = this;\n        if (promptForConsent === void 0) { promptForConsent = false; }\n        if (this.version !== OAuthVersion.v2) {\n            var e = new Error();\n            e.statusText = \"Dynamic scopes require v2 mode. Currently this identity class is using v1\";\n            callback(null, e);\n            return;\n        }\n        var token = this.tokenCache.getForScopes(scopes);\n        if (token) {\n            return callback(token.token, null);\n        }\n        this.getTokenCallback = (function (token, error) {\n            if (error) {\n                if (promptForConsent || !error.text) {\n                    callback(null, error);\n                }\n                else if (error.text.indexOf(\"AADSTS65001\") >= 0) {\n                    _this.getAccessTokenForScopes(scopes, true, _this.getTokenCallback);\n                }\n                else {\n                    callback(null, error);\n                }\n            }\n            else {\n                _this.decodeAccessToken(token, null, scopes);\n                callback(token, null);\n            }\n        });\n        this.nonce = \"token\" + this.generateNonce();\n        this.state = \"token\" + this.generateNonce();\n        if (!promptForConsent) {\n            var iframe = document.createElement('iframe');\n            iframe.style.display = \"none\";\n            iframe.id = \"tokenIFrame\";\n            iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\n                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n                \"&version=\" + encodeURIComponent(this.version.toString()) +\n                \"&state=\" + encodeURIComponent(this.state) +\n                \"&nonce=\" + encodeURIComponent(this.nonce) +\n                \"&login_hint=\" + encodeURIComponent(this.idToken.PreferredUsername) +\n                \"&domain_hint=\" + encodeURIComponent(this.idToken.TenantId === \"9188040d-6c67-4c5b-b112-36a304b66dad\" ? \"consumers\" : \"organizations\") +\n                \"&op=token\";\n            document.body.appendChild(iframe);\n        }\n        else {\n            window.open(this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\n                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n                \"&version=\" + encodeURIComponent(this.version.toString()) +\n                \"&state=\" + encodeURIComponent(this.state) +\n                \"&nonce=\" + encodeURIComponent(this.nonce) +\n                \"&op=token\", \"_blank\");\n        }\n    };\n    Identity.prototype.loginAsync = function (loginSettings) {\n        var d = new promises_1.Deferred();\n        this.login(function (error) {\n            if (error) {\n                d.reject(error);\n            }\n            else {\n                d.resolve(null);\n            }\n        }, loginSettings);\n        return d.promise;\n    };\n    Identity.prototype.login = function (callback, loginSettings) {\n        this.loginCallback = callback;\n        if (!loginSettings)\n            loginSettings = {};\n        if (loginSettings.policy)\n            this.policy = loginSettings.policy;\n        if (loginSettings.scopes && this.version === OAuthVersion.v1) {\n            var e = new Error();\n            e.text = \"Scopes can only be used with OAuth v2.\";\n            callback(e);\n            return;\n        }\n        if (loginSettings.policy && !loginSettings.tenant) {\n            var e = new Error();\n            e.text = \"In order to use policy (AAD B2C) a tenant must be specified as well.\";\n            callback(e);\n            return;\n        }\n        this.state = \"login\" + this.generateNonce();\n        this.nonce = \"login\" + this.generateNonce();\n        var loginURL = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n            \"&state=\" + encodeURIComponent(this.state) +\n            \"&nonce=\" + encodeURIComponent(this.nonce) +\n            \"&version=\" + encodeURIComponent(this.version.toString()) +\n            \"&op=login\" +\n            \"&p=\" + encodeURIComponent(this.policy);\n        if (loginSettings.tenant) {\n            loginURL += \"&tenant=\" + encodeURIComponent(loginSettings.tenant);\n        }\n        if (this.version === OAuthVersion.v2) {\n            if (!loginSettings.scopes)\n                loginSettings.scopes = [];\n            if (loginSettings.scopes.indexOf(\"profile\") < 0)\n                loginSettings.scopes.push(\"profile\");\n            if (loginSettings.scopes.indexOf(\"openid\") < 0)\n                loginSettings.scopes.push(\"openid\");\n            loginURL += \"&scopes=\" + encodeURIComponent(loginSettings.scopes.join(\" \"));\n        }\n        window.open(loginURL, \"_blank\");\n    };\n    Identity.prototype.loginNoWindowAsync = function (toUrl) {\n        var d = new promises_1.Deferred();\n        this.loginNoWindow(function (error) {\n            if (error) {\n                d.reject(error);\n            }\n            else {\n                d.resolve(null);\n            }\n        }, toUrl);\n        return d.promise;\n    };\n    Identity.prototype.loginNoWindow = function (callback, toUrl) {\n        this.loginCallback = callback;\n        this.state = \"clientId=\" + this.clientId + \"&\" + \"tokenProcessorUrl=\" + this.tokenProcessorUrl;\n        this.nonce = this.generateNonce();\n        var redirected = this.checkForIdentityRedirect();\n        if (!redirected) {\n            var redirectUri = (toUrl) ? toUrl : window.location.href.split(\"#\")[0];\n            var url = \"https://login.microsoftonline.com/common/oauth2/authorize?response_type=id_token\" +\n                \"&client_id=\" + encodeURIComponent(this.clientId) +\n                \"&redirect_uri=\" + encodeURIComponent(redirectUri) +\n                \"&state=\" + encodeURIComponent(this.state) +\n                \"&nonce=\" + encodeURIComponent(this.nonce);\n            window.location.href = url;\n        }\n    };\n    Identity.prototype.logOut = function () {\n        this.tokenCache.clear();\n        var url = \"https://login.microsoftonline.com/common/oauth2/logout?post_logout_redirect_uri=\" + encodeURI(window.location.href);\n        window.location.href = url;\n    };\n    Identity.prototype.base64Decode = function (encodedString) {\n        var e = {}, i, b = 0, c, x, l = 0, a, r = '', w = String.fromCharCode, L = encodedString.length;\n        var A = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n        for (i = 0; i < 64; i++) {\n            e[A.charAt(i)] = i;\n        }\n        for (x = 0; x < L; x++) {\n            c = e[encodedString.charAt(x)];\n            b = (b << 6) + c;\n            l += 6;\n            while (l >= 8) {\n                ((a = (b >>> (l -= 8)) & 0xff) || (x < (L - 2))) && (r += w(a));\n            }\n        }\n        return r;\n    };\n    Identity.prototype.generateNonce = function () {\n        var text = \"\";\n        var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n        for (var i = 0; i < 32; i++) {\n            text += chars.charAt(Math.floor(Math.random() * chars.length));\n        }\n        return text;\n    };\n    return Identity;\n}());\nexports.Identity = Identity;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/identity.ts\n ** module id = 3\n ** module chunks = 0\n **/","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nexports.queryUnion = function (query1, query2) { return (query1 ? query1 + (query2 ? \"&\" + query2 : \"\") : query2); };\nexports.pathWithQuery = function (path, query1, query2) {\n    var query = exports.queryUnion(query1, query2);\n    return path + (query ? \"?\" + query : \"\");\n};\nvar selectQuery = function (fields) { return (\"$select=\" + fields.join(\",\")); };\nvar orderByQuery = function (fields) { return (\"$orderby=\" + fields.join(\",\")); };\nvar Node = (function () {\n    function Node(graph, path, query) {\n        this.graph = graph;\n        this.path = path;\n        this.query = query;\n        this.pathWithQuery = exports.pathWithQuery(this.path, this.query);\n    }\n    return Node;\n}());\nexports.Node = Node;\nvar AttachmentEndpoint = (function (_super) {\n    __extends(AttachmentEndpoint, _super);\n    function AttachmentEndpoint() {\n        var _this = this;\n        _super.apply(this, arguments);\n        this.GetAttachment = this.graph.GET(this.pathWithQuery);\n        this.addQuery = function (query) { return new AttachmentsEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n        this.select = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(selectQuery(fields));\n        };\n        this.orderby = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(orderByQuery(fields));\n        };\n    }\n    return AttachmentEndpoint;\n}(Node));\nexports.AttachmentEndpoint = AttachmentEndpoint;\nvar AttachmentNode = (function (_super) {\n    __extends(AttachmentNode, _super);\n    function AttachmentNode(graph, path, attachmentId) {\n        _super.call(this, graph, path + \"/attachments/\" + attachmentId);\n    }\n    return AttachmentNode;\n}(AttachmentEndpoint));\nexports.AttachmentNode = AttachmentNode;\nvar attachment = function (graph, path) { return function (attachmentId) { return new AttachmentNode(graph, path, attachmentId); }; };\nvar AttachmentsEndpoint = (function (_super) {\n    __extends(AttachmentsEndpoint, _super);\n    function AttachmentsEndpoint() {\n        var _this = this;\n        _super.apply(this, arguments);\n        this.GetAttachments = this.graph.GETCOLLECTION(this.pathWithQuery);\n        this.addQuery = function (query) { return new AttachmentsEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n        this.select = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(selectQuery(fields));\n        };\n        this.orderby = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(orderByQuery(fields));\n        };\n    }\n    return AttachmentsEndpoint;\n}(Node));\nexports.AttachmentsEndpoint = AttachmentsEndpoint;\nvar AttachmentsNode = (function (_super) {\n    __extends(AttachmentsNode, _super);\n    function AttachmentsNode(graph, path) {\n        _super.call(this, graph, path + \"/attachments\");\n    }\n    return AttachmentsNode;\n}(AttachmentsEndpoint));\nexports.AttachmentsNode = AttachmentsNode;\nvar attachments = function (graph, path) { return new AttachmentsNode(graph, path); };\nvar MessageEndpoint = (function (_super) {\n    __extends(MessageEndpoint, _super);\n    function MessageEndpoint() {\n        var _this = this;\n        _super.apply(this, arguments);\n        this.GetMessage = this.graph.GET(this.pathWithQuery);\n        this.addQuery = function (query) { return new MessageEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n        this.select = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(selectQuery(fields));\n        };\n        this.orderby = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(orderByQuery(fields));\n        };\n    }\n    return MessageEndpoint;\n}(Node));\nexports.MessageEndpoint = MessageEndpoint;\nvar MessageNode = (function (_super) {\n    __extends(MessageNode, _super);\n    function MessageNode(graph, path, messageId) {\n        _super.call(this, graph, path + \"/messages/\" + messageId);\n        this.attachment = attachment(this.graph, this.path);\n        this.attachments = attachments(this.graph, this.path);\n    }\n    return MessageNode;\n}(MessageEndpoint));\nexports.MessageNode = MessageNode;\nvar message = function (graph, path) { return function (messageId) { return new MessageNode(graph, path, messageId); }; };\nvar MessagesEndpoint = (function (_super) {\n    __extends(MessagesEndpoint, _super);\n    function MessagesEndpoint() {\n        var _this = this;\n        _super.apply(this, arguments);\n        this.GetMessages = this.graph.GETCOLLECTION(this.pathWithQuery);\n        this.addQuery = function (query) { return new MessagesEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n        this.select = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(selectQuery(fields));\n        };\n        this.orderby = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(orderByQuery(fields));\n        };\n    }\n    return MessagesEndpoint;\n}(Node));\nexports.MessagesEndpoint = MessagesEndpoint;\nvar MessagesNode = (function (_super) {\n    __extends(MessagesNode, _super);\n    function MessagesNode(graph, path) {\n        _super.call(this, graph, path + \"/messages/\");\n    }\n    return MessagesNode;\n}(MessagesEndpoint));\nexports.MessagesNode = MessagesNode;\nvar messages = function (graph, path) { return new MessagesNode(graph, path); };\nvar EventEndpoint = (function (_super) {\n    __extends(EventEndpoint, _super);\n    function EventEndpoint() {\n        var _this = this;\n        _super.apply(this, arguments);\n        this.GetEvent = this.graph.GET(this.pathWithQuery);\n        this.addQuery = function (query) { return new EventEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n        this.select = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(selectQuery(fields));\n        };\n        this.orderby = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(orderByQuery(fields));\n        };\n    }\n    return EventEndpoint;\n}(Node));\nexports.EventEndpoint = EventEndpoint;\nvar EventNode = (function (_super) {\n    __extends(EventNode, _super);\n    function EventNode(graph, path, eventId) {\n        _super.call(this, graph, path + \"/events/\");\n        this.attachment = attachment(this.graph, this.path);\n        this.attachments = attachments(this.graph, this.path);\n    }\n    return EventNode;\n}(EventEndpoint));\nexports.EventNode = EventNode;\nvar event = function (graph, path) { return function (eventId) { return new EventNode(graph, path, eventId); }; };\nvar EventsEndpoint = (function (_super) {\n    __extends(EventsEndpoint, _super);\n    function EventsEndpoint() {\n        var _this = this;\n        _super.apply(this, arguments);\n        this.GetEvents = this.graph.GETCOLLECTION(this.pathWithQuery);\n        this.addQuery = function (query) { return new EventsEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n        this.select = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(selectQuery(fields));\n        };\n        this.orderby = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(orderByQuery(fields));\n        };\n    }\n    return EventsEndpoint;\n}(Node));\nexports.EventsEndpoint = EventsEndpoint;\nvar EventsNode = (function (_super) {\n    __extends(EventsNode, _super);\n    function EventsNode(graph, path) {\n        _super.call(this, graph, path + \"/events/\");\n    }\n    return EventsNode;\n}(EventsEndpoint));\nexports.EventsNode = EventsNode;\nvar events = function (graph, path) { return new EventsNode(graph, path); };\nvar CalendarViewEndpoint = (function (_super) {\n    __extends(CalendarViewEndpoint, _super);\n    function CalendarViewEndpoint() {\n        var _this = this;\n        _super.apply(this, arguments);\n        this.GetCalendarView = this.graph.GETCOLLECTION(this.pathWithQuery);\n        this.addQuery = function (query) { return new CalendarViewEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n        this.select = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(selectQuery(fields));\n        };\n        this.orderby = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(orderByQuery(fields));\n        };\n    }\n    return CalendarViewEndpoint;\n}(Node));\nexports.CalendarViewEndpoint = CalendarViewEndpoint;\nvar CalendarViewNode = (function (_super) {\n    __extends(CalendarViewNode, _super);\n    function CalendarViewNode(graph, path, startDate, endDate) {\n        _super.call(this, graph, path + \"/calendarView\", \"startDateTime=\" + startDate.toISOString() + \"&endDateTime=\" + endDate.toISOString());\n    }\n    return CalendarViewNode;\n}(CalendarViewEndpoint));\nexports.CalendarViewNode = CalendarViewNode;\nvar calendarView = function (graph, path) { return function (startDate, endDate) { return new CalendarViewNode(graph, path, startDate, endDate); }; };\nvar MailFoldersEndpoint = (function (_super) {\n    __extends(MailFoldersEndpoint, _super);\n    function MailFoldersEndpoint() {\n        var _this = this;\n        _super.apply(this, arguments);\n        this.GetMailFolders = this.graph.GETCOLLECTION(this.pathWithQuery);\n        this.addQuery = function (query) { return new MailFoldersEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n        this.select = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(selectQuery(fields));\n        };\n        this.orderby = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(orderByQuery(fields));\n        };\n    }\n    return MailFoldersEndpoint;\n}(Node));\nexports.MailFoldersEndpoint = MailFoldersEndpoint;\nvar MailFoldersNode = (function (_super) {\n    __extends(MailFoldersNode, _super);\n    function MailFoldersNode(graph, path) {\n        _super.call(this, graph, path + \"/mailFolders\");\n    }\n    return MailFoldersNode;\n}(MailFoldersEndpoint));\nexports.MailFoldersNode = MailFoldersNode;\nvar UserEndpoint = (function (_super) {\n    __extends(UserEndpoint, _super);\n    function UserEndpoint() {\n        var _this = this;\n        _super.apply(this, arguments);\n        this.GetUser = this.graph.GET(this.pathWithQuery);\n        this.addQuery = function (query) { return new UserEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n        this.select = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(selectQuery(fields));\n        };\n        this.orderby = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(orderByQuery(fields));\n        };\n    }\n    return UserEndpoint;\n}(Node));\nexports.UserEndpoint = UserEndpoint;\nvar UserNode = (function (_super) {\n    __extends(UserNode, _super);\n    function UserNode(graph, path, userId) {\n        if (path === void 0) { path = \"\"; }\n        _super.call(this, graph, userId ? path + \"/users/\" + userId : path + \"/me\");\n        this.graph = graph;\n        this.message = message(this.graph, this.path);\n        this.messages = messages(this.graph, this.path);\n        this.event = event(this.graph, this.path);\n        this.events = events(this.graph, this.path);\n        this.calendarView = calendarView(this.graph, this.path);\n        this.mailFolders = new MailFoldersNode(this.graph, this.path);\n    }\n    return UserNode;\n}(UserEndpoint));\nexports.UserNode = UserNode;\nvar UsersEndpoint = (function (_super) {\n    __extends(UsersEndpoint, _super);\n    function UsersEndpoint() {\n        var _this = this;\n        _super.apply(this, arguments);\n        this.GetUsers = this.graph.GETCOLLECTION(this.pathWithQuery);\n        this.addQuery = function (query) { return new UsersEndpoint(_this.graph, _this.path, exports.queryUnion(_this.query, query)); };\n        this.select = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(selectQuery(fields));\n        };\n        this.orderby = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.addQuery(orderByQuery(fields));\n        };\n    }\n    return UsersEndpoint;\n}(Node));\nexports.UsersEndpoint = UsersEndpoint;\nvar UsersNode = (function (_super) {\n    __extends(UsersNode, _super);\n    function UsersNode(graph, path) {\n        if (path === void 0) { path = \"\"; }\n        _super.call(this, graph, path + \"/users\");\n    }\n    return UsersNode;\n}(Node));\nexports.UsersNode = UsersNode;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/requestbuilder.ts\n ** module id = 4\n ** module chunks = 0\n **/"],"sourceRoot":""}