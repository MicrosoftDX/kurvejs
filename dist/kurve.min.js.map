{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///dist/kurve.min.js","webpack:///webpack/bootstrap d68a24e8a94a953e1e13","webpack:///./src/kurve.ts","webpack:///./src/graph.ts","webpack:///./src/promises.ts","webpack:///./src/identity.ts","webpack:///./src/requestbuilder.ts"],"names":["root","factory","exports","module","define","amd","this","modules","__webpack_require__","moduleId","installedModules","id","loaded","call","m","c","p","__export","hasOwnProperty","promises_1","identity_1","requestbuilder_1","Graph","identityInfo","req","accessToken","KurveIdentity","defaultResourceID","baseUrl","defaultAccessToken","identity","Object","defineProperty","prototype","get","User","enumerable","configurable","Users","Get","path","self","scopes","console","log","d","Deferred","error","result","jsonResult","JSON","parse","errorODATA","Error","other","reject","resolve","Singleton","promise","GetCollection","next","Collection","Post","object","scopesForV2","getCurrentOauthVersion","OAuthVersion","v1","url","callback","responseType","_this","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","responseText","generateError","open","addAccessTokenAndSend","addTokenError","post","send","statusText","text","setRequestHeader","getAccessTokenForScopes","token","getAccessToken","foo","DispatchDeferred","closure","setTimeout","PromiseState","Client","_dispatcher","_successCB","_errorCB","value","defer","_dispatchCallback","arg","err","dispatcher","_stack","_state","Pending","Promise","then","successCB","errorCB","client","ResolutionInProgress","push","Resolved","_value","Rejected","_error","_resolve","type","pending","i","stackSize","length","splice","TypeError","_reject","_deferred","successCallback","errorCallback","fail","undefined","CachedToken","resource","expiry","Date","getTime","hasScopes","requiredScopes","every","requiredScope","some","actualScope","TokenCache","tokenStorage","cachedTokens","getAll","forEach","_a","cachedToken","isExpired","remove","add","getForResource","getForScopes","key","clear","IdToken","Identity","identitySettings","policy","clientId","tokenProcessorUrl","tokenProcessingUri","version","tokenCache","window","addEventListener","event","data","e","loginCallback","state","decodeIdToken","getTokenCallback","iframe","document","getElementById","parentNode","removeChild","checkForIdentityRedirect","s","start","location","href","indexOf","end","substring","parseQueryString","str","queryString","search","keyValPairs","params","replace","split","pairNum","idToken","decodedToken","base64Decode","lastIndexOf","decodedTokenJSON","expiryDate","parseInt","exp","FullToken","Token","Expiry","UPN","upn","TenantId","tid","FamilyName","family_name","GivenName","given_name","Name","name","PreferredUsername","preferred_username","expiration","refreshTimer","renewIdToken","decodeAccessToken","join","getIdToken","isLoggedIn","clearTimeout","login","getAccessTokenAsync","nonce","generateNonce","createElement","style","display","src","encodeURIComponent","toString","body","appendChild","getAccessTokenForScopesAsync","promptForConsent","v2","loginAsync","loginSettings","tenant","loginURL","loginNoWindowAsync","toUrl","loginNoWindow","redirected","redirectUri","logOut","encodeURI","encodedString","x","a","b","l","r","w","String","fromCharCode","L","A","charAt","chars","Math","floor","random","__extends","__","constructor","create","graph_1","Scopes","rootUrl","General","OpenId","OfflineAccess","Read","ReadAll","ReadWrite","ReadWriteAll","ReadBasicAll","Contacts","Directory","AccessAsUserAll","Group","Mail","Send","Calendars","Files","ReadWriteAppFolder","ReadWriteSelected","Tasks","People","Notes","Create","ReadWriteCreatedByApp","queryUnion","query1","query2","OData","query","odata","select","fields","_i","arguments","expand","filter","orderby","top","items","skip","pathWithQuery","odataQuery","raw","nextLink","Node","graph","pathSuffix","CollectionNode","_super","apply","_nextLink","set","Attachment","context","attachmentId","GetAttachment","messages","events","Attachments","$","GetAttachments","Message","messageId","GetMessage","SendMessage","Messages","GetMessages","CreateMessage","Event","eventId","GetEvent","eventsScopes","Events","GetEvents","CalendarView","dateRange","startDate","endDate","toISOString","GetCalendarView","mailFolderScopes","MailFolder","mailFolderId","GetMailFolder","MailFolders","GetMailFolders","usersScopes","userScopes","concat","userId","GetUser","GetUsers"],"mappings":"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","file":"dist/kurve.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Kurve\"] = factory();\n\telse\n\t\troot[\"Kurve\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Kurve\"] = factory();\n\telse\n\t\troot[\"Kurve\"] = factory();\n})(this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tfunction __export(m) {\n\t    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n\t}\n\t__export(__webpack_require__(1));\n\t__export(__webpack_require__(3));\n\t__export(__webpack_require__(4));\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar promises_1 = __webpack_require__(2);\n\tvar identity_1 = __webpack_require__(3);\n\tvar requestbuilder_1 = __webpack_require__(4);\n\tvar Graph = (function () {\n\t    function Graph(identityInfo) {\n\t        this.req = null;\n\t        this.accessToken = null;\n\t        this.KurveIdentity = null;\n\t        this.defaultResourceID = \"https://graph.microsoft.com\";\n\t        this.baseUrl = \"https://graph.microsoft.com/v1.0\";\n\t        if (identityInfo.defaultAccessToken) {\n\t            this.accessToken = identityInfo.defaultAccessToken;\n\t        }\n\t        else {\n\t            this.KurveIdentity = identityInfo.identity;\n\t        }\n\t    }\n\t    Object.defineProperty(Graph.prototype, \"me\", {\n\t        get: function () { return new requestbuilder_1.User(this, this.baseUrl); },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    Object.defineProperty(Graph.prototype, \"users\", {\n\t        get: function () { return new requestbuilder_1.Users(this, this.baseUrl); },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    Graph.prototype.Get = function (path, self, scopes) {\n\t        console.log(\"GET\", path, scopes);\n\t        var d = new promises_1.Deferred();\n\t        this.get(path, function (error, result) {\n\t            var jsonResult = JSON.parse(result);\n\t            if (jsonResult.error) {\n\t                var errorODATA = new identity_1.Error();\n\t                errorODATA.other = jsonResult.error;\n\t                d.reject(errorODATA);\n\t                return;\n\t            }\n\t            d.resolve(new requestbuilder_1.Singleton(jsonResult, self));\n\t        });\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.GetCollection = function (path, self, next, scopes) {\n\t        console.log(\"GET collection\", path, scopes);\n\t        var d = new promises_1.Deferred();\n\t        this.get(path, function (error, result) {\n\t            var jsonResult = JSON.parse(result);\n\t            if (jsonResult.error) {\n\t                var errorODATA = new identity_1.Error();\n\t                errorODATA.other = jsonResult.error;\n\t                d.reject(errorODATA);\n\t                return;\n\t            }\n\t            d.resolve(new requestbuilder_1.Collection(jsonResult, self, next));\n\t        });\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.Post = function (object, path, self, scopes) {\n\t        console.log(\"POST\", path, scopes);\n\t        var d = new promises_1.Deferred();\n\t        return d.promise;\n\t    };\n\t    Graph.prototype.scopesForV2 = function (scopes) {\n\t        if (!this.KurveIdentity)\n\t            return null;\n\t        if (this.KurveIdentity.getCurrentOauthVersion() === identity_1.OAuthVersion.v1)\n\t            return null;\n\t        else\n\t            return scopes;\n\t    };\n\t    Graph.prototype.get = function (url, callback, responseType, scopes) {\n\t        var _this = this;\n\t        var xhr = new XMLHttpRequest();\n\t        if (responseType)\n\t            xhr.responseType = responseType;\n\t        xhr.onreadystatechange = function () {\n\t            if (xhr.readyState === 4)\n\t                if (xhr.status === 200)\n\t                    callback(null, responseType ? xhr.response : xhr.responseText);\n\t                else\n\t                    callback(_this.generateError(xhr));\n\t        };\n\t        xhr.open(\"GET\", url);\n\t        this.addAccessTokenAndSend(xhr, function (addTokenError) {\n\t            if (addTokenError) {\n\t                callback(addTokenError);\n\t            }\n\t        }, scopes);\n\t    };\n\t    Graph.prototype.post = function (object, url, callback, responseType, scopes) {\n\t        var _this = this;\n\t        var xhr = new XMLHttpRequest();\n\t        if (responseType)\n\t            xhr.responseType = responseType;\n\t        xhr.onreadystatechange = function () {\n\t            if (xhr.readyState === 4)\n\t                if (xhr.status === 202)\n\t                    callback(null, responseType ? xhr.response : xhr.responseText);\n\t                else\n\t                    callback(_this.generateError(xhr));\n\t        };\n\t        xhr.send(object);\n\t        xhr.open(\"GET\", url);\n\t        this.addAccessTokenAndSend(xhr, function (addTokenError) {\n\t            if (addTokenError) {\n\t                callback(addTokenError);\n\t            }\n\t        }, scopes);\n\t    };\n\t    Graph.prototype.generateError = function (xhr) {\n\t        var response = new identity_1.Error();\n\t        response.status = xhr.status;\n\t        response.statusText = xhr.statusText;\n\t        if (xhr.responseType === '' || xhr.responseType === 'text')\n\t            response.text = xhr.responseText;\n\t        else\n\t            response.other = xhr.response;\n\t        return response;\n\t    };\n\t    Graph.prototype.addAccessTokenAndSend = function (xhr, callback, scopes) {\n\t        if (this.accessToken) {\n\t            xhr.setRequestHeader('Authorization', 'Bearer ' + this.accessToken);\n\t            xhr.send();\n\t        }\n\t        else {\n\t            if (scopes) {\n\t                this.KurveIdentity.getAccessTokenForScopes(scopes, false, (function (token, error) {\n\t                    if (error)\n\t                        callback(error);\n\t                    else {\n\t                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\n\t                        xhr.send();\n\t                        callback(null);\n\t                    }\n\t                }));\n\t            }\n\t            else {\n\t                this.KurveIdentity.getAccessToken(this.defaultResourceID, (function (error, token) {\n\t                    if (error)\n\t                        callback(error);\n\t                    else {\n\t                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\n\t                        xhr.send();\n\t                        callback(null);\n\t                    }\n\t                }));\n\t            }\n\t        }\n\t    };\n\t    Graph.foo = function () { return \"test\"; };\n\t    return Graph;\n\t}());\n\texports.Graph = Graph;\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports) {\n\n\t\"use strict\";\n\tfunction DispatchDeferred(closure) {\n\t    setTimeout(closure, 0);\n\t}\n\tvar PromiseState;\n\t(function (PromiseState) {\n\t    PromiseState[PromiseState[\"Pending\"] = 0] = \"Pending\";\n\t    PromiseState[PromiseState[\"ResolutionInProgress\"] = 1] = \"ResolutionInProgress\";\n\t    PromiseState[PromiseState[\"Resolved\"] = 2] = \"Resolved\";\n\t    PromiseState[PromiseState[\"Rejected\"] = 3] = \"Rejected\";\n\t})(PromiseState || (PromiseState = {}));\n\tvar Client = (function () {\n\t    function Client(_dispatcher, _successCB, _errorCB) {\n\t        this._dispatcher = _dispatcher;\n\t        this._successCB = _successCB;\n\t        this._errorCB = _errorCB;\n\t        this.result = new Deferred(_dispatcher);\n\t    }\n\t    Client.prototype.resolve = function (value, defer) {\n\t        var _this = this;\n\t        if (typeof (this._successCB) !== 'function') {\n\t            this.result.resolve(value);\n\t            return;\n\t        }\n\t        if (defer) {\n\t            this._dispatcher(function () { return _this._dispatchCallback(_this._successCB, value); });\n\t        }\n\t        else {\n\t            this._dispatchCallback(this._successCB, value);\n\t        }\n\t    };\n\t    Client.prototype.reject = function (error, defer) {\n\t        var _this = this;\n\t        if (typeof (this._errorCB) !== 'function') {\n\t            this.result.reject(error);\n\t            return;\n\t        }\n\t        if (defer) {\n\t            this._dispatcher(function () { return _this._dispatchCallback(_this._errorCB, error); });\n\t        }\n\t        else {\n\t            this._dispatchCallback(this._errorCB, error);\n\t        }\n\t    };\n\t    Client.prototype._dispatchCallback = function (callback, arg) {\n\t        var result, then, type;\n\t        try {\n\t            result = callback(arg);\n\t            this.result.resolve(result);\n\t        }\n\t        catch (err) {\n\t            this.result.reject(err);\n\t            return;\n\t        }\n\t    };\n\t    return Client;\n\t}());\n\tvar Deferred = (function () {\n\t    function Deferred(dispatcher) {\n\t        this._stack = [];\n\t        this._state = PromiseState.Pending;\n\t        if (dispatcher)\n\t            this._dispatcher = dispatcher;\n\t        else\n\t            this._dispatcher = DispatchDeferred;\n\t        this.promise = new Promise(this);\n\t    }\n\t    Deferred.prototype.DispatchDeferred = function (closure) {\n\t        setTimeout(closure, 0);\n\t    };\n\t    Deferred.prototype.then = function (successCB, errorCB) {\n\t        if (typeof (successCB) !== 'function' && typeof (errorCB) !== 'function') {\n\t            return this.promise;\n\t        }\n\t        var client = new Client(this._dispatcher, successCB, errorCB);\n\t        switch (this._state) {\n\t            case PromiseState.Pending:\n\t            case PromiseState.ResolutionInProgress:\n\t                this._stack.push(client);\n\t                break;\n\t            case PromiseState.Resolved:\n\t                client.resolve(this._value, true);\n\t                break;\n\t            case PromiseState.Rejected:\n\t                client.reject(this._error, true);\n\t                break;\n\t        }\n\t        return client.result.promise;\n\t    };\n\t    Deferred.prototype.resolve = function (value) {\n\t        if (this._state !== PromiseState.Pending) {\n\t            return this;\n\t        }\n\t        return this._resolve(value);\n\t    };\n\t    Deferred.prototype._resolve = function (value) {\n\t        var _this = this;\n\t        var type = typeof (value), then, pending = true;\n\t        try {\n\t            if (value !== null &&\n\t                (type === 'object' || type === 'function') &&\n\t                typeof (then = value.then) === 'function') {\n\t                if (value === this.promise) {\n\t                    throw new TypeError('recursive resolution');\n\t                }\n\t                this._state = PromiseState.ResolutionInProgress;\n\t                then.call(value, function (result) {\n\t                    if (pending) {\n\t                        pending = false;\n\t                        _this._resolve(result);\n\t                    }\n\t                }, function (error) {\n\t                    if (pending) {\n\t                        pending = false;\n\t                        _this._reject(error);\n\t                    }\n\t                });\n\t            }\n\t            else {\n\t                this._state = PromiseState.ResolutionInProgress;\n\t                this._dispatcher(function () {\n\t                    _this._state = PromiseState.Resolved;\n\t                    _this._value = value;\n\t                    var i, stackSize = _this._stack.length;\n\t                    for (i = 0; i < stackSize; i++) {\n\t                        _this._stack[i].resolve(value, false);\n\t                    }\n\t                    _this._stack.splice(0, stackSize);\n\t                });\n\t            }\n\t        }\n\t        catch (err) {\n\t            if (pending) {\n\t                this._reject(err);\n\t            }\n\t        }\n\t        return this;\n\t    };\n\t    Deferred.prototype.reject = function (error) {\n\t        if (this._state !== PromiseState.Pending) {\n\t            return this;\n\t        }\n\t        return this._reject(error);\n\t    };\n\t    Deferred.prototype._reject = function (error) {\n\t        var _this = this;\n\t        this._state = PromiseState.ResolutionInProgress;\n\t        this._dispatcher(function () {\n\t            _this._state = PromiseState.Rejected;\n\t            _this._error = error;\n\t            var stackSize = _this._stack.length, i = 0;\n\t            for (i = 0; i < stackSize; i++) {\n\t                _this._stack[i].reject(error, false);\n\t            }\n\t            _this._stack.splice(0, stackSize);\n\t        });\n\t        return this;\n\t    };\n\t    return Deferred;\n\t}());\n\texports.Deferred = Deferred;\n\tvar Promise = (function () {\n\t    function Promise(_deferred) {\n\t        this._deferred = _deferred;\n\t    }\n\t    Promise.prototype.then = function (successCallback, errorCallback) {\n\t        return this._deferred.then(successCallback, errorCallback);\n\t    };\n\t    Promise.prototype.fail = function (errorCallback) {\n\t        return this._deferred.then(undefined, errorCallback);\n\t    };\n\t    return Promise;\n\t}());\n\texports.Promise = Promise;\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar promises_1 = __webpack_require__(2);\n\t(function (OAuthVersion) {\n\t    OAuthVersion[OAuthVersion[\"v1\"] = 1] = \"v1\";\n\t    OAuthVersion[OAuthVersion[\"v2\"] = 2] = \"v2\";\n\t})(exports.OAuthVersion || (exports.OAuthVersion = {}));\n\tvar OAuthVersion = exports.OAuthVersion;\n\tvar Error = (function () {\n\t    function Error() {\n\t    }\n\t    return Error;\n\t}());\n\texports.Error = Error;\n\tvar CachedToken = (function () {\n\t    function CachedToken(id, scopes, resource, token, expiry) {\n\t        this.id = id;\n\t        this.scopes = scopes;\n\t        this.resource = resource;\n\t        this.token = token;\n\t        this.expiry = expiry;\n\t    }\n\t    ;\n\t    Object.defineProperty(CachedToken.prototype, \"isExpired\", {\n\t        get: function () {\n\t            return this.expiry <= new Date(new Date().getTime() + 60000);\n\t        },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    CachedToken.prototype.hasScopes = function (requiredScopes) {\n\t        var _this = this;\n\t        if (!this.scopes) {\n\t            return false;\n\t        }\n\t        return requiredScopes.every(function (requiredScope) {\n\t            return _this.scopes.some(function (actualScope) { return requiredScope === actualScope; });\n\t        });\n\t    };\n\t    return CachedToken;\n\t}());\n\tvar TokenCache = (function () {\n\t    function TokenCache(tokenStorage) {\n\t        var _this = this;\n\t        this.tokenStorage = tokenStorage;\n\t        this.cachedTokens = {};\n\t        if (tokenStorage) {\n\t            tokenStorage.getAll().forEach(function (_a) {\n\t                var id = _a.id, scopes = _a.scopes, resource = _a.resource, token = _a.token, expiry = _a.expiry;\n\t                var cachedToken = new CachedToken(id, scopes, resource, token, new Date(expiry));\n\t                if (cachedToken.isExpired) {\n\t                    _this.tokenStorage.remove(cachedToken.id);\n\t                }\n\t                else {\n\t                    _this.cachedTokens[cachedToken.id] = cachedToken;\n\t                }\n\t            });\n\t        }\n\t    }\n\t    TokenCache.prototype.add = function (token) {\n\t        this.cachedTokens[token.id] = token;\n\t        this.tokenStorage && this.tokenStorage.add(token.id, token);\n\t    };\n\t    TokenCache.prototype.getForResource = function (resource) {\n\t        var cachedToken = this.cachedTokens[resource];\n\t        if (cachedToken && cachedToken.isExpired) {\n\t            this.remove(resource);\n\t            return null;\n\t        }\n\t        return cachedToken;\n\t    };\n\t    TokenCache.prototype.getForScopes = function (scopes) {\n\t        for (var key in this.cachedTokens) {\n\t            var cachedToken = this.cachedTokens[key];\n\t            if (cachedToken.hasScopes(scopes)) {\n\t                if (cachedToken.isExpired) {\n\t                    this.remove(key);\n\t                }\n\t                else {\n\t                    return cachedToken;\n\t                }\n\t            }\n\t        }\n\t        return null;\n\t    };\n\t    TokenCache.prototype.clear = function () {\n\t        this.cachedTokens = {};\n\t        this.tokenStorage && this.tokenStorage.clear();\n\t    };\n\t    TokenCache.prototype.remove = function (key) {\n\t        this.tokenStorage && this.tokenStorage.remove(key);\n\t        delete this.cachedTokens[key];\n\t    };\n\t    return TokenCache;\n\t}());\n\tvar IdToken = (function () {\n\t    function IdToken() {\n\t    }\n\t    return IdToken;\n\t}());\n\texports.IdToken = IdToken;\n\tvar Identity = (function () {\n\t    function Identity(identitySettings) {\n\t        var _this = this;\n\t        this.policy = \"\";\n\t        this.clientId = identitySettings.clientId;\n\t        this.tokenProcessorUrl = identitySettings.tokenProcessingUri;\n\t        if (identitySettings.version)\n\t            this.version = identitySettings.version;\n\t        else\n\t            this.version = OAuthVersion.v1;\n\t        this.tokenCache = new TokenCache(identitySettings.tokenStorage);\n\t        window.addEventListener(\"message\", function (event) {\n\t            if (event.data.type === \"id_token\") {\n\t                if (event.data.error) {\n\t                    var e = new Error();\n\t                    e.text = event.data.error;\n\t                    _this.loginCallback(e);\n\t                }\n\t                else {\n\t                    if (_this.state !== event.data.state) {\n\t                        var error = new Error();\n\t                        error.statusText = \"Invalid state\";\n\t                        _this.loginCallback(error);\n\t                    }\n\t                    else {\n\t                        _this.decodeIdToken(event.data.token);\n\t                        _this.loginCallback(null);\n\t                    }\n\t                }\n\t            }\n\t            else if (event.data.type === \"access_token\") {\n\t                if (event.data.error) {\n\t                    var e = new Error();\n\t                    e.text = event.data.error;\n\t                    _this.getTokenCallback(null, e);\n\t                }\n\t                else {\n\t                    var token = event.data.token;\n\t                    var iframe = document.getElementById(\"tokenIFrame\");\n\t                    iframe.parentNode.removeChild(iframe);\n\t                    if (event.data.state !== _this.state) {\n\t                        var error = new Error();\n\t                        error.statusText = \"Invalid state\";\n\t                        _this.getTokenCallback(null, error);\n\t                    }\n\t                    else {\n\t                        _this.getTokenCallback(token, null);\n\t                    }\n\t                }\n\t            }\n\t        });\n\t    }\n\t    Identity.prototype.checkForIdentityRedirect = function () {\n\t        function token(s) {\n\t            var start = window.location.href.indexOf(s);\n\t            if (start < 0)\n\t                return null;\n\t            var end = window.location.href.indexOf(\"&\", start + s.length);\n\t            return window.location.href.substring(start, ((end > 0) ? end : window.location.href.length));\n\t        }\n\t        function parseQueryString(str) {\n\t            var queryString = str || window.location.search || '';\n\t            var keyValPairs = [];\n\t            var params = {};\n\t            queryString = queryString.replace(/.*?\\?/, \"\");\n\t            if (queryString.length) {\n\t                keyValPairs = queryString.split('&');\n\t                for (var pairNum in keyValPairs) {\n\t                    var key = keyValPairs[pairNum].split('=')[0];\n\t                    if (!key.length)\n\t                        continue;\n\t                    if (typeof params[key] === 'undefined')\n\t                        params[key] = [];\n\t                    params[key].push(keyValPairs[pairNum].split('=')[1]);\n\t                }\n\t            }\n\t            return params;\n\t        }\n\t        var params = parseQueryString(window.location.href);\n\t        var idToken = token(\"#id_token=\");\n\t        var accessToken = token(\"#access_token\");\n\t        if (idToken) {\n\t            if (true) {\n\t                this.decodeIdToken(idToken);\n\t                this.loginCallback && this.loginCallback(null);\n\t            }\n\t            else {\n\t                var error = new Error();\n\t                error.statusText = \"Invalid state\";\n\t                this.loginCallback && this.loginCallback(error);\n\t            }\n\t            return true;\n\t        }\n\t        else if (accessToken) {\n\t            throw \"Should not get here.  This should be handled via the iframe approach.\";\n\t        }\n\t        return false;\n\t    };\n\t    Identity.prototype.decodeIdToken = function (idToken) {\n\t        var _this = this;\n\t        var decodedToken = this.base64Decode(idToken.substring(idToken.indexOf('.') + 1, idToken.lastIndexOf('.')));\n\t        var decodedTokenJSON = JSON.parse(decodedToken);\n\t        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\n\t        this.idToken = new IdToken();\n\t        this.idToken.FullToken = decodedTokenJSON;\n\t        this.idToken.Token = idToken;\n\t        this.idToken.Expiry = expiryDate;\n\t        this.idToken.UPN = decodedTokenJSON.upn;\n\t        this.idToken.TenantId = decodedTokenJSON.tid;\n\t        this.idToken.FamilyName = decodedTokenJSON.family_name;\n\t        this.idToken.GivenName = decodedTokenJSON.given_name;\n\t        this.idToken.Name = decodedTokenJSON.name;\n\t        this.idToken.PreferredUsername = decodedTokenJSON.preferred_username;\n\t        var expiration = expiryDate.getTime() - new Date().getTime() - 300000;\n\t        this.refreshTimer = setTimeout((function () {\n\t            _this.renewIdToken();\n\t        }), expiration);\n\t    };\n\t    Identity.prototype.decodeAccessToken = function (accessToken, resource, scopes) {\n\t        var decodedToken = this.base64Decode(accessToken.substring(accessToken.indexOf('.') + 1, accessToken.lastIndexOf('.')));\n\t        var decodedTokenJSON = JSON.parse(decodedToken);\n\t        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\n\t        var key = resource || scopes.join(\" \");\n\t        var token = new CachedToken(key, scopes, resource, accessToken, expiryDate);\n\t        this.tokenCache.add(token);\n\t    };\n\t    Identity.prototype.getIdToken = function () {\n\t        return this.idToken;\n\t    };\n\t    Identity.prototype.isLoggedIn = function () {\n\t        if (!this.idToken)\n\t            return false;\n\t        return (this.idToken.Expiry > new Date());\n\t    };\n\t    Identity.prototype.renewIdToken = function () {\n\t        clearTimeout(this.refreshTimer);\n\t        this.login(function () { });\n\t    };\n\t    Identity.prototype.getCurrentOauthVersion = function () {\n\t        return this.version;\n\t    };\n\t    Identity.prototype.getAccessTokenAsync = function (resource) {\n\t        var d = new promises_1.Deferred();\n\t        this.getAccessToken(resource, (function (error, token) {\n\t            if (error) {\n\t                d.reject(error);\n\t            }\n\t            else {\n\t                d.resolve(token);\n\t            }\n\t        }));\n\t        return d.promise;\n\t    };\n\t    Identity.prototype.getAccessToken = function (resource, callback) {\n\t        var _this = this;\n\t        if (this.version !== OAuthVersion.v1) {\n\t            var e = new Error();\n\t            e.statusText = \"Currently this identity class is using v2 OAuth mode. You need to use getAccessTokenForScopes() method\";\n\t            callback(e);\n\t            return;\n\t        }\n\t        var token = this.tokenCache.getForResource(resource);\n\t        if (token) {\n\t            return callback(null, token.token);\n\t        }\n\t        this.getTokenCallback = (function (token, error) {\n\t            if (error) {\n\t                callback(error);\n\t            }\n\t            else {\n\t                _this.decodeAccessToken(token, resource);\n\t                callback(null, token);\n\t            }\n\t        });\n\t        this.nonce = \"token\" + this.generateNonce();\n\t        this.state = \"token\" + this.generateNonce();\n\t        var iframe = document.createElement('iframe');\n\t        iframe.style.display = \"none\";\n\t        iframe.id = \"tokenIFrame\";\n\t        iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n\t            \"&resource=\" + encodeURIComponent(resource) +\n\t            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n\t            \"&state=\" + encodeURIComponent(this.state) +\n\t            \"&version=\" + encodeURIComponent(this.version.toString()) +\n\t            \"&nonce=\" + encodeURIComponent(this.nonce) +\n\t            \"&op=token\";\n\t        document.body.appendChild(iframe);\n\t    };\n\t    Identity.prototype.getAccessTokenForScopesAsync = function (scopes, promptForConsent) {\n\t        if (promptForConsent === void 0) { promptForConsent = false; }\n\t        var d = new promises_1.Deferred();\n\t        this.getAccessTokenForScopes(scopes, promptForConsent, function (token, error) {\n\t            if (error) {\n\t                d.reject(error);\n\t            }\n\t            else {\n\t                d.resolve(token);\n\t            }\n\t        });\n\t        return d.promise;\n\t    };\n\t    Identity.prototype.getAccessTokenForScopes = function (scopes, promptForConsent, callback) {\n\t        var _this = this;\n\t        if (promptForConsent === void 0) { promptForConsent = false; }\n\t        if (this.version !== OAuthVersion.v2) {\n\t            var e = new Error();\n\t            e.statusText = \"Dynamic scopes require v2 mode. Currently this identity class is using v1\";\n\t            callback(null, e);\n\t            return;\n\t        }\n\t        var token = this.tokenCache.getForScopes(scopes);\n\t        if (token) {\n\t            return callback(token.token, null);\n\t        }\n\t        this.getTokenCallback = (function (token, error) {\n\t            if (error) {\n\t                if (promptForConsent || !error.text) {\n\t                    callback(null, error);\n\t                }\n\t                else if (error.text.indexOf(\"AADSTS65001\") >= 0) {\n\t                    _this.getAccessTokenForScopes(scopes, true, _this.getTokenCallback);\n\t                }\n\t                else {\n\t                    callback(null, error);\n\t                }\n\t            }\n\t            else {\n\t                _this.decodeAccessToken(token, null, scopes);\n\t                callback(token, null);\n\t            }\n\t        });\n\t        this.nonce = \"token\" + this.generateNonce();\n\t        this.state = \"token\" + this.generateNonce();\n\t        if (!promptForConsent) {\n\t            var iframe = document.createElement('iframe');\n\t            iframe.style.display = \"none\";\n\t            iframe.id = \"tokenIFrame\";\n\t            iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n\t                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\n\t                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n\t                \"&version=\" + encodeURIComponent(this.version.toString()) +\n\t                \"&state=\" + encodeURIComponent(this.state) +\n\t                \"&nonce=\" + encodeURIComponent(this.nonce) +\n\t                \"&login_hint=\" + encodeURIComponent(this.idToken.PreferredUsername) +\n\t                \"&domain_hint=\" + encodeURIComponent(this.idToken.TenantId === \"9188040d-6c67-4c5b-b112-36a304b66dad\" ? \"consumers\" : \"organizations\") +\n\t                \"&op=token\";\n\t            document.body.appendChild(iframe);\n\t        }\n\t        else {\n\t            window.open(this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n\t                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\n\t                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n\t                \"&version=\" + encodeURIComponent(this.version.toString()) +\n\t                \"&state=\" + encodeURIComponent(this.state) +\n\t                \"&nonce=\" + encodeURIComponent(this.nonce) +\n\t                \"&op=token\", \"_blank\");\n\t        }\n\t    };\n\t    Identity.prototype.loginAsync = function (loginSettings) {\n\t        var d = new promises_1.Deferred();\n\t        this.login(function (error) {\n\t            if (error) {\n\t                d.reject(error);\n\t            }\n\t            else {\n\t                d.resolve(null);\n\t            }\n\t        }, loginSettings);\n\t        return d.promise;\n\t    };\n\t    Identity.prototype.login = function (callback, loginSettings) {\n\t        this.loginCallback = callback;\n\t        if (!loginSettings)\n\t            loginSettings = {};\n\t        if (loginSettings.policy)\n\t            this.policy = loginSettings.policy;\n\t        if (loginSettings.scopes && this.version === OAuthVersion.v1) {\n\t            var e = new Error();\n\t            e.text = \"Scopes can only be used with OAuth v2.\";\n\t            callback(e);\n\t            return;\n\t        }\n\t        if (loginSettings.policy && !loginSettings.tenant) {\n\t            var e = new Error();\n\t            e.text = \"In order to use policy (AAD B2C) a tenant must be specified as well.\";\n\t            callback(e);\n\t            return;\n\t        }\n\t        this.state = \"login\" + this.generateNonce();\n\t        this.nonce = \"login\" + this.generateNonce();\n\t        var loginURL = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n\t            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n\t            \"&state=\" + encodeURIComponent(this.state) +\n\t            \"&nonce=\" + encodeURIComponent(this.nonce) +\n\t            \"&version=\" + encodeURIComponent(this.version.toString()) +\n\t            \"&op=login\" +\n\t            \"&p=\" + encodeURIComponent(this.policy);\n\t        if (loginSettings.tenant) {\n\t            loginURL += \"&tenant=\" + encodeURIComponent(loginSettings.tenant);\n\t        }\n\t        if (this.version === OAuthVersion.v2) {\n\t            if (!loginSettings.scopes)\n\t                loginSettings.scopes = [];\n\t            if (loginSettings.scopes.indexOf(\"profile\") < 0)\n\t                loginSettings.scopes.push(\"profile\");\n\t            if (loginSettings.scopes.indexOf(\"openid\") < 0)\n\t                loginSettings.scopes.push(\"openid\");\n\t            loginURL += \"&scopes=\" + encodeURIComponent(loginSettings.scopes.join(\" \"));\n\t        }\n\t        window.open(loginURL, \"_blank\");\n\t    };\n\t    Identity.prototype.loginNoWindowAsync = function (toUrl) {\n\t        var d = new promises_1.Deferred();\n\t        this.loginNoWindow(function (error) {\n\t            if (error) {\n\t                d.reject(error);\n\t            }\n\t            else {\n\t                d.resolve(null);\n\t            }\n\t        }, toUrl);\n\t        return d.promise;\n\t    };\n\t    Identity.prototype.loginNoWindow = function (callback, toUrl) {\n\t        this.loginCallback = callback;\n\t        this.state = \"clientId=\" + this.clientId + \"&\" + \"tokenProcessorUrl=\" + this.tokenProcessorUrl;\n\t        this.nonce = this.generateNonce();\n\t        var redirected = this.checkForIdentityRedirect();\n\t        if (!redirected) {\n\t            var redirectUri = (toUrl) ? toUrl : window.location.href.split(\"#\")[0];\n\t            var url = \"https://login.microsoftonline.com/common/oauth2/authorize?response_type=id_token\" +\n\t                \"&client_id=\" + encodeURIComponent(this.clientId) +\n\t                \"&redirect_uri=\" + encodeURIComponent(redirectUri) +\n\t                \"&state=\" + encodeURIComponent(this.state) +\n\t                \"&nonce=\" + encodeURIComponent(this.nonce);\n\t            window.location.href = url;\n\t        }\n\t    };\n\t    Identity.prototype.logOut = function () {\n\t        this.tokenCache.clear();\n\t        var url = \"https://login.microsoftonline.com/common/oauth2/logout?post_logout_redirect_uri=\" + encodeURI(window.location.href);\n\t        window.location.href = url;\n\t    };\n\t    Identity.prototype.base64Decode = function (encodedString) {\n\t        var e = {}, i, b = 0, c, x, l = 0, a, r = '', w = String.fromCharCode, L = encodedString.length;\n\t        var A = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n\t        for (i = 0; i < 64; i++) {\n\t            e[A.charAt(i)] = i;\n\t        }\n\t        for (x = 0; x < L; x++) {\n\t            c = e[encodedString.charAt(x)];\n\t            b = (b << 6) + c;\n\t            l += 6;\n\t            while (l >= 8) {\n\t                ((a = (b >>> (l -= 8)) & 0xff) || (x < (L - 2))) && (r += w(a));\n\t            }\n\t        }\n\t        return r;\n\t    };\n\t    Identity.prototype.generateNonce = function () {\n\t        var text = \"\";\n\t        var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n\t        for (var i = 0; i < 32; i++) {\n\t            text += chars.charAt(Math.floor(Math.random() * chars.length));\n\t        }\n\t        return text;\n\t    };\n\t    return Identity;\n\t}());\n\texports.Identity = Identity;\n\n\n/***/ },\n/* 4 */\n/***/ function(module, exports, __webpack_require__) {\n\n\t\"use strict\";\n\tvar __extends = (this && this.__extends) || function (d, b) {\n\t    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n\t    function __() { this.constructor = d; }\n\t    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n\t};\n\tvar graph_1 = __webpack_require__(1);\n\tvar Scopes = (function () {\n\t    function Scopes() {\n\t    }\n\t    Scopes.rootUrl = \"https://graph.microsoft.com/\";\n\t    Scopes.General = {\n\t        OpenId: \"openid\",\n\t        OfflineAccess: \"offline_access\",\n\t    };\n\t    Scopes.User = {\n\t        Read: Scopes.rootUrl + \"User.Read\",\n\t        ReadAll: Scopes.rootUrl + \"User.Read.All\",\n\t        ReadWrite: Scopes.rootUrl + \"User.ReadWrite\",\n\t        ReadWriteAll: Scopes.rootUrl + \"User.ReadWrite.All\",\n\t        ReadBasicAll: Scopes.rootUrl + \"User.ReadBasic.All\",\n\t    };\n\t    Scopes.Contacts = {\n\t        Read: Scopes.rootUrl + \"Contacts.Read\",\n\t        ReadWrite: Scopes.rootUrl + \"Contacts.ReadWrite\",\n\t    };\n\t    Scopes.Directory = {\n\t        ReadAll: Scopes.rootUrl + \"Directory.Read.All\",\n\t        ReadWriteAll: Scopes.rootUrl + \"Directory.ReadWrite.All\",\n\t        AccessAsUserAll: Scopes.rootUrl + \"Directory.AccessAsUser.All\",\n\t    };\n\t    Scopes.Group = {\n\t        ReadAll: Scopes.rootUrl + \"Group.Read.All\",\n\t        ReadWriteAll: Scopes.rootUrl + \"Group.ReadWrite.All\",\n\t        AccessAsUserAll: Scopes.rootUrl + \"Directory.AccessAsUser.All\"\n\t    };\n\t    Scopes.Mail = {\n\t        Read: Scopes.rootUrl + \"Mail.Read\",\n\t        ReadWrite: Scopes.rootUrl + \"Mail.ReadWrite\",\n\t        Send: Scopes.rootUrl + \"Mail.Send\",\n\t    };\n\t    Scopes.Calendars = {\n\t        Read: Scopes.rootUrl + \"Calendars.Read\",\n\t        ReadWrite: Scopes.rootUrl + \"Calendars.ReadWrite\",\n\t    };\n\t    Scopes.Files = {\n\t        Read: Scopes.rootUrl + \"Files.Read\",\n\t        ReadAll: Scopes.rootUrl + \"Files.Read.All\",\n\t        ReadWrite: Scopes.rootUrl + \"Files.ReadWrite\",\n\t        ReadWriteAppFolder: Scopes.rootUrl + \"Files.ReadWrite.AppFolder\",\n\t        ReadWriteSelected: Scopes.rootUrl + \"Files.ReadWrite.Selected\",\n\t    };\n\t    Scopes.Tasks = {\n\t        ReadWrite: Scopes.rootUrl + \"Tasks.ReadWrite\",\n\t    };\n\t    Scopes.People = {\n\t        Read: Scopes.rootUrl + \"People.Read\",\n\t        ReadWrite: Scopes.rootUrl + \"People.ReadWrite\",\n\t    };\n\t    Scopes.Notes = {\n\t        Create: Scopes.rootUrl + \"Notes.Create\",\n\t        ReadWriteCreatedByApp: Scopes.rootUrl + \"Notes.ReadWrite.CreatedByApp\",\n\t        Read: Scopes.rootUrl + \"Notes.Read\",\n\t        ReadAll: Scopes.rootUrl + \"Notes.Read.All\",\n\t        ReadWriteAll: Scopes.rootUrl + \"Notes.ReadWrite.All\",\n\t    };\n\t    return Scopes;\n\t}());\n\tvar queryUnion = function (query1, query2) { return (query1 ? query1 + (query2 ? \"&\" + query2 : \"\") : query2); };\n\tvar OData = (function () {\n\t    function OData(query) {\n\t        var _this = this;\n\t        this.query = query;\n\t        this.toString = function () { return _this.query; };\n\t        this.odata = function (query) {\n\t            _this.query = queryUnion(_this.query, query);\n\t            return _this;\n\t        };\n\t        this.select = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.odata(\"$select=\" + fields.join(\",\"));\n\t        };\n\t        this.expand = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.odata(\"$expand=\" + fields.join(\",\"));\n\t        };\n\t        this.filter = function (query) { return _this.odata(\"$filter=\" + query); };\n\t        this.orderby = function () {\n\t            var fields = [];\n\t            for (var _i = 0; _i < arguments.length; _i++) {\n\t                fields[_i - 0] = arguments[_i];\n\t            }\n\t            return _this.odata(\"$orderby=\" + fields.join(\",\"));\n\t        };\n\t        this.top = function (items) { return _this.odata(\"$top=\" + items); };\n\t        this.skip = function (items) { return _this.odata(\"$skip=\" + items); };\n\t    }\n\t    return OData;\n\t}());\n\texports.OData = OData;\n\tvar pathWithQuery = function (path, odataQuery) {\n\t    var query = odataQuery && odataQuery.toString();\n\t    return path + (query ? \"?\" + query : \"\");\n\t};\n\tvar Singleton = (function () {\n\t    function Singleton(raw, self) {\n\t        this.raw = raw;\n\t        this.self = self;\n\t    }\n\t    Object.defineProperty(Singleton.prototype, \"item\", {\n\t        get: function () {\n\t            return this.raw;\n\t        },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    return Singleton;\n\t}());\n\texports.Singleton = Singleton;\n\tvar Collection = (function () {\n\t    function Collection(raw, self, next) {\n\t        this.raw = raw;\n\t        this.self = self;\n\t        this.next = next;\n\t        var nextLink = this.raw[\"@odata.nextLink\"];\n\t        if (nextLink) {\n\t            this.next.nextLink = nextLink;\n\t        }\n\t        else {\n\t            this.next = undefined;\n\t        }\n\t    }\n\t    Object.defineProperty(Collection.prototype, \"items\", {\n\t        get: function () {\n\t            return (this.raw.value ? this.raw.value : [this.raw]);\n\t        },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    return Collection;\n\t}());\n\texports.Collection = Collection;\n\tvar Node = (function () {\n\t    function Node(graph, path) {\n\t        var _this = this;\n\t        this.graph = graph;\n\t        this.path = path;\n\t        this.pathWithQuery = function (odataQuery, pathSuffix) {\n\t            if (pathSuffix === void 0) { pathSuffix = \"\"; }\n\t            return pathWithQuery(_this.path + pathSuffix, odataQuery);\n\t        };\n\t    }\n\t    return Node;\n\t}());\n\texports.Node = Node;\n\tvar CollectionNode = (function (_super) {\n\t    __extends(CollectionNode, _super);\n\t    function CollectionNode() {\n\t        var _this = this;\n\t        _super.apply(this, arguments);\n\t        this.pathWithQuery = function (odataQuery, pathSuffix) {\n\t            if (pathSuffix === void 0) { pathSuffix = \"\"; }\n\t            return _this._nextLink || pathWithQuery(_this.path + pathSuffix, odataQuery);\n\t        };\n\t    }\n\t    Object.defineProperty(CollectionNode.prototype, \"nextLink\", {\n\t        set: function (pathWithQuery) {\n\t            this._nextLink = pathWithQuery;\n\t        },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    return CollectionNode;\n\t}(Node));\n\texports.CollectionNode = CollectionNode;\n\tvar Attachment = (function (_super) {\n\t    __extends(Attachment, _super);\n\t    function Attachment(graph, path, context, attachmentId) {\n\t        var _this = this;\n\t        if (path === void 0) { path = \"\"; }\n\t        _super.call(this, graph, path + (attachmentId ? \"/\" + attachmentId : \"\"));\n\t        this.context = context;\n\t        this.GetAttachment = function (odataQuery) { return _this.graph.Get(_this.pathWithQuery(odataQuery), _this, Attachment.scopes[_this.context]); };\n\t    }\n\t    Attachment.scopes = {\n\t        messages: [Scopes.Mail.Read],\n\t        events: [Scopes.Calendars.Read],\n\t    };\n\t    return Attachment;\n\t}(Node));\n\texports.Attachment = Attachment;\n\tvar Attachments = (function (_super) {\n\t    __extends(Attachments, _super);\n\t    function Attachments(graph, path, context) {\n\t        var _this = this;\n\t        if (path === void 0) { path = \"\"; }\n\t        _super.call(this, graph, path + \"/attachments\");\n\t        this.context = context;\n\t        this.$ = function (attachmentId) { return new Attachment(_this.graph, _this.path, _this.context, attachmentId); };\n\t        this.GetAttachments = function (odataQuery) { return _this.graph.GetCollection(_this.pathWithQuery(odataQuery), _this, new Attachments(_this.graph, null, _this.context), Attachment.scopes[_this.context]); };\n\t    }\n\t    return Attachments;\n\t}(CollectionNode));\n\texports.Attachments = Attachments;\n\tvar Message = (function (_super) {\n\t    __extends(Message, _super);\n\t    function Message(graph, path, messageId) {\n\t        var _this = this;\n\t        if (path === void 0) { path = \"\"; }\n\t        _super.call(this, graph, path + (messageId ? \"/\" + messageId : \"\"));\n\t        this.GetMessage = function (odataQuery) { return _this.graph.Get(_this.pathWithQuery(odataQuery), _this, [Scopes.Mail.Read]); };\n\t        this.SendMessage = function (odataQuery) { return _this.graph.Post(null, _this.pathWithQuery(odataQuery, \"/microsoft.graph.sendMail\"), _this, [Scopes.Mail.Send]); };\n\t    }\n\t    Object.defineProperty(Message.prototype, \"attachments\", {\n\t        get: function () { return new Attachments(this.graph, this.path, \"messages\"); },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    return Message;\n\t}(Node));\n\texports.Message = Message;\n\tvar Messages = (function (_super) {\n\t    __extends(Messages, _super);\n\t    function Messages(graph, path) {\n\t        var _this = this;\n\t        if (path === void 0) { path = \"\"; }\n\t        _super.call(this, graph, path + \"/messages\");\n\t        this.$ = function (messageId) { return new Message(_this.graph, _this.path, messageId); };\n\t        this.GetMessages = function (odataQuery) { return _this.graph.GetCollection(_this.pathWithQuery(odataQuery), _this, new Messages(_this.graph), [Scopes.Mail.Read, Scopes.Mail.ReadWrite]); };\n\t        this.CreateMessage = function (object, odataQuery) { return _this.graph.Post(object, _this.pathWithQuery(odataQuery), _this, [Scopes.Mail.ReadWrite]); };\n\t    }\n\t    return Messages;\n\t}(CollectionNode));\n\texports.Messages = Messages;\n\tvar Event = (function (_super) {\n\t    __extends(Event, _super);\n\t    function Event(graph, path, eventId) {\n\t        var _this = this;\n\t        if (path === void 0) { path = \"\"; }\n\t        _super.call(this, graph, path + (eventId ? \"/\" + eventId : \"\"));\n\t        this.GetEvent = function (odataQuery) { return _this.graph.Get(_this.pathWithQuery(odataQuery), _this, [Scopes.Calendars.Read]); };\n\t    }\n\t    Object.defineProperty(Event.prototype, \"attachments\", {\n\t        get: function () { return new Attachments(this.graph, this.path, \"events\"); },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    return Event;\n\t}(Node));\n\texports.Event = Event;\n\tvar eventsScopes = [Scopes.Calendars.Read, Scopes.Calendars.ReadWrite];\n\tvar Events = (function (_super) {\n\t    __extends(Events, _super);\n\t    function Events(graph, path) {\n\t        var _this = this;\n\t        if (path === void 0) { path = \"\"; }\n\t        _super.call(this, graph, path + \"/events\");\n\t        this.$ = function (eventId) { return new Event(_this.graph, _this.path, eventId); };\n\t        this.GetEvents = function (odataQuery) { return _this.graph.GetCollection(_this.pathWithQuery(odataQuery), _this, new Events(_this.graph), eventsScopes); };\n\t    }\n\t    return Events;\n\t}(CollectionNode));\n\texports.Events = Events;\n\tvar CalendarView = (function (_super) {\n\t    __extends(CalendarView, _super);\n\t    function CalendarView(graph, path) {\n\t        var _this = this;\n\t        if (path === void 0) { path = \"\"; }\n\t        _super.call(this, graph, path + \"/calendarView\");\n\t        this.dateRange = function (startDate, endDate) { return (\"startDateTime=\" + startDate.toISOString() + \"&endDateTime=\" + endDate.toISOString()); };\n\t        this.GetCalendarView = function (odataQuery) { return _this.graph.GetCollection(_this.pathWithQuery(odataQuery), _this, new CalendarView(_this.graph), eventsScopes); };\n\t    }\n\t    return CalendarView;\n\t}(CollectionNode));\n\texports.CalendarView = CalendarView;\n\tvar mailFolderScopes = [Scopes.Mail.Read, Scopes.Mail.ReadWrite];\n\tvar MailFolder = (function (_super) {\n\t    __extends(MailFolder, _super);\n\t    function MailFolder(graph, path, mailFolderId) {\n\t        var _this = this;\n\t        if (path === void 0) { path = \"\"; }\n\t        _super.call(this, graph, path + (mailFolderId ? \"/\" + mailFolderId : \"\"));\n\t        this.GetMailFolder = function (odataQuery) { return _this.graph.Get(_this.pathWithQuery(odataQuery), _this, mailFolderScopes); };\n\t    }\n\t    return MailFolder;\n\t}(Node));\n\texports.MailFolder = MailFolder;\n\tvar MailFolders = (function (_super) {\n\t    __extends(MailFolders, _super);\n\t    function MailFolders(graph, path) {\n\t        var _this = this;\n\t        if (path === void 0) { path = \"\"; }\n\t        _super.call(this, graph, path + \"/mailFolders\");\n\t        this.$ = function (mailFolderId) { return new MailFolder(_this.graph, _this.path, mailFolderId); };\n\t        this.GetMailFolders = function (odataQuery) { return _this.graph.GetCollection(_this.pathWithQuery(odataQuery), _this, new MailFolders(_this.graph), mailFolderScopes); };\n\t    }\n\t    return MailFolders;\n\t}(CollectionNode));\n\texports.MailFolders = MailFolders;\n\tvar usersScopes = [Scopes.User.ReadBasicAll, Scopes.User.ReadAll, Scopes.User.ReadWriteAll, Scopes.Directory.ReadAll, Scopes.Directory.ReadWriteAll, Scopes.Directory.AccessAsUserAll];\n\tvar userScopes = usersScopes.concat([Scopes.User.Read, Scopes.User.ReadWrite]);\n\tvar User = (function (_super) {\n\t    __extends(User, _super);\n\t    function User(graph, path, userId) {\n\t        var _this = this;\n\t        if (path === void 0) { path = \"\"; }\n\t        _super.call(this, graph, userId ? path + \"/\" + userId : path + \"/me\");\n\t        this.graph = graph;\n\t        this.GetUser = function (odataQuery) { return _this.graph.Get(_this.pathWithQuery(odataQuery), _this, userScopes); };\n\t        console.log(\"Graph.foo\", graph_1.Graph.foo);\n\t    }\n\t    Object.defineProperty(User.prototype, \"messages\", {\n\t        get: function () { return new Messages(this.graph, this.path); },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    Object.defineProperty(User.prototype, \"events\", {\n\t        get: function () { return new Events(this.graph, this.path); },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    Object.defineProperty(User.prototype, \"calendarView\", {\n\t        get: function () { return new CalendarView(this.graph, this.path); },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    Object.defineProperty(User.prototype, \"mailFolders\", {\n\t        get: function () { return new MailFolders(this.graph, this.path); },\n\t        enumerable: true,\n\t        configurable: true\n\t    });\n\t    return User;\n\t}(Node));\n\texports.User = User;\n\tvar Users = (function (_super) {\n\t    __extends(Users, _super);\n\t    function Users(graph, path) {\n\t        var _this = this;\n\t        if (path === void 0) { path = \"\"; }\n\t        _super.call(this, graph, path + \"/users\");\n\t        this.$ = function (userId) { return new User(_this.graph, _this.path, userId); };\n\t        this.GetUsers = function (odataQuery) { return _this.graph.GetCollection(_this.pathWithQuery(odataQuery), _this, new Users(_this.graph), userScopes); };\n\t    }\n\t    return Users;\n\t}(CollectionNode));\n\texports.Users = Users;\n\n\n/***/ }\n/******/ ])\n});\n;\n\n\n/** WEBPACK FOOTER **\n ** dist/kurve.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap d68a24e8a94a953e1e13\n **/","\"use strict\";\nfunction __export(m) {\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\n}\n__export(require(\"./graph\"));\n__export(require(\"./identity\"));\n__export(require(\"./requestbuilder\"));\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/kurve.ts\n ** module id = 0\n ** module chunks = 0\n **/","\"use strict\";\nvar promises_1 = require(\"./promises\");\nvar identity_1 = require(\"./identity\");\nvar requestbuilder_1 = require(\"./requestbuilder\");\nvar Graph = (function () {\n    function Graph(identityInfo) {\n        this.req = null;\n        this.accessToken = null;\n        this.KurveIdentity = null;\n        this.defaultResourceID = \"https://graph.microsoft.com\";\n        this.baseUrl = \"https://graph.microsoft.com/v1.0\";\n        if (identityInfo.defaultAccessToken) {\n            this.accessToken = identityInfo.defaultAccessToken;\n        }\n        else {\n            this.KurveIdentity = identityInfo.identity;\n        }\n    }\n    Object.defineProperty(Graph.prototype, \"me\", {\n        get: function () { return new requestbuilder_1.User(this, this.baseUrl); },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(Graph.prototype, \"users\", {\n        get: function () { return new requestbuilder_1.Users(this, this.baseUrl); },\n        enumerable: true,\n        configurable: true\n    });\n    Graph.prototype.Get = function (path, self, scopes) {\n        console.log(\"GET\", path, scopes);\n        var d = new promises_1.Deferred();\n        this.get(path, function (error, result) {\n            var jsonResult = JSON.parse(result);\n            if (jsonResult.error) {\n                var errorODATA = new identity_1.Error();\n                errorODATA.other = jsonResult.error;\n                d.reject(errorODATA);\n                return;\n            }\n            d.resolve(new requestbuilder_1.Singleton(jsonResult, self));\n        });\n        return d.promise;\n    };\n    Graph.prototype.GetCollection = function (path, self, next, scopes) {\n        console.log(\"GET collection\", path, scopes);\n        var d = new promises_1.Deferred();\n        this.get(path, function (error, result) {\n            var jsonResult = JSON.parse(result);\n            if (jsonResult.error) {\n                var errorODATA = new identity_1.Error();\n                errorODATA.other = jsonResult.error;\n                d.reject(errorODATA);\n                return;\n            }\n            d.resolve(new requestbuilder_1.Collection(jsonResult, self, next));\n        });\n        return d.promise;\n    };\n    Graph.prototype.Post = function (object, path, self, scopes) {\n        console.log(\"POST\", path, scopes);\n        var d = new promises_1.Deferred();\n        return d.promise;\n    };\n    Graph.prototype.scopesForV2 = function (scopes) {\n        if (!this.KurveIdentity)\n            return null;\n        if (this.KurveIdentity.getCurrentOauthVersion() === identity_1.OAuthVersion.v1)\n            return null;\n        else\n            return scopes;\n    };\n    Graph.prototype.get = function (url, callback, responseType, scopes) {\n        var _this = this;\n        var xhr = new XMLHttpRequest();\n        if (responseType)\n            xhr.responseType = responseType;\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4)\n                if (xhr.status === 200)\n                    callback(null, responseType ? xhr.response : xhr.responseText);\n                else\n                    callback(_this.generateError(xhr));\n        };\n        xhr.open(\"GET\", url);\n        this.addAccessTokenAndSend(xhr, function (addTokenError) {\n            if (addTokenError) {\n                callback(addTokenError);\n            }\n        }, scopes);\n    };\n    Graph.prototype.post = function (object, url, callback, responseType, scopes) {\n        var _this = this;\n        var xhr = new XMLHttpRequest();\n        if (responseType)\n            xhr.responseType = responseType;\n        xhr.onreadystatechange = function () {\n            if (xhr.readyState === 4)\n                if (xhr.status === 202)\n                    callback(null, responseType ? xhr.response : xhr.responseText);\n                else\n                    callback(_this.generateError(xhr));\n        };\n        xhr.send(object);\n        xhr.open(\"GET\", url);\n        this.addAccessTokenAndSend(xhr, function (addTokenError) {\n            if (addTokenError) {\n                callback(addTokenError);\n            }\n        }, scopes);\n    };\n    Graph.prototype.generateError = function (xhr) {\n        var response = new identity_1.Error();\n        response.status = xhr.status;\n        response.statusText = xhr.statusText;\n        if (xhr.responseType === '' || xhr.responseType === 'text')\n            response.text = xhr.responseText;\n        else\n            response.other = xhr.response;\n        return response;\n    };\n    Graph.prototype.addAccessTokenAndSend = function (xhr, callback, scopes) {\n        if (this.accessToken) {\n            xhr.setRequestHeader('Authorization', 'Bearer ' + this.accessToken);\n            xhr.send();\n        }\n        else {\n            if (scopes) {\n                this.KurveIdentity.getAccessTokenForScopes(scopes, false, (function (token, error) {\n                    if (error)\n                        callback(error);\n                    else {\n                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\n                        xhr.send();\n                        callback(null);\n                    }\n                }));\n            }\n            else {\n                this.KurveIdentity.getAccessToken(this.defaultResourceID, (function (error, token) {\n                    if (error)\n                        callback(error);\n                    else {\n                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\n                        xhr.send();\n                        callback(null);\n                    }\n                }));\n            }\n        }\n    };\n    Graph.foo = function () { return \"test\"; };\n    return Graph;\n}());\nexports.Graph = Graph;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/graph.ts\n ** module id = 1\n ** module chunks = 0\n **/","\"use strict\";\nfunction DispatchDeferred(closure) {\n    setTimeout(closure, 0);\n}\nvar PromiseState;\n(function (PromiseState) {\n    PromiseState[PromiseState[\"Pending\"] = 0] = \"Pending\";\n    PromiseState[PromiseState[\"ResolutionInProgress\"] = 1] = \"ResolutionInProgress\";\n    PromiseState[PromiseState[\"Resolved\"] = 2] = \"Resolved\";\n    PromiseState[PromiseState[\"Rejected\"] = 3] = \"Rejected\";\n})(PromiseState || (PromiseState = {}));\nvar Client = (function () {\n    function Client(_dispatcher, _successCB, _errorCB) {\n        this._dispatcher = _dispatcher;\n        this._successCB = _successCB;\n        this._errorCB = _errorCB;\n        this.result = new Deferred(_dispatcher);\n    }\n    Client.prototype.resolve = function (value, defer) {\n        var _this = this;\n        if (typeof (this._successCB) !== 'function') {\n            this.result.resolve(value);\n            return;\n        }\n        if (defer) {\n            this._dispatcher(function () { return _this._dispatchCallback(_this._successCB, value); });\n        }\n        else {\n            this._dispatchCallback(this._successCB, value);\n        }\n    };\n    Client.prototype.reject = function (error, defer) {\n        var _this = this;\n        if (typeof (this._errorCB) !== 'function') {\n            this.result.reject(error);\n            return;\n        }\n        if (defer) {\n            this._dispatcher(function () { return _this._dispatchCallback(_this._errorCB, error); });\n        }\n        else {\n            this._dispatchCallback(this._errorCB, error);\n        }\n    };\n    Client.prototype._dispatchCallback = function (callback, arg) {\n        var result, then, type;\n        try {\n            result = callback(arg);\n            this.result.resolve(result);\n        }\n        catch (err) {\n            this.result.reject(err);\n            return;\n        }\n    };\n    return Client;\n}());\nvar Deferred = (function () {\n    function Deferred(dispatcher) {\n        this._stack = [];\n        this._state = PromiseState.Pending;\n        if (dispatcher)\n            this._dispatcher = dispatcher;\n        else\n            this._dispatcher = DispatchDeferred;\n        this.promise = new Promise(this);\n    }\n    Deferred.prototype.DispatchDeferred = function (closure) {\n        setTimeout(closure, 0);\n    };\n    Deferred.prototype.then = function (successCB, errorCB) {\n        if (typeof (successCB) !== 'function' && typeof (errorCB) !== 'function') {\n            return this.promise;\n        }\n        var client = new Client(this._dispatcher, successCB, errorCB);\n        switch (this._state) {\n            case PromiseState.Pending:\n            case PromiseState.ResolutionInProgress:\n                this._stack.push(client);\n                break;\n            case PromiseState.Resolved:\n                client.resolve(this._value, true);\n                break;\n            case PromiseState.Rejected:\n                client.reject(this._error, true);\n                break;\n        }\n        return client.result.promise;\n    };\n    Deferred.prototype.resolve = function (value) {\n        if (this._state !== PromiseState.Pending) {\n            return this;\n        }\n        return this._resolve(value);\n    };\n    Deferred.prototype._resolve = function (value) {\n        var _this = this;\n        var type = typeof (value), then, pending = true;\n        try {\n            if (value !== null &&\n                (type === 'object' || type === 'function') &&\n                typeof (then = value.then) === 'function') {\n                if (value === this.promise) {\n                    throw new TypeError('recursive resolution');\n                }\n                this._state = PromiseState.ResolutionInProgress;\n                then.call(value, function (result) {\n                    if (pending) {\n                        pending = false;\n                        _this._resolve(result);\n                    }\n                }, function (error) {\n                    if (pending) {\n                        pending = false;\n                        _this._reject(error);\n                    }\n                });\n            }\n            else {\n                this._state = PromiseState.ResolutionInProgress;\n                this._dispatcher(function () {\n                    _this._state = PromiseState.Resolved;\n                    _this._value = value;\n                    var i, stackSize = _this._stack.length;\n                    for (i = 0; i < stackSize; i++) {\n                        _this._stack[i].resolve(value, false);\n                    }\n                    _this._stack.splice(0, stackSize);\n                });\n            }\n        }\n        catch (err) {\n            if (pending) {\n                this._reject(err);\n            }\n        }\n        return this;\n    };\n    Deferred.prototype.reject = function (error) {\n        if (this._state !== PromiseState.Pending) {\n            return this;\n        }\n        return this._reject(error);\n    };\n    Deferred.prototype._reject = function (error) {\n        var _this = this;\n        this._state = PromiseState.ResolutionInProgress;\n        this._dispatcher(function () {\n            _this._state = PromiseState.Rejected;\n            _this._error = error;\n            var stackSize = _this._stack.length, i = 0;\n            for (i = 0; i < stackSize; i++) {\n                _this._stack[i].reject(error, false);\n            }\n            _this._stack.splice(0, stackSize);\n        });\n        return this;\n    };\n    return Deferred;\n}());\nexports.Deferred = Deferred;\nvar Promise = (function () {\n    function Promise(_deferred) {\n        this._deferred = _deferred;\n    }\n    Promise.prototype.then = function (successCallback, errorCallback) {\n        return this._deferred.then(successCallback, errorCallback);\n    };\n    Promise.prototype.fail = function (errorCallback) {\n        return this._deferred.then(undefined, errorCallback);\n    };\n    return Promise;\n}());\nexports.Promise = Promise;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/promises.ts\n ** module id = 2\n ** module chunks = 0\n **/","\"use strict\";\nvar promises_1 = require(\"./promises\");\n(function (OAuthVersion) {\n    OAuthVersion[OAuthVersion[\"v1\"] = 1] = \"v1\";\n    OAuthVersion[OAuthVersion[\"v2\"] = 2] = \"v2\";\n})(exports.OAuthVersion || (exports.OAuthVersion = {}));\nvar OAuthVersion = exports.OAuthVersion;\nvar Error = (function () {\n    function Error() {\n    }\n    return Error;\n}());\nexports.Error = Error;\nvar CachedToken = (function () {\n    function CachedToken(id, scopes, resource, token, expiry) {\n        this.id = id;\n        this.scopes = scopes;\n        this.resource = resource;\n        this.token = token;\n        this.expiry = expiry;\n    }\n    ;\n    Object.defineProperty(CachedToken.prototype, \"isExpired\", {\n        get: function () {\n            return this.expiry <= new Date(new Date().getTime() + 60000);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    CachedToken.prototype.hasScopes = function (requiredScopes) {\n        var _this = this;\n        if (!this.scopes) {\n            return false;\n        }\n        return requiredScopes.every(function (requiredScope) {\n            return _this.scopes.some(function (actualScope) { return requiredScope === actualScope; });\n        });\n    };\n    return CachedToken;\n}());\nvar TokenCache = (function () {\n    function TokenCache(tokenStorage) {\n        var _this = this;\n        this.tokenStorage = tokenStorage;\n        this.cachedTokens = {};\n        if (tokenStorage) {\n            tokenStorage.getAll().forEach(function (_a) {\n                var id = _a.id, scopes = _a.scopes, resource = _a.resource, token = _a.token, expiry = _a.expiry;\n                var cachedToken = new CachedToken(id, scopes, resource, token, new Date(expiry));\n                if (cachedToken.isExpired) {\n                    _this.tokenStorage.remove(cachedToken.id);\n                }\n                else {\n                    _this.cachedTokens[cachedToken.id] = cachedToken;\n                }\n            });\n        }\n    }\n    TokenCache.prototype.add = function (token) {\n        this.cachedTokens[token.id] = token;\n        this.tokenStorage && this.tokenStorage.add(token.id, token);\n    };\n    TokenCache.prototype.getForResource = function (resource) {\n        var cachedToken = this.cachedTokens[resource];\n        if (cachedToken && cachedToken.isExpired) {\n            this.remove(resource);\n            return null;\n        }\n        return cachedToken;\n    };\n    TokenCache.prototype.getForScopes = function (scopes) {\n        for (var key in this.cachedTokens) {\n            var cachedToken = this.cachedTokens[key];\n            if (cachedToken.hasScopes(scopes)) {\n                if (cachedToken.isExpired) {\n                    this.remove(key);\n                }\n                else {\n                    return cachedToken;\n                }\n            }\n        }\n        return null;\n    };\n    TokenCache.prototype.clear = function () {\n        this.cachedTokens = {};\n        this.tokenStorage && this.tokenStorage.clear();\n    };\n    TokenCache.prototype.remove = function (key) {\n        this.tokenStorage && this.tokenStorage.remove(key);\n        delete this.cachedTokens[key];\n    };\n    return TokenCache;\n}());\nvar IdToken = (function () {\n    function IdToken() {\n    }\n    return IdToken;\n}());\nexports.IdToken = IdToken;\nvar Identity = (function () {\n    function Identity(identitySettings) {\n        var _this = this;\n        this.policy = \"\";\n        this.clientId = identitySettings.clientId;\n        this.tokenProcessorUrl = identitySettings.tokenProcessingUri;\n        if (identitySettings.version)\n            this.version = identitySettings.version;\n        else\n            this.version = OAuthVersion.v1;\n        this.tokenCache = new TokenCache(identitySettings.tokenStorage);\n        window.addEventListener(\"message\", function (event) {\n            if (event.data.type === \"id_token\") {\n                if (event.data.error) {\n                    var e = new Error();\n                    e.text = event.data.error;\n                    _this.loginCallback(e);\n                }\n                else {\n                    if (_this.state !== event.data.state) {\n                        var error = new Error();\n                        error.statusText = \"Invalid state\";\n                        _this.loginCallback(error);\n                    }\n                    else {\n                        _this.decodeIdToken(event.data.token);\n                        _this.loginCallback(null);\n                    }\n                }\n            }\n            else if (event.data.type === \"access_token\") {\n                if (event.data.error) {\n                    var e = new Error();\n                    e.text = event.data.error;\n                    _this.getTokenCallback(null, e);\n                }\n                else {\n                    var token = event.data.token;\n                    var iframe = document.getElementById(\"tokenIFrame\");\n                    iframe.parentNode.removeChild(iframe);\n                    if (event.data.state !== _this.state) {\n                        var error = new Error();\n                        error.statusText = \"Invalid state\";\n                        _this.getTokenCallback(null, error);\n                    }\n                    else {\n                        _this.getTokenCallback(token, null);\n                    }\n                }\n            }\n        });\n    }\n    Identity.prototype.checkForIdentityRedirect = function () {\n        function token(s) {\n            var start = window.location.href.indexOf(s);\n            if (start < 0)\n                return null;\n            var end = window.location.href.indexOf(\"&\", start + s.length);\n            return window.location.href.substring(start, ((end > 0) ? end : window.location.href.length));\n        }\n        function parseQueryString(str) {\n            var queryString = str || window.location.search || '';\n            var keyValPairs = [];\n            var params = {};\n            queryString = queryString.replace(/.*?\\?/, \"\");\n            if (queryString.length) {\n                keyValPairs = queryString.split('&');\n                for (var pairNum in keyValPairs) {\n                    var key = keyValPairs[pairNum].split('=')[0];\n                    if (!key.length)\n                        continue;\n                    if (typeof params[key] === 'undefined')\n                        params[key] = [];\n                    params[key].push(keyValPairs[pairNum].split('=')[1]);\n                }\n            }\n            return params;\n        }\n        var params = parseQueryString(window.location.href);\n        var idToken = token(\"#id_token=\");\n        var accessToken = token(\"#access_token\");\n        if (idToken) {\n            if (true || this.state === params[\"state\"][0]) {\n                this.decodeIdToken(idToken);\n                this.loginCallback && this.loginCallback(null);\n            }\n            else {\n                var error = new Error();\n                error.statusText = \"Invalid state\";\n                this.loginCallback && this.loginCallback(error);\n            }\n            return true;\n        }\n        else if (accessToken) {\n            throw \"Should not get here.  This should be handled via the iframe approach.\";\n        }\n        return false;\n    };\n    Identity.prototype.decodeIdToken = function (idToken) {\n        var _this = this;\n        var decodedToken = this.base64Decode(idToken.substring(idToken.indexOf('.') + 1, idToken.lastIndexOf('.')));\n        var decodedTokenJSON = JSON.parse(decodedToken);\n        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\n        this.idToken = new IdToken();\n        this.idToken.FullToken = decodedTokenJSON;\n        this.idToken.Token = idToken;\n        this.idToken.Expiry = expiryDate;\n        this.idToken.UPN = decodedTokenJSON.upn;\n        this.idToken.TenantId = decodedTokenJSON.tid;\n        this.idToken.FamilyName = decodedTokenJSON.family_name;\n        this.idToken.GivenName = decodedTokenJSON.given_name;\n        this.idToken.Name = decodedTokenJSON.name;\n        this.idToken.PreferredUsername = decodedTokenJSON.preferred_username;\n        var expiration = expiryDate.getTime() - new Date().getTime() - 300000;\n        this.refreshTimer = setTimeout((function () {\n            _this.renewIdToken();\n        }), expiration);\n    };\n    Identity.prototype.decodeAccessToken = function (accessToken, resource, scopes) {\n        var decodedToken = this.base64Decode(accessToken.substring(accessToken.indexOf('.') + 1, accessToken.lastIndexOf('.')));\n        var decodedTokenJSON = JSON.parse(decodedToken);\n        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\n        var key = resource || scopes.join(\" \");\n        var token = new CachedToken(key, scopes, resource, accessToken, expiryDate);\n        this.tokenCache.add(token);\n    };\n    Identity.prototype.getIdToken = function () {\n        return this.idToken;\n    };\n    Identity.prototype.isLoggedIn = function () {\n        if (!this.idToken)\n            return false;\n        return (this.idToken.Expiry > new Date());\n    };\n    Identity.prototype.renewIdToken = function () {\n        clearTimeout(this.refreshTimer);\n        this.login(function () { });\n    };\n    Identity.prototype.getCurrentOauthVersion = function () {\n        return this.version;\n    };\n    Identity.prototype.getAccessTokenAsync = function (resource) {\n        var d = new promises_1.Deferred();\n        this.getAccessToken(resource, (function (error, token) {\n            if (error) {\n                d.reject(error);\n            }\n            else {\n                d.resolve(token);\n            }\n        }));\n        return d.promise;\n    };\n    Identity.prototype.getAccessToken = function (resource, callback) {\n        var _this = this;\n        if (this.version !== OAuthVersion.v1) {\n            var e = new Error();\n            e.statusText = \"Currently this identity class is using v2 OAuth mode. You need to use getAccessTokenForScopes() method\";\n            callback(e);\n            return;\n        }\n        var token = this.tokenCache.getForResource(resource);\n        if (token) {\n            return callback(null, token.token);\n        }\n        this.getTokenCallback = (function (token, error) {\n            if (error) {\n                callback(error);\n            }\n            else {\n                _this.decodeAccessToken(token, resource);\n                callback(null, token);\n            }\n        });\n        this.nonce = \"token\" + this.generateNonce();\n        this.state = \"token\" + this.generateNonce();\n        var iframe = document.createElement('iframe');\n        iframe.style.display = \"none\";\n        iframe.id = \"tokenIFrame\";\n        iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n            \"&resource=\" + encodeURIComponent(resource) +\n            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n            \"&state=\" + encodeURIComponent(this.state) +\n            \"&version=\" + encodeURIComponent(this.version.toString()) +\n            \"&nonce=\" + encodeURIComponent(this.nonce) +\n            \"&op=token\";\n        document.body.appendChild(iframe);\n    };\n    Identity.prototype.getAccessTokenForScopesAsync = function (scopes, promptForConsent) {\n        if (promptForConsent === void 0) { promptForConsent = false; }\n        var d = new promises_1.Deferred();\n        this.getAccessTokenForScopes(scopes, promptForConsent, function (token, error) {\n            if (error) {\n                d.reject(error);\n            }\n            else {\n                d.resolve(token);\n            }\n        });\n        return d.promise;\n    };\n    Identity.prototype.getAccessTokenForScopes = function (scopes, promptForConsent, callback) {\n        var _this = this;\n        if (promptForConsent === void 0) { promptForConsent = false; }\n        if (this.version !== OAuthVersion.v2) {\n            var e = new Error();\n            e.statusText = \"Dynamic scopes require v2 mode. Currently this identity class is using v1\";\n            callback(null, e);\n            return;\n        }\n        var token = this.tokenCache.getForScopes(scopes);\n        if (token) {\n            return callback(token.token, null);\n        }\n        this.getTokenCallback = (function (token, error) {\n            if (error) {\n                if (promptForConsent || !error.text) {\n                    callback(null, error);\n                }\n                else if (error.text.indexOf(\"AADSTS65001\") >= 0) {\n                    _this.getAccessTokenForScopes(scopes, true, _this.getTokenCallback);\n                }\n                else {\n                    callback(null, error);\n                }\n            }\n            else {\n                _this.decodeAccessToken(token, null, scopes);\n                callback(token, null);\n            }\n        });\n        this.nonce = \"token\" + this.generateNonce();\n        this.state = \"token\" + this.generateNonce();\n        if (!promptForConsent) {\n            var iframe = document.createElement('iframe');\n            iframe.style.display = \"none\";\n            iframe.id = \"tokenIFrame\";\n            iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\n                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n                \"&version=\" + encodeURIComponent(this.version.toString()) +\n                \"&state=\" + encodeURIComponent(this.state) +\n                \"&nonce=\" + encodeURIComponent(this.nonce) +\n                \"&login_hint=\" + encodeURIComponent(this.idToken.PreferredUsername) +\n                \"&domain_hint=\" + encodeURIComponent(this.idToken.TenantId === \"9188040d-6c67-4c5b-b112-36a304b66dad\" ? \"consumers\" : \"organizations\") +\n                \"&op=token\";\n            document.body.appendChild(iframe);\n        }\n        else {\n            window.open(this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\n                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n                \"&version=\" + encodeURIComponent(this.version.toString()) +\n                \"&state=\" + encodeURIComponent(this.state) +\n                \"&nonce=\" + encodeURIComponent(this.nonce) +\n                \"&op=token\", \"_blank\");\n        }\n    };\n    Identity.prototype.loginAsync = function (loginSettings) {\n        var d = new promises_1.Deferred();\n        this.login(function (error) {\n            if (error) {\n                d.reject(error);\n            }\n            else {\n                d.resolve(null);\n            }\n        }, loginSettings);\n        return d.promise;\n    };\n    Identity.prototype.login = function (callback, loginSettings) {\n        this.loginCallback = callback;\n        if (!loginSettings)\n            loginSettings = {};\n        if (loginSettings.policy)\n            this.policy = loginSettings.policy;\n        if (loginSettings.scopes && this.version === OAuthVersion.v1) {\n            var e = new Error();\n            e.text = \"Scopes can only be used with OAuth v2.\";\n            callback(e);\n            return;\n        }\n        if (loginSettings.policy && !loginSettings.tenant) {\n            var e = new Error();\n            e.text = \"In order to use policy (AAD B2C) a tenant must be specified as well.\";\n            callback(e);\n            return;\n        }\n        this.state = \"login\" + this.generateNonce();\n        this.nonce = \"login\" + this.generateNonce();\n        var loginURL = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\n            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\n            \"&state=\" + encodeURIComponent(this.state) +\n            \"&nonce=\" + encodeURIComponent(this.nonce) +\n            \"&version=\" + encodeURIComponent(this.version.toString()) +\n            \"&op=login\" +\n            \"&p=\" + encodeURIComponent(this.policy);\n        if (loginSettings.tenant) {\n            loginURL += \"&tenant=\" + encodeURIComponent(loginSettings.tenant);\n        }\n        if (this.version === OAuthVersion.v2) {\n            if (!loginSettings.scopes)\n                loginSettings.scopes = [];\n            if (loginSettings.scopes.indexOf(\"profile\") < 0)\n                loginSettings.scopes.push(\"profile\");\n            if (loginSettings.scopes.indexOf(\"openid\") < 0)\n                loginSettings.scopes.push(\"openid\");\n            loginURL += \"&scopes=\" + encodeURIComponent(loginSettings.scopes.join(\" \"));\n        }\n        window.open(loginURL, \"_blank\");\n    };\n    Identity.prototype.loginNoWindowAsync = function (toUrl) {\n        var d = new promises_1.Deferred();\n        this.loginNoWindow(function (error) {\n            if (error) {\n                d.reject(error);\n            }\n            else {\n                d.resolve(null);\n            }\n        }, toUrl);\n        return d.promise;\n    };\n    Identity.prototype.loginNoWindow = function (callback, toUrl) {\n        this.loginCallback = callback;\n        this.state = \"clientId=\" + this.clientId + \"&\" + \"tokenProcessorUrl=\" + this.tokenProcessorUrl;\n        this.nonce = this.generateNonce();\n        var redirected = this.checkForIdentityRedirect();\n        if (!redirected) {\n            var redirectUri = (toUrl) ? toUrl : window.location.href.split(\"#\")[0];\n            var url = \"https://login.microsoftonline.com/common/oauth2/authorize?response_type=id_token\" +\n                \"&client_id=\" + encodeURIComponent(this.clientId) +\n                \"&redirect_uri=\" + encodeURIComponent(redirectUri) +\n                \"&state=\" + encodeURIComponent(this.state) +\n                \"&nonce=\" + encodeURIComponent(this.nonce);\n            window.location.href = url;\n        }\n    };\n    Identity.prototype.logOut = function () {\n        this.tokenCache.clear();\n        var url = \"https://login.microsoftonline.com/common/oauth2/logout?post_logout_redirect_uri=\" + encodeURI(window.location.href);\n        window.location.href = url;\n    };\n    Identity.prototype.base64Decode = function (encodedString) {\n        var e = {}, i, b = 0, c, x, l = 0, a, r = '', w = String.fromCharCode, L = encodedString.length;\n        var A = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\n        for (i = 0; i < 64; i++) {\n            e[A.charAt(i)] = i;\n        }\n        for (x = 0; x < L; x++) {\n            c = e[encodedString.charAt(x)];\n            b = (b << 6) + c;\n            l += 6;\n            while (l >= 8) {\n                ((a = (b >>> (l -= 8)) & 0xff) || (x < (L - 2))) && (r += w(a));\n            }\n        }\n        return r;\n    };\n    Identity.prototype.generateNonce = function () {\n        var text = \"\";\n        var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\n        for (var i = 0; i < 32; i++) {\n            text += chars.charAt(Math.floor(Math.random() * chars.length));\n        }\n        return text;\n    };\n    return Identity;\n}());\nexports.Identity = Identity;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/identity.ts\n ** module id = 3\n ** module chunks = 0\n **/","\"use strict\";\nvar __extends = (this && this.__extends) || function (d, b) {\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    function __() { this.constructor = d; }\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n};\nvar graph_1 = require(\"./graph\");\nvar Scopes = (function () {\n    function Scopes() {\n    }\n    Scopes.rootUrl = \"https://graph.microsoft.com/\";\n    Scopes.General = {\n        OpenId: \"openid\",\n        OfflineAccess: \"offline_access\",\n    };\n    Scopes.User = {\n        Read: Scopes.rootUrl + \"User.Read\",\n        ReadAll: Scopes.rootUrl + \"User.Read.All\",\n        ReadWrite: Scopes.rootUrl + \"User.ReadWrite\",\n        ReadWriteAll: Scopes.rootUrl + \"User.ReadWrite.All\",\n        ReadBasicAll: Scopes.rootUrl + \"User.ReadBasic.All\",\n    };\n    Scopes.Contacts = {\n        Read: Scopes.rootUrl + \"Contacts.Read\",\n        ReadWrite: Scopes.rootUrl + \"Contacts.ReadWrite\",\n    };\n    Scopes.Directory = {\n        ReadAll: Scopes.rootUrl + \"Directory.Read.All\",\n        ReadWriteAll: Scopes.rootUrl + \"Directory.ReadWrite.All\",\n        AccessAsUserAll: Scopes.rootUrl + \"Directory.AccessAsUser.All\",\n    };\n    Scopes.Group = {\n        ReadAll: Scopes.rootUrl + \"Group.Read.All\",\n        ReadWriteAll: Scopes.rootUrl + \"Group.ReadWrite.All\",\n        AccessAsUserAll: Scopes.rootUrl + \"Directory.AccessAsUser.All\"\n    };\n    Scopes.Mail = {\n        Read: Scopes.rootUrl + \"Mail.Read\",\n        ReadWrite: Scopes.rootUrl + \"Mail.ReadWrite\",\n        Send: Scopes.rootUrl + \"Mail.Send\",\n    };\n    Scopes.Calendars = {\n        Read: Scopes.rootUrl + \"Calendars.Read\",\n        ReadWrite: Scopes.rootUrl + \"Calendars.ReadWrite\",\n    };\n    Scopes.Files = {\n        Read: Scopes.rootUrl + \"Files.Read\",\n        ReadAll: Scopes.rootUrl + \"Files.Read.All\",\n        ReadWrite: Scopes.rootUrl + \"Files.ReadWrite\",\n        ReadWriteAppFolder: Scopes.rootUrl + \"Files.ReadWrite.AppFolder\",\n        ReadWriteSelected: Scopes.rootUrl + \"Files.ReadWrite.Selected\",\n    };\n    Scopes.Tasks = {\n        ReadWrite: Scopes.rootUrl + \"Tasks.ReadWrite\",\n    };\n    Scopes.People = {\n        Read: Scopes.rootUrl + \"People.Read\",\n        ReadWrite: Scopes.rootUrl + \"People.ReadWrite\",\n    };\n    Scopes.Notes = {\n        Create: Scopes.rootUrl + \"Notes.Create\",\n        ReadWriteCreatedByApp: Scopes.rootUrl + \"Notes.ReadWrite.CreatedByApp\",\n        Read: Scopes.rootUrl + \"Notes.Read\",\n        ReadAll: Scopes.rootUrl + \"Notes.Read.All\",\n        ReadWriteAll: Scopes.rootUrl + \"Notes.ReadWrite.All\",\n    };\n    return Scopes;\n}());\nvar queryUnion = function (query1, query2) { return (query1 ? query1 + (query2 ? \"&\" + query2 : \"\") : query2); };\nvar OData = (function () {\n    function OData(query) {\n        var _this = this;\n        this.query = query;\n        this.toString = function () { return _this.query; };\n        this.odata = function (query) {\n            _this.query = queryUnion(_this.query, query);\n            return _this;\n        };\n        this.select = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.odata(\"$select=\" + fields.join(\",\"));\n        };\n        this.expand = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.odata(\"$expand=\" + fields.join(\",\"));\n        };\n        this.filter = function (query) { return _this.odata(\"$filter=\" + query); };\n        this.orderby = function () {\n            var fields = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                fields[_i - 0] = arguments[_i];\n            }\n            return _this.odata(\"$orderby=\" + fields.join(\",\"));\n        };\n        this.top = function (items) { return _this.odata(\"$top=\" + items); };\n        this.skip = function (items) { return _this.odata(\"$skip=\" + items); };\n    }\n    return OData;\n}());\nexports.OData = OData;\nvar pathWithQuery = function (path, odataQuery) {\n    var query = odataQuery && odataQuery.toString();\n    return path + (query ? \"?\" + query : \"\");\n};\nvar Singleton = (function () {\n    function Singleton(raw, self) {\n        this.raw = raw;\n        this.self = self;\n    }\n    Object.defineProperty(Singleton.prototype, \"item\", {\n        get: function () {\n            return this.raw;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Singleton;\n}());\nexports.Singleton = Singleton;\nvar Collection = (function () {\n    function Collection(raw, self, next) {\n        this.raw = raw;\n        this.self = self;\n        this.next = next;\n        var nextLink = this.raw[\"@odata.nextLink\"];\n        if (nextLink) {\n            this.next.nextLink = nextLink;\n        }\n        else {\n            this.next = undefined;\n        }\n    }\n    Object.defineProperty(Collection.prototype, \"items\", {\n        get: function () {\n            return (this.raw.value ? this.raw.value : [this.raw]);\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return Collection;\n}());\nexports.Collection = Collection;\nvar Node = (function () {\n    function Node(graph, path) {\n        var _this = this;\n        this.graph = graph;\n        this.path = path;\n        this.pathWithQuery = function (odataQuery, pathSuffix) {\n            if (pathSuffix === void 0) { pathSuffix = \"\"; }\n            return pathWithQuery(_this.path + pathSuffix, odataQuery);\n        };\n    }\n    return Node;\n}());\nexports.Node = Node;\nvar CollectionNode = (function (_super) {\n    __extends(CollectionNode, _super);\n    function CollectionNode() {\n        var _this = this;\n        _super.apply(this, arguments);\n        this.pathWithQuery = function (odataQuery, pathSuffix) {\n            if (pathSuffix === void 0) { pathSuffix = \"\"; }\n            return _this._nextLink || pathWithQuery(_this.path + pathSuffix, odataQuery);\n        };\n    }\n    Object.defineProperty(CollectionNode.prototype, \"nextLink\", {\n        set: function (pathWithQuery) {\n            this._nextLink = pathWithQuery;\n        },\n        enumerable: true,\n        configurable: true\n    });\n    return CollectionNode;\n}(Node));\nexports.CollectionNode = CollectionNode;\nvar Attachment = (function (_super) {\n    __extends(Attachment, _super);\n    function Attachment(graph, path, context, attachmentId) {\n        var _this = this;\n        if (path === void 0) { path = \"\"; }\n        _super.call(this, graph, path + (attachmentId ? \"/\" + attachmentId : \"\"));\n        this.context = context;\n        this.GetAttachment = function (odataQuery) { return _this.graph.Get(_this.pathWithQuery(odataQuery), _this, Attachment.scopes[_this.context]); };\n    }\n    Attachment.scopes = {\n        messages: [Scopes.Mail.Read],\n        events: [Scopes.Calendars.Read],\n    };\n    return Attachment;\n}(Node));\nexports.Attachment = Attachment;\nvar Attachments = (function (_super) {\n    __extends(Attachments, _super);\n    function Attachments(graph, path, context) {\n        var _this = this;\n        if (path === void 0) { path = \"\"; }\n        _super.call(this, graph, path + \"/attachments\");\n        this.context = context;\n        this.$ = function (attachmentId) { return new Attachment(_this.graph, _this.path, _this.context, attachmentId); };\n        this.GetAttachments = function (odataQuery) { return _this.graph.GetCollection(_this.pathWithQuery(odataQuery), _this, new Attachments(_this.graph, null, _this.context), Attachment.scopes[_this.context]); };\n    }\n    return Attachments;\n}(CollectionNode));\nexports.Attachments = Attachments;\nvar Message = (function (_super) {\n    __extends(Message, _super);\n    function Message(graph, path, messageId) {\n        var _this = this;\n        if (path === void 0) { path = \"\"; }\n        _super.call(this, graph, path + (messageId ? \"/\" + messageId : \"\"));\n        this.GetMessage = function (odataQuery) { return _this.graph.Get(_this.pathWithQuery(odataQuery), _this, [Scopes.Mail.Read]); };\n        this.SendMessage = function (odataQuery) { return _this.graph.Post(null, _this.pathWithQuery(odataQuery, \"/microsoft.graph.sendMail\"), _this, [Scopes.Mail.Send]); };\n    }\n    Object.defineProperty(Message.prototype, \"attachments\", {\n        get: function () { return new Attachments(this.graph, this.path, \"messages\"); },\n        enumerable: true,\n        configurable: true\n    });\n    return Message;\n}(Node));\nexports.Message = Message;\nvar Messages = (function (_super) {\n    __extends(Messages, _super);\n    function Messages(graph, path) {\n        var _this = this;\n        if (path === void 0) { path = \"\"; }\n        _super.call(this, graph, path + \"/messages\");\n        this.$ = function (messageId) { return new Message(_this.graph, _this.path, messageId); };\n        this.GetMessages = function (odataQuery) { return _this.graph.GetCollection(_this.pathWithQuery(odataQuery), _this, new Messages(_this.graph), [Scopes.Mail.Read, Scopes.Mail.ReadWrite]); };\n        this.CreateMessage = function (object, odataQuery) { return _this.graph.Post(object, _this.pathWithQuery(odataQuery), _this, [Scopes.Mail.ReadWrite]); };\n    }\n    return Messages;\n}(CollectionNode));\nexports.Messages = Messages;\nvar Event = (function (_super) {\n    __extends(Event, _super);\n    function Event(graph, path, eventId) {\n        var _this = this;\n        if (path === void 0) { path = \"\"; }\n        _super.call(this, graph, path + (eventId ? \"/\" + eventId : \"\"));\n        this.GetEvent = function (odataQuery) { return _this.graph.Get(_this.pathWithQuery(odataQuery), _this, [Scopes.Calendars.Read]); };\n    }\n    Object.defineProperty(Event.prototype, \"attachments\", {\n        get: function () { return new Attachments(this.graph, this.path, \"events\"); },\n        enumerable: true,\n        configurable: true\n    });\n    return Event;\n}(Node));\nexports.Event = Event;\nvar eventsScopes = [Scopes.Calendars.Read, Scopes.Calendars.ReadWrite];\nvar Events = (function (_super) {\n    __extends(Events, _super);\n    function Events(graph, path) {\n        var _this = this;\n        if (path === void 0) { path = \"\"; }\n        _super.call(this, graph, path + \"/events\");\n        this.$ = function (eventId) { return new Event(_this.graph, _this.path, eventId); };\n        this.GetEvents = function (odataQuery) { return _this.graph.GetCollection(_this.pathWithQuery(odataQuery), _this, new Events(_this.graph), eventsScopes); };\n    }\n    return Events;\n}(CollectionNode));\nexports.Events = Events;\nvar CalendarView = (function (_super) {\n    __extends(CalendarView, _super);\n    function CalendarView(graph, path) {\n        var _this = this;\n        if (path === void 0) { path = \"\"; }\n        _super.call(this, graph, path + \"/calendarView\");\n        this.dateRange = function (startDate, endDate) { return (\"startDateTime=\" + startDate.toISOString() + \"&endDateTime=\" + endDate.toISOString()); };\n        this.GetCalendarView = function (odataQuery) { return _this.graph.GetCollection(_this.pathWithQuery(odataQuery), _this, new CalendarView(_this.graph), eventsScopes); };\n    }\n    return CalendarView;\n}(CollectionNode));\nexports.CalendarView = CalendarView;\nvar mailFolderScopes = [Scopes.Mail.Read, Scopes.Mail.ReadWrite];\nvar MailFolder = (function (_super) {\n    __extends(MailFolder, _super);\n    function MailFolder(graph, path, mailFolderId) {\n        var _this = this;\n        if (path === void 0) { path = \"\"; }\n        _super.call(this, graph, path + (mailFolderId ? \"/\" + mailFolderId : \"\"));\n        this.GetMailFolder = function (odataQuery) { return _this.graph.Get(_this.pathWithQuery(odataQuery), _this, mailFolderScopes); };\n    }\n    return MailFolder;\n}(Node));\nexports.MailFolder = MailFolder;\nvar MailFolders = (function (_super) {\n    __extends(MailFolders, _super);\n    function MailFolders(graph, path) {\n        var _this = this;\n        if (path === void 0) { path = \"\"; }\n        _super.call(this, graph, path + \"/mailFolders\");\n        this.$ = function (mailFolderId) { return new MailFolder(_this.graph, _this.path, mailFolderId); };\n        this.GetMailFolders = function (odataQuery) { return _this.graph.GetCollection(_this.pathWithQuery(odataQuery), _this, new MailFolders(_this.graph), mailFolderScopes); };\n    }\n    return MailFolders;\n}(CollectionNode));\nexports.MailFolders = MailFolders;\nvar usersScopes = [Scopes.User.ReadBasicAll, Scopes.User.ReadAll, Scopes.User.ReadWriteAll, Scopes.Directory.ReadAll, Scopes.Directory.ReadWriteAll, Scopes.Directory.AccessAsUserAll];\nvar userScopes = usersScopes.concat([Scopes.User.Read, Scopes.User.ReadWrite]);\nvar User = (function (_super) {\n    __extends(User, _super);\n    function User(graph, path, userId) {\n        var _this = this;\n        if (path === void 0) { path = \"\"; }\n        _super.call(this, graph, userId ? path + \"/\" + userId : path + \"/me\");\n        this.graph = graph;\n        this.GetUser = function (odataQuery) { return _this.graph.Get(_this.pathWithQuery(odataQuery), _this, userScopes); };\n        console.log(\"Graph.foo\", graph_1.Graph.foo);\n    }\n    Object.defineProperty(User.prototype, \"messages\", {\n        get: function () { return new Messages(this.graph, this.path); },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(User.prototype, \"events\", {\n        get: function () { return new Events(this.graph, this.path); },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(User.prototype, \"calendarView\", {\n        get: function () { return new CalendarView(this.graph, this.path); },\n        enumerable: true,\n        configurable: true\n    });\n    Object.defineProperty(User.prototype, \"mailFolders\", {\n        get: function () { return new MailFolders(this.graph, this.path); },\n        enumerable: true,\n        configurable: true\n    });\n    return User;\n}(Node));\nexports.User = User;\nvar Users = (function (_super) {\n    __extends(Users, _super);\n    function Users(graph, path) {\n        var _this = this;\n        if (path === void 0) { path = \"\"; }\n        _super.call(this, graph, path + \"/users\");\n        this.$ = function (userId) { return new User(_this.graph, _this.path, userId); };\n        this.GetUsers = function (odataQuery) { return _this.graph.GetCollection(_this.pathWithQuery(odataQuery), _this, new Users(_this.graph), userScopes); };\n    }\n    return Users;\n}(CollectionNode));\nexports.Users = Users;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/requestbuilder.ts\n ** module id = 4\n ** module chunks = 0\n **/"],"sourceRoot":""}