{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap 3a18140cee6c103f505f","webpack:///./src/kurve.ts","webpack:///./src/graph.ts","webpack:///./src/promises.ts","webpack:///./src/identity.ts"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACLA;AACA;AACA;AACA,oBAAmB,sBAAsB;AACzC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,EAAC,iDAAiD;AAClD;AACA;AACA;AACA;AACA;AACA;AACA,2BAA0B,mBAAmB,EAAE;AAC/C;AACA;AACA,MAAK;AACL;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA,EAAC,wDAAwD;AACzD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA,EAAC,wDAAwD;AACzD;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAwC,kDAAkD,EAAE;AAC5F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA0C,yBAAyB;AACnE;AACA,mDAAkD,kDAAkD,EAAE;AACtG;AACA;AACA;AACA,2CAA0C,yBAAyB;AACnE;AACA;AACA;AACA;AACA;AACA,2CAA0C,yBAAyB;AACnE;AACA,6CAA4C,mDAAmD,EAAE;AACjG;AACA;AACA;AACA,2CAA0C,yBAAyB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA,sDAAqD,mDAAmD,EAAE;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C,oDAAoD,EAAE;AACpG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sFAAqF,qDAAqD,EAAE;AAC5I;AACA;AACA;AACA;AACA;AACA,yEAAwE,gCAAgC,EAAE;AAC1G;AACA;AACA;AACA,6EAA4E,sDAAsD,EAAE;AACpI;AACA;AACA;AACA;AACA;AACA,+DAA8D,gCAAgC,EAAE;AAChG;AACA;AACA;AACA,gFAA+E,sDAAsD,EAAE;AACvI;AACA;AACA;AACA;AACA;AACA,kEAAiE,gCAAgC,EAAE;AACnG;AACA;AACA;AACA,gFAA+E,mDAAmD,EAAE;AACpI;AACA;AACA;AACA;AACA;AACA,qEAAoE,gCAAgC,EAAE;AACtG;AACA;AACA;AACA,mFAAkF,oDAAoD,EAAE;AACxI;AACA;AACA;AACA;AACA;AACA,uEAAsE,gCAAgC,EAAE;AACxG;AACA;AACA;AACA,2EAA0E,oDAAoD,EAAE;AAChI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wEAAuE,kDAAkD,EAAE;AAC3H;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+EAA8E,mDAAmD,EAAE;AACnI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qFAAoF,0DAA0D,EAAE;AAChJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oFAAmF,oDAAoD,EAAE;AACzI;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gGAA+F,oDAAoD,EAAE;AACrJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iHAAgH,wDAAwD,EAAE;AAC1K;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mDAAkD,sDAAsD,EAAE;AAC1G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA0C,yBAAyB;AACnE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yEAAwE,2BAA2B,EAAE;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+EAA8E,8BAA8B,EAAE;AAC9G;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qFAAoF,4BAA4B,EAAE;AAClH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2EAA0E,4BAA4B,EAAE;AACxG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qFAAoF,iCAAiC,EAAE;AACvH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qFAAoF,iCAAiC,EAAE;AACvH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;AACrB;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,+BAA8B,WAAW;AACzC;AACA;AACA;AACA,+BAA8B,WAAW;AACzC;AACA;AACA;AACA,+BAA8B,WAAW;AACzC;AACA;AACA;AACA,EAAC;AACD;;;;;;;AC38BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC,oCAAoC;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA0C,yDAAyD,EAAE;AACrG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA0C,uDAAuD,EAAE;AACnG;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gCAA+B,eAAe;AAC9C;AACA;AACA;AACA,kBAAiB;AACjB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,eAAe;AACtC;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;;;;;;;AC7KA;AACA;AACA;AACA;AACA;AACA,EAAC,oDAAoD;AACrD;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,8DAA6D,sCAAsC,EAAE;AACrG,UAAS;AACT;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA,EAAC;AACD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iCAAgC,EAAE;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,2CAA0C,0BAA0B;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA,2CAA0C,0BAA0B;AACpE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB;AAClB;AACA,oBAAmB,QAAQ;AAC3B;AACA;AACA,oBAAmB,OAAO;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,QAAQ;AAC/B;AACA;AACA;AACA;AACA;AACA,EAAC;AACD","file":"dist/kurve.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"Kurve\"] = factory();\n\telse\n\t\troot[\"Kurve\"] = factory();\n})(this, function() {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 3a18140cee6c103f505f\n **/","\"use strict\";\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n__export(require(\"./graph\"));\r\n__export(require(\"./identity\"));\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/kurve.ts\n ** module id = 0\n ** module chunks = 0\n **/","\"use strict\";\r\nvar __extends = (this && this.__extends) || function (d, b) {\r\n    for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n};\r\nvar promises_1 = require(\"./promises\");\r\nvar identity_1 = require(\"./identity\");\r\nvar Scopes;\r\n(function (Scopes) {\r\n    var Util = (function () {\r\n        function Util() {\r\n        }\r\n        Util.rootUrl = \"https://graph.microsoft.com/\";\r\n        return Util;\r\n    }());\r\n    var General = (function () {\r\n        function General() {\r\n        }\r\n        General.OpenId = \"openid\";\r\n        General.OfflineAccess = \"offline_access\";\r\n        return General;\r\n    }());\r\n    Scopes.General = General;\r\n    var User = (function () {\r\n        function User() {\r\n        }\r\n        User.Read = Util.rootUrl + \"User.Read\";\r\n        User.ReadWrite = Util.rootUrl + \"User.ReadWrite\";\r\n        User.ReadBasicAll = Util.rootUrl + \"User.ReadBasic.All\";\r\n        User.ReadAll = Util.rootUrl + \"User.Read.All\";\r\n        User.ReadWriteAll = Util.rootUrl + \"User.ReadWrite.All\";\r\n        return User;\r\n    }());\r\n    Scopes.User = User;\r\n    var Contacts = (function () {\r\n        function Contacts() {\r\n        }\r\n        Contacts.Read = Util.rootUrl + \"Contacts.Read\";\r\n        Contacts.ReadWrite = Util.rootUrl + \"Contacts.ReadWrite\";\r\n        return Contacts;\r\n    }());\r\n    Scopes.Contacts = Contacts;\r\n    var Directory = (function () {\r\n        function Directory() {\r\n        }\r\n        Directory.ReadAll = Util.rootUrl + \"Directory.Read.All\";\r\n        Directory.ReadWriteAll = Util.rootUrl + \"Directory.ReadWrite.All\";\r\n        Directory.AccessAsUserAll = Util.rootUrl + \"Directory.AccessAsUser.All\";\r\n        return Directory;\r\n    }());\r\n    Scopes.Directory = Directory;\r\n    var Group = (function () {\r\n        function Group() {\r\n        }\r\n        Group.ReadAll = Util.rootUrl + \"Group.Read.All\";\r\n        Group.ReadWriteAll = Util.rootUrl + \"Group.ReadWrite.All\";\r\n        Group.AccessAsUserAll = Util.rootUrl + \"Directory.AccessAsUser.All\";\r\n        return Group;\r\n    }());\r\n    Scopes.Group = Group;\r\n    var Mail = (function () {\r\n        function Mail() {\r\n        }\r\n        Mail.Read = Util.rootUrl + \"Mail.Read\";\r\n        Mail.ReadWrite = Util.rootUrl + \"Mail.ReadWrite\";\r\n        Mail.Send = Util.rootUrl + \"Mail.Send\";\r\n        return Mail;\r\n    }());\r\n    Scopes.Mail = Mail;\r\n    var Calendars = (function () {\r\n        function Calendars() {\r\n        }\r\n        Calendars.Read = Util.rootUrl + \"Calendars.Read\";\r\n        Calendars.ReadWrite = Util.rootUrl + \"Calendars.ReadWrite\";\r\n        return Calendars;\r\n    }());\r\n    Scopes.Calendars = Calendars;\r\n    var Files = (function () {\r\n        function Files() {\r\n        }\r\n        Files.Read = Util.rootUrl + \"Files.Read\";\r\n        Files.ReadAll = Util.rootUrl + \"Files.Read.All\";\r\n        Files.ReadWrite = Util.rootUrl + \"Files.ReadWrite\";\r\n        Files.ReadWriteAppFolder = Util.rootUrl + \"Files.ReadWrite.AppFolder\";\r\n        Files.ReadWriteSelected = Util.rootUrl + \"Files.ReadWrite.Selected\";\r\n        return Files;\r\n    }());\r\n    Scopes.Files = Files;\r\n    var Tasks = (function () {\r\n        function Tasks() {\r\n        }\r\n        Tasks.ReadWrite = Util.rootUrl + \"Tasks.ReadWrite\";\r\n        return Tasks;\r\n    }());\r\n    Scopes.Tasks = Tasks;\r\n    var People = (function () {\r\n        function People() {\r\n        }\r\n        People.Read = Util.rootUrl + \"People.Read\";\r\n        People.ReadWrite = Util.rootUrl + \"People.ReadWrite\";\r\n        return People;\r\n    }());\r\n    Scopes.People = People;\r\n    var Notes = (function () {\r\n        function Notes() {\r\n        }\r\n        Notes.Create = Util.rootUrl + \"Notes.Create\";\r\n        Notes.ReadWriteCreatedByApp = Util.rootUrl + \"Notes.ReadWrite.CreatedByApp\";\r\n        Notes.Read = Util.rootUrl + \"Notes.Read\";\r\n        Notes.ReadAll = Util.rootUrl + \"Notes.Read.All\";\r\n        Notes.ReadWriteAll = Util.rootUrl + \"Notes.ReadWrite.All\";\r\n        return Notes;\r\n    }());\r\n    Scopes.Notes = Notes;\r\n})(Scopes = exports.Scopes || (exports.Scopes = {}));\r\nvar DataModelWrapper = (function () {\r\n    function DataModelWrapper(graph, _data) {\r\n        this.graph = graph;\r\n        this._data = _data;\r\n    }\r\n    Object.defineProperty(DataModelWrapper.prototype, \"data\", {\r\n        get: function () { return this._data; },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return DataModelWrapper;\r\n}());\r\nexports.DataModelWrapper = DataModelWrapper;\r\nvar DataModelListWrapper = (function (_super) {\r\n    __extends(DataModelListWrapper, _super);\r\n    function DataModelListWrapper() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return DataModelListWrapper;\r\n}(DataModelWrapper));\r\nexports.DataModelListWrapper = DataModelListWrapper;\r\nvar ProfilePhotoDataModel = (function () {\r\n    function ProfilePhotoDataModel() {\r\n    }\r\n    return ProfilePhotoDataModel;\r\n}());\r\nexports.ProfilePhotoDataModel = ProfilePhotoDataModel;\r\nvar ProfilePhoto = (function (_super) {\r\n    __extends(ProfilePhoto, _super);\r\n    function ProfilePhoto() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return ProfilePhoto;\r\n}(DataModelWrapper));\r\nexports.ProfilePhoto = ProfilePhoto;\r\nvar UserDataModel = (function () {\r\n    function UserDataModel() {\r\n    }\r\n    return UserDataModel;\r\n}());\r\nexports.UserDataModel = UserDataModel;\r\n(function (EventsEndpoint) {\r\n    EventsEndpoint[EventsEndpoint[\"events\"] = 0] = \"events\";\r\n    EventsEndpoint[EventsEndpoint[\"calendarView\"] = 1] = \"calendarView\";\r\n})(exports.EventsEndpoint || (exports.EventsEndpoint = {}));\r\nvar EventsEndpoint = exports.EventsEndpoint;\r\nvar User = (function (_super) {\r\n    __extends(User, _super);\r\n    function User() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    User.prototype.events = function (callback, odataQuery) {\r\n        this.graph.eventsForUser(this._data.userPrincipalName, EventsEndpoint.events, callback, odataQuery);\r\n    };\r\n    User.prototype.eventsAsync = function (odataQuery) {\r\n        return this.graph.eventsForUserAsync(this._data.userPrincipalName, EventsEndpoint.events, odataQuery);\r\n    };\r\n    User.prototype.memberOf = function (callback, Error, odataQuery) {\r\n        this.graph.memberOfForUser(this._data.userPrincipalName, callback, odataQuery);\r\n    };\r\n    User.prototype.memberOfAsync = function (odataQuery) {\r\n        return this.graph.memberOfForUserAsync(this._data.userPrincipalName, odataQuery);\r\n    };\r\n    User.prototype.messages = function (callback, odataQuery) {\r\n        this.graph.messagesForUser(this._data.userPrincipalName, callback, odataQuery);\r\n    };\r\n    User.prototype.messagesAsync = function (odataQuery) {\r\n        return this.graph.messagesForUserAsync(this._data.userPrincipalName, odataQuery);\r\n    };\r\n    User.prototype.manager = function (callback, odataQuery) {\r\n        this.graph.managerForUser(this._data.userPrincipalName, callback, odataQuery);\r\n    };\r\n    User.prototype.managerAsync = function (odataQuery) {\r\n        return this.graph.managerForUserAsync(this._data.userPrincipalName, odataQuery);\r\n    };\r\n    User.prototype.profilePhoto = function (callback, odataQuery) {\r\n        this.graph.profilePhotoForUser(this._data.userPrincipalName, callback, odataQuery);\r\n    };\r\n    User.prototype.profilePhotoAsync = function (odataQuery) {\r\n        return this.graph.profilePhotoForUserAsync(this._data.userPrincipalName, odataQuery);\r\n    };\r\n    User.prototype.profilePhotoValue = function (callback, odataQuery) {\r\n        this.graph.profilePhotoValueForUser(this._data.userPrincipalName, callback, odataQuery);\r\n    };\r\n    User.prototype.profilePhotoValueAsync = function (odataQuery) {\r\n        return this.graph.profilePhotoValueForUserAsync(this._data.userPrincipalName, odataQuery);\r\n    };\r\n    User.prototype.calendarView = function (callback, odataQuery) {\r\n        this.graph.eventsForUser(this._data.userPrincipalName, EventsEndpoint.calendarView, callback, odataQuery);\r\n    };\r\n    User.prototype.calendarViewAsync = function (odataQuery) {\r\n        return this.graph.eventsForUserAsync(this._data.userPrincipalName, EventsEndpoint.calendarView, odataQuery);\r\n    };\r\n    User.prototype.mailFolders = function (callback, odataQuery) {\r\n        this.graph.mailFoldersForUser(this._data.userPrincipalName, callback, odataQuery);\r\n    };\r\n    User.prototype.mailFoldersAsync = function (odataQuery) {\r\n        return this.graph.mailFoldersForUserAsync(this._data.userPrincipalName, odataQuery);\r\n    };\r\n    User.prototype.message = function (messageId, callback, odataQuery) {\r\n        this.graph.messageForUser(this._data.userPrincipalName, messageId, callback, odataQuery);\r\n    };\r\n    User.prototype.messageAsync = function (messageId, odataQuery) {\r\n        return this.graph.messageForUserAsync(this._data.userPrincipalName, messageId, odataQuery);\r\n    };\r\n    User.prototype.event = function (eventId, callback, odataQuery) {\r\n        this.graph.eventForUser(this._data.userPrincipalName, eventId, callback, odataQuery);\r\n    };\r\n    User.prototype.eventAsync = function (eventId, odataQuery) {\r\n        return this.graph.eventForUserAsync(this._data.userPrincipalName, eventId, odataQuery);\r\n    };\r\n    User.prototype.messageAttachment = function (messageId, attachmentId, callback, odataQuery) {\r\n        this.graph.messageAttachmentForUser(this._data.userPrincipalName, messageId, attachmentId, callback, odataQuery);\r\n    };\r\n    User.prototype.messageAttachmentAsync = function (messageId, attachmentId, odataQuery) {\r\n        return this.graph.messageAttachmentForUserAsync(this._data.userPrincipalName, messageId, attachmentId, odataQuery);\r\n    };\r\n    return User;\r\n}(DataModelWrapper));\r\nexports.User = User;\r\nvar Users = (function (_super) {\r\n    __extends(Users, _super);\r\n    function Users() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Users;\r\n}(DataModelListWrapper));\r\nexports.Users = Users;\r\nvar MessageDataModel = (function () {\r\n    function MessageDataModel() {\r\n    }\r\n    return MessageDataModel;\r\n}());\r\nexports.MessageDataModel = MessageDataModel;\r\nvar Message = (function (_super) {\r\n    __extends(Message, _super);\r\n    function Message() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Message;\r\n}(DataModelWrapper));\r\nexports.Message = Message;\r\nvar Messages = (function (_super) {\r\n    __extends(Messages, _super);\r\n    function Messages() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Messages;\r\n}(DataModelListWrapper));\r\nexports.Messages = Messages;\r\nvar EventDataModel = (function () {\r\n    function EventDataModel() {\r\n    }\r\n    return EventDataModel;\r\n}());\r\nexports.EventDataModel = EventDataModel;\r\nvar Event = (function (_super) {\r\n    __extends(Event, _super);\r\n    function Event() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Event;\r\n}(DataModelWrapper));\r\nexports.Event = Event;\r\nvar Events = (function (_super) {\r\n    __extends(Events, _super);\r\n    function Events(graph, endpoint, _data) {\r\n        _super.call(this, graph, _data);\r\n        this.graph = graph;\r\n        this.endpoint = endpoint;\r\n        this._data = _data;\r\n    }\r\n    return Events;\r\n}(DataModelListWrapper));\r\nexports.Events = Events;\r\nvar Contact = (function () {\r\n    function Contact() {\r\n    }\r\n    return Contact;\r\n}());\r\nexports.Contact = Contact;\r\nvar GroupDataModel = (function () {\r\n    function GroupDataModel() {\r\n    }\r\n    return GroupDataModel;\r\n}());\r\nexports.GroupDataModel = GroupDataModel;\r\nvar Group = (function (_super) {\r\n    __extends(Group, _super);\r\n    function Group() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Group;\r\n}(DataModelWrapper));\r\nexports.Group = Group;\r\nvar Groups = (function (_super) {\r\n    __extends(Groups, _super);\r\n    function Groups() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Groups;\r\n}(DataModelListWrapper));\r\nexports.Groups = Groups;\r\nvar MailFolderDataModel = (function () {\r\n    function MailFolderDataModel() {\r\n    }\r\n    return MailFolderDataModel;\r\n}());\r\nexports.MailFolderDataModel = MailFolderDataModel;\r\nvar MailFolder = (function (_super) {\r\n    __extends(MailFolder, _super);\r\n    function MailFolder() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return MailFolder;\r\n}(DataModelWrapper));\r\nexports.MailFolder = MailFolder;\r\nvar MailFolders = (function (_super) {\r\n    __extends(MailFolders, _super);\r\n    function MailFolders() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return MailFolders;\r\n}(DataModelListWrapper));\r\nexports.MailFolders = MailFolders;\r\n(function (AttachmentType) {\r\n    AttachmentType[AttachmentType[\"fileAttachment\"] = 0] = \"fileAttachment\";\r\n    AttachmentType[AttachmentType[\"itemAttachment\"] = 1] = \"itemAttachment\";\r\n    AttachmentType[AttachmentType[\"referenceAttachment\"] = 2] = \"referenceAttachment\";\r\n})(exports.AttachmentType || (exports.AttachmentType = {}));\r\nvar AttachmentType = exports.AttachmentType;\r\nvar AttachmentDataModel = (function () {\r\n    function AttachmentDataModel() {\r\n    }\r\n    return AttachmentDataModel;\r\n}());\r\nexports.AttachmentDataModel = AttachmentDataModel;\r\nvar Attachment = (function (_super) {\r\n    __extends(Attachment, _super);\r\n    function Attachment() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    Attachment.prototype.getType = function () {\r\n        switch (this._data['@odata.type']) {\r\n            case \"#microsoft.graph.fileAttachment\":\r\n                return AttachmentType.fileAttachment;\r\n            case \"#microsoft.graph.itemAttachment\":\r\n                return AttachmentType.itemAttachment;\r\n            case \"#microsoft.graph.referenceAttachment\":\r\n                return AttachmentType.referenceAttachment;\r\n        }\r\n    };\r\n    return Attachment;\r\n}(DataModelWrapper));\r\nexports.Attachment = Attachment;\r\nvar Attachments = (function (_super) {\r\n    __extends(Attachments, _super);\r\n    function Attachments() {\r\n        _super.apply(this, arguments);\r\n    }\r\n    return Attachments;\r\n}(DataModelListWrapper));\r\nexports.Attachments = Attachments;\r\nvar Graph = (function () {\r\n    function Graph(identityInfo) {\r\n        this.req = null;\r\n        this.accessToken = null;\r\n        this.KurveIdentity = null;\r\n        this.defaultResourceID = \"https://graph.microsoft.com\";\r\n        this.baseUrl = \"https://graph.microsoft.com/v1.0/\";\r\n        if (identityInfo.defaultAccessToken) {\r\n            this.accessToken = identityInfo.defaultAccessToken;\r\n        }\r\n        else {\r\n            this.KurveIdentity = identityInfo.identity;\r\n        }\r\n    }\r\n    Graph.prototype.scopesForV2 = function (scopes) {\r\n        if (!this.KurveIdentity)\r\n            return null;\r\n        if (this.KurveIdentity.getCurrentOauthVersion() === identity_1.OAuthVersion.v1)\r\n            return null;\r\n        else\r\n            return scopes;\r\n    };\r\n    Graph.prototype.meAsync = function (odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.me(function (user, error) { return error ? d.reject(error) : d.resolve(user); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.me = function (callback, odataQuery) {\r\n        var scopes = [Scopes.User.Read];\r\n        var urlString = this.buildMeUrl(\"\", odataQuery);\r\n        this.getUser(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.userAsync = function (userId, odataQuery, basicProfileOnly) {\r\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n        var d = new promises_1.Deferred();\r\n        this.user(userId, function (user, error) { return error ? d.reject(error) : d.resolve(user); }, odataQuery, basicProfileOnly);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.user = function (userId, callback, odataQuery, basicProfileOnly) {\r\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n        var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\r\n        var urlString = this.buildUsersUrl(userId, odataQuery);\r\n        this.getUser(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.usersAsync = function (odataQuery, basicProfileOnly) {\r\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n        var d = new promises_1.Deferred();\r\n        this.users(function (users, error) { return error ? d.reject(error) : d.resolve(users); }, odataQuery, basicProfileOnly);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.users = function (callback, odataQuery, basicProfileOnly) {\r\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n        var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\r\n        var urlString = this.buildUsersUrl(\"\", odataQuery);\r\n        this.getUsers(urlString, callback, this.scopesForV2(scopes), basicProfileOnly);\r\n    };\r\n    Graph.prototype.groupAsync = function (groupId, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.group(groupId, function (group, error) { return error ? d.reject(error) : d.resolve(group); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.group = function (groupId, callback, odataQuery) {\r\n        var scopes = [Scopes.Group.ReadAll];\r\n        var urlString = this.buildGroupsUrl(groupId, odataQuery);\r\n        this.getGroup(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.groupsAsync = function (odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.groups(function (groups, error) { return error ? d.reject(error) : d.resolve(groups); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.groups = function (callback, odataQuery) {\r\n        var scopes = [Scopes.Group.ReadAll];\r\n        var urlString = this.buildGroupsUrl(\"\", odataQuery);\r\n        this.getGroups(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.messageForUserAsync = function (userPrincipalName, messageId, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.messageForUser(userPrincipalName, messageId, function (message, error) { return error ? d.reject(error) : d.resolve(message); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.messageForUser = function (userPrincipalName, messageId, callback, odataQuery) {\r\n        var scopes = [Scopes.Mail.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages/\" + messageId, odataQuery);\r\n        this.getMessage(urlString, messageId, function (result, error) { return callback(result, error); }, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.messagesForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.messagesForUser(userPrincipalName, function (messages, error) { return error ? d.reject(error) : d.resolve(messages); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.messagesForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.Mail.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages\", odataQuery);\r\n        this.getMessages(urlString, function (result, error) { return callback(result, error); }, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.mailFoldersForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.mailFoldersForUser(userPrincipalName, function (messages, error) { return error ? d.reject(error) : d.resolve(messages); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.mailFoldersForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.Mail.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/mailFolders\", odataQuery);\r\n        this.getMailFolders(urlString, function (result, error) { return callback(result, error); }, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.eventForUserAsync = function (userPrincipalName, eventId, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.eventForUser(userPrincipalName, eventId, function (event, error) { return error ? d.reject(error) : d.resolve(event); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.eventForUser = function (userPrincipalName, eventId, callback, odataQuery) {\r\n        var scopes = [Scopes.Calendars.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/events/\" + eventId, odataQuery);\r\n        this.getEvent(urlString, eventId, function (result, error) { return callback(result, error); }, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.eventsForUserAsync = function (userPrincipalName, endpoint, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.eventsForUser(userPrincipalName, endpoint, function (events, error) { return error ? d.reject(error) : d.resolve(events); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.eventsForUser = function (userPrincipalName, endpoint, callback, odataQuery) {\r\n        var scopes = [Scopes.Calendars.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/\" + EventsEndpoint[endpoint], odataQuery);\r\n        this.getEvents(urlString, endpoint, function (result, error) { return callback(result, error); }, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.memberOfForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.memberOfForUser(userPrincipalName, function (groups, error) { return error ? d.reject(error) : d.resolve(groups); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.memberOfForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.Group.ReadAll];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/memberOf\", odataQuery);\r\n        this.getGroups(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.managerForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.managerForUser(userPrincipalName, function (user, error) { return error ? d.reject(error) : d.resolve(user); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.managerForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.Directory.ReadAll];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/manager\", odataQuery);\r\n        this.getUser(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.directReportsForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.directReportsForUser(userPrincipalName, function (users, error) { return error ? d.reject(error) : d.resolve(users); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.directReportsForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.Directory.ReadAll];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/directReports\", odataQuery);\r\n        this.getUsers(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.profilePhotoForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.profilePhotoForUser(userPrincipalName, function (profilePhoto, error) { return error ? d.reject(error) : d.resolve(profilePhoto); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.profilePhotoForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.User.ReadBasicAll];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/photo\", odataQuery);\r\n        this.getPhoto(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.profilePhotoValueForUserAsync = function (userPrincipalName, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.profilePhotoValueForUser(userPrincipalName, function (result, error) { return error ? d.reject(error) : d.resolve(result); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.profilePhotoValueForUser = function (userPrincipalName, callback, odataQuery) {\r\n        var scopes = [Scopes.User.ReadBasicAll];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/photo/$value\", odataQuery);\r\n        this.getPhotoValue(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.messageAttachmentsForUserAsync = function (userPrincipalName, messageId, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.messageAttachmentsForUser(userPrincipalName, messageId, function (result, error) { return error ? d.reject(error) : d.resolve(result); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.messageAttachmentsForUser = function (userPrincipalName, messageId, callback, odataQuery) {\r\n        var scopes = [Scopes.Mail.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages/\" + messageId + \"/attachments\", odataQuery);\r\n        this.getMessageAttachments(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.messageAttachmentForUserAsync = function (userPrincipalName, messageId, attachmentId, odataQuery) {\r\n        var d = new promises_1.Deferred();\r\n        this.messageAttachmentForUser(userPrincipalName, messageId, attachmentId, function (attachment, error) { return error ? d.reject(error) : d.resolve(attachment); }, odataQuery);\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.messageAttachmentForUser = function (userPrincipalName, messageId, attachmentId, callback, odataQuery) {\r\n        var scopes = [Scopes.Mail.Read];\r\n        var urlString = this.buildUsersUrl(userPrincipalName + \"/messages/\" + messageId + \"/attachments/\" + attachmentId, odataQuery);\r\n        this.getMessageAttachment(urlString, callback, this.scopesForV2(scopes));\r\n    };\r\n    Graph.prototype.getAsync = function (url) {\r\n        var d = new promises_1.Deferred();\r\n        this.get(url, function (response, error) { return error ? d.reject(error) : d.resolve(response); });\r\n        return d.promise;\r\n    };\r\n    Graph.prototype.get = function (url, callback, responseType, scopes) {\r\n        var _this = this;\r\n        var xhr = new XMLHttpRequest();\r\n        if (responseType)\r\n            xhr.responseType = responseType;\r\n        xhr.onreadystatechange = function () {\r\n            if (xhr.readyState === 4)\r\n                if (xhr.status === 200)\r\n                    callback(responseType ? xhr.response : xhr.responseText, null);\r\n                else\r\n                    callback(null, _this.generateError(xhr));\r\n        };\r\n        xhr.open(\"GET\", url);\r\n        this.addAccessTokenAndSend(xhr, function (addTokenError) {\r\n            if (addTokenError) {\r\n                callback(null, addTokenError);\r\n            }\r\n        }, scopes);\r\n    };\r\n    Graph.prototype.generateError = function (xhr) {\r\n        var response = new identity_1.Error();\r\n        response.status = xhr.status;\r\n        response.statusText = xhr.statusText;\r\n        if (xhr.responseType === '' || xhr.responseType === 'text')\r\n            response.text = xhr.responseText;\r\n        else\r\n            response.other = xhr.response;\r\n        return response;\r\n    };\r\n    Graph.prototype.getUsers = function (urlString, callback, scopes, basicProfileOnly) {\r\n        var _this = this;\r\n        if (basicProfileOnly === void 0) { basicProfileOnly = true; }\r\n        this.get(urlString, function (result, errorGet) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            var usersODATA = JSON.parse(result);\r\n            if (usersODATA.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = usersODATA.error;\r\n                callback(null, errorODATA);\r\n                return;\r\n            }\r\n            var resultsArray = (usersODATA.value ? usersODATA.value : [usersODATA]);\r\n            var users = new Users(_this, resultsArray.map(function (o) { return new User(_this, o); }));\r\n            var nextLink = usersODATA['@odata.nextLink'];\r\n            if (nextLink) {\r\n                users.nextLink = function (callback) {\r\n                    var scopes = basicProfileOnly ? [Scopes.User.ReadBasicAll] : [Scopes.User.ReadAll];\r\n                    var d = new promises_1.Deferred();\r\n                    _this.getUsers(nextLink, function (result, error) {\r\n                        if (callback)\r\n                            callback(result, error);\r\n                        else\r\n                            error ? d.reject(error) : d.resolve(result);\r\n                    }, _this.scopesForV2(scopes), basicProfileOnly);\r\n                    return d.promise;\r\n                };\r\n            }\r\n            callback(users, null);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getUser = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (result, errorGet) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            var userODATA = JSON.parse(result);\r\n            if (userODATA.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = userODATA.error;\r\n                callback(null, errorODATA);\r\n                return;\r\n            }\r\n            var user = new User(_this, userODATA);\r\n            callback(user, null);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.addAccessTokenAndSend = function (xhr, callback, scopes) {\r\n        if (this.accessToken) {\r\n            xhr.setRequestHeader('Authorization', 'Bearer ' + this.accessToken);\r\n            xhr.send();\r\n        }\r\n        else {\r\n            if (scopes) {\r\n                this.KurveIdentity.getAccessTokenForScopes(scopes, false, (function (token, error) {\r\n                    if (error)\r\n                        callback(error);\r\n                    else {\r\n                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\r\n                        xhr.send();\r\n                        callback(null);\r\n                    }\r\n                }));\r\n            }\r\n            else {\r\n                this.KurveIdentity.getAccessToken(this.defaultResourceID, (function (token, error) {\r\n                    if (error)\r\n                        callback(error);\r\n                    else {\r\n                        xhr.setRequestHeader('Authorization', 'Bearer ' + token);\r\n                        xhr.send();\r\n                        callback(null);\r\n                    }\r\n                }));\r\n            }\r\n        }\r\n    };\r\n    Graph.prototype.getMessage = function (urlString, messageId, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (result, errorGet) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            var ODATA = JSON.parse(result);\r\n            if (ODATA.error) {\r\n                var ODATAError = new identity_1.Error();\r\n                ODATAError.other = ODATA.error;\r\n                callback(null, ODATAError);\r\n                return;\r\n            }\r\n            var message = new Message(_this, ODATA);\r\n            callback(message, null);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getMessages = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (result, errorGet) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            var messagesODATA = JSON.parse(result);\r\n            if (messagesODATA.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = messagesODATA.error;\r\n                callback(null, errorODATA);\r\n                return;\r\n            }\r\n            var resultsArray = (messagesODATA.value ? messagesODATA.value : [messagesODATA]);\r\n            var messages = new Messages(_this, resultsArray.map(function (o) { return new Message(_this, o); }));\r\n            var nextLink = messagesODATA['@odata.nextLink'];\r\n            if (nextLink) {\r\n                messages.nextLink = function (callback) {\r\n                    var scopes = [Scopes.Mail.Read];\r\n                    var d = new promises_1.Deferred();\r\n                    _this.getMessages(nextLink, function (messages, error) {\r\n                        if (callback)\r\n                            callback(messages, error);\r\n                        else\r\n                            error ? d.reject(error) : d.resolve(messages);\r\n                    }, _this.scopesForV2(scopes));\r\n                    return d.promise;\r\n                };\r\n            }\r\n            callback(messages, null);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getEvent = function (urlString, EventId, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (result, errorGet) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            var ODATA = JSON.parse(result);\r\n            if (ODATA.error) {\r\n                var ODATAError = new identity_1.Error();\r\n                ODATAError.other = ODATA.error;\r\n                callback(null, ODATAError);\r\n                return;\r\n            }\r\n            var event = new Event(_this, ODATA);\r\n            callback(event, null);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getEvents = function (urlString, endpoint, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (result, errorGet) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            var odata = JSON.parse(result);\r\n            if (odata.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = odata.error;\r\n                callback(null, errorODATA);\r\n                return;\r\n            }\r\n            var resultsArray = (odata.value ? odata.value : [odata]);\r\n            var events = new Events(_this, endpoint, resultsArray.map(function (o) { return new Event(_this, o); }));\r\n            var nextLink = odata['@odata.nextLink'];\r\n            if (nextLink) {\r\n                events.nextLink = function (callback) {\r\n                    var scopes = [Scopes.Mail.Read];\r\n                    var d = new promises_1.Deferred();\r\n                    _this.getEvents(nextLink, endpoint, function (result, error) {\r\n                        if (callback)\r\n                            callback(result, error);\r\n                        else\r\n                            error ? d.reject(error) : d.resolve(result);\r\n                    }, _this.scopesForV2(scopes));\r\n                    return d.promise;\r\n                };\r\n            }\r\n            callback(events, null);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getGroups = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (result, errorGet) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            var groupsODATA = JSON.parse(result);\r\n            if (groupsODATA.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = groupsODATA.error;\r\n                callback(null, errorODATA);\r\n                return;\r\n            }\r\n            var resultsArray = (groupsODATA.value ? groupsODATA.value : [groupsODATA]);\r\n            var groups = new Groups(_this, resultsArray.map(function (o) { return new Group(_this, o); }));\r\n            var nextLink = groupsODATA['@odata.nextLink'];\r\n            if (nextLink) {\r\n                groups.nextLink = function (callback) {\r\n                    var scopes = [Scopes.Group.ReadAll];\r\n                    var d = new promises_1.Deferred();\r\n                    _this.getGroups(nextLink, function (result, error) {\r\n                        if (callback)\r\n                            callback(result, error);\r\n                        else\r\n                            error ? d.reject(error) : d.resolve(result);\r\n                    }, _this.scopesForV2(scopes));\r\n                    return d.promise;\r\n                };\r\n            }\r\n            callback(groups, null);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getGroup = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (result, errorGet) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            var ODATA = JSON.parse(result);\r\n            if (ODATA.error) {\r\n                var ODATAError = new identity_1.Error();\r\n                ODATAError.other = ODATA.error;\r\n                callback(null, ODATAError);\r\n                return;\r\n            }\r\n            var group = new Group(_this, ODATA);\r\n            callback(group, null);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getPhoto = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (result, errorGet) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            var ODATA = JSON.parse(result);\r\n            if (ODATA.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = ODATA.error;\r\n                callback(null, errorODATA);\r\n                return;\r\n            }\r\n            var photo = new ProfilePhoto(_this, ODATA);\r\n            callback(photo, null);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getPhotoValue = function (urlString, callback, scopes) {\r\n        this.get(urlString, function (result, errorGet) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            callback(result, null);\r\n        }, \"blob\", scopes);\r\n    };\r\n    Graph.prototype.getMailFolders = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (result, errorGet) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            var odata = JSON.parse(result);\r\n            if (odata.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = odata.error;\r\n                callback(null, errorODATA);\r\n            }\r\n            var resultsArray = (odata.value ? odata.value : [odata]);\r\n            var mailFolders = new MailFolders(_this, resultsArray.map(function (o) { return new MailFolder(_this, o); }));\r\n            var nextLink = odata['@odata.nextLink'];\r\n            if (nextLink) {\r\n                mailFolders.nextLink = function (callback) {\r\n                    var scopes = [Scopes.User.ReadAll];\r\n                    var d = new promises_1.Deferred();\r\n                    _this.getMailFolders(nextLink, function (result, error) {\r\n                        if (callback)\r\n                            callback(result, error);\r\n                        else\r\n                            error ? d.reject(error) : d.resolve(result);\r\n                    }, _this.scopesForV2(scopes));\r\n                    return d.promise;\r\n                };\r\n            }\r\n            callback(mailFolders, null);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getMessageAttachments = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (result, errorGet) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            var attachmentsODATA = JSON.parse(result);\r\n            if (attachmentsODATA.error) {\r\n                var errorODATA = new identity_1.Error();\r\n                errorODATA.other = attachmentsODATA.error;\r\n                callback(null, errorODATA);\r\n                return;\r\n            }\r\n            var resultsArray = (attachmentsODATA.value ? attachmentsODATA.value : [attachmentsODATA]);\r\n            var attachments = new Attachments(_this, resultsArray.map(function (o) { return new Attachment(_this, o); }));\r\n            var nextLink = attachmentsODATA['@odata.nextLink'];\r\n            if (nextLink) {\r\n                attachments.nextLink = function (callback) {\r\n                    var scopes = [Scopes.Mail.Read];\r\n                    var d = new promises_1.Deferred();\r\n                    _this.getMessageAttachments(nextLink, function (attachments, error) {\r\n                        if (callback)\r\n                            callback(attachments, error);\r\n                        else\r\n                            error ? d.reject(error) : d.resolve(attachments);\r\n                    }, _this.scopesForV2(scopes));\r\n                    return d.promise;\r\n                };\r\n            }\r\n            callback(attachments, null);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.getMessageAttachment = function (urlString, callback, scopes) {\r\n        var _this = this;\r\n        this.get(urlString, function (result, errorGet) {\r\n            if (errorGet) {\r\n                callback(null, errorGet);\r\n                return;\r\n            }\r\n            var ODATA = JSON.parse(result);\r\n            if (ODATA.error) {\r\n                var ODATAError = new identity_1.Error();\r\n                ODATAError.other = ODATA.error;\r\n                callback(null, ODATAError);\r\n                return;\r\n            }\r\n            var attachment = new Attachment(_this, ODATA);\r\n            callback(attachment, null);\r\n        }, null, scopes);\r\n    };\r\n    Graph.prototype.buildUrl = function (root, path, odataQuery) {\r\n        return this.baseUrl + root + path + (odataQuery ? \"?\" + odataQuery : \"\");\r\n    };\r\n    Graph.prototype.buildMeUrl = function (path, odataQuery) {\r\n        if (path === void 0) { path = \"\"; }\r\n        return this.buildUrl(\"me/\", path, odataQuery);\r\n    };\r\n    Graph.prototype.buildUsersUrl = function (path, odataQuery) {\r\n        if (path === void 0) { path = \"\"; }\r\n        return this.buildUrl(\"users/\", path, odataQuery);\r\n    };\r\n    Graph.prototype.buildGroupsUrl = function (path, odataQuery) {\r\n        if (path === void 0) { path = \"\"; }\r\n        return this.buildUrl(\"groups/\", path, odataQuery);\r\n    };\r\n    return Graph;\r\n}());\r\nexports.Graph = Graph;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/graph.ts\n ** module id = 1\n ** module chunks = 0\n **/","\"use strict\";\r\nfunction DispatchDeferred(closure) {\r\n    setTimeout(closure, 0);\r\n}\r\nvar PromiseState;\r\n(function (PromiseState) {\r\n    PromiseState[PromiseState[\"Pending\"] = 0] = \"Pending\";\r\n    PromiseState[PromiseState[\"ResolutionInProgress\"] = 1] = \"ResolutionInProgress\";\r\n    PromiseState[PromiseState[\"Resolved\"] = 2] = \"Resolved\";\r\n    PromiseState[PromiseState[\"Rejected\"] = 3] = \"Rejected\";\r\n})(PromiseState || (PromiseState = {}));\r\nvar Client = (function () {\r\n    function Client(_dispatcher, _successCB, _errorCB) {\r\n        this._dispatcher = _dispatcher;\r\n        this._successCB = _successCB;\r\n        this._errorCB = _errorCB;\r\n        this.result = new Deferred(_dispatcher);\r\n    }\r\n    Client.prototype.resolve = function (value, defer) {\r\n        var _this = this;\r\n        if (typeof (this._successCB) !== 'function') {\r\n            this.result.resolve(value);\r\n            return;\r\n        }\r\n        if (defer) {\r\n            this._dispatcher(function () { return _this._dispatchCallback(_this._successCB, value); });\r\n        }\r\n        else {\r\n            this._dispatchCallback(this._successCB, value);\r\n        }\r\n    };\r\n    Client.prototype.reject = function (error, defer) {\r\n        var _this = this;\r\n        if (typeof (this._errorCB) !== 'function') {\r\n            this.result.reject(error);\r\n            return;\r\n        }\r\n        if (defer) {\r\n            this._dispatcher(function () { return _this._dispatchCallback(_this._errorCB, error); });\r\n        }\r\n        else {\r\n            this._dispatchCallback(this._errorCB, error);\r\n        }\r\n    };\r\n    Client.prototype._dispatchCallback = function (callback, arg) {\r\n        var result, then, type;\r\n        try {\r\n            result = callback(arg);\r\n            this.result.resolve(result);\r\n        }\r\n        catch (err) {\r\n            this.result.reject(err);\r\n            return;\r\n        }\r\n    };\r\n    return Client;\r\n}());\r\nvar Deferred = (function () {\r\n    function Deferred(dispatcher) {\r\n        this._stack = [];\r\n        this._state = PromiseState.Pending;\r\n        if (dispatcher)\r\n            this._dispatcher = dispatcher;\r\n        else\r\n            this._dispatcher = DispatchDeferred;\r\n        this.promise = new Promise(this);\r\n    }\r\n    Deferred.prototype.DispatchDeferred = function (closure) {\r\n        setTimeout(closure, 0);\r\n    };\r\n    Deferred.prototype.then = function (successCB, errorCB) {\r\n        if (typeof (successCB) !== 'function' && typeof (errorCB) !== 'function') {\r\n            return this.promise;\r\n        }\r\n        var client = new Client(this._dispatcher, successCB, errorCB);\r\n        switch (this._state) {\r\n            case PromiseState.Pending:\r\n            case PromiseState.ResolutionInProgress:\r\n                this._stack.push(client);\r\n                break;\r\n            case PromiseState.Resolved:\r\n                client.resolve(this._value, true);\r\n                break;\r\n            case PromiseState.Rejected:\r\n                client.reject(this._error, true);\r\n                break;\r\n        }\r\n        return client.result.promise;\r\n    };\r\n    Deferred.prototype.resolve = function (value) {\r\n        if (this._state !== PromiseState.Pending) {\r\n            return this;\r\n        }\r\n        return this._resolve(value);\r\n    };\r\n    Deferred.prototype._resolve = function (value) {\r\n        var _this = this;\r\n        var type = typeof (value), then, pending = true;\r\n        try {\r\n            if (value !== null &&\r\n                (type === 'object' || type === 'function') &&\r\n                typeof (then = value.then) === 'function') {\r\n                if (value === this.promise) {\r\n                    throw new TypeError('recursive resolution');\r\n                }\r\n                this._state = PromiseState.ResolutionInProgress;\r\n                then.call(value, function (result) {\r\n                    if (pending) {\r\n                        pending = false;\r\n                        _this._resolve(result);\r\n                    }\r\n                }, function (error) {\r\n                    if (pending) {\r\n                        pending = false;\r\n                        _this._reject(error);\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                this._state = PromiseState.ResolutionInProgress;\r\n                this._dispatcher(function () {\r\n                    _this._state = PromiseState.Resolved;\r\n                    _this._value = value;\r\n                    var i, stackSize = _this._stack.length;\r\n                    for (i = 0; i < stackSize; i++) {\r\n                        _this._stack[i].resolve(value, false);\r\n                    }\r\n                    _this._stack.splice(0, stackSize);\r\n                });\r\n            }\r\n        }\r\n        catch (err) {\r\n            if (pending) {\r\n                this._reject(err);\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    Deferred.prototype.reject = function (error) {\r\n        if (this._state !== PromiseState.Pending) {\r\n            return this;\r\n        }\r\n        return this._reject(error);\r\n    };\r\n    Deferred.prototype._reject = function (error) {\r\n        var _this = this;\r\n        this._state = PromiseState.ResolutionInProgress;\r\n        this._dispatcher(function () {\r\n            _this._state = PromiseState.Rejected;\r\n            _this._error = error;\r\n            var stackSize = _this._stack.length, i = 0;\r\n            for (i = 0; i < stackSize; i++) {\r\n                _this._stack[i].reject(error, false);\r\n            }\r\n            _this._stack.splice(0, stackSize);\r\n        });\r\n        return this;\r\n    };\r\n    return Deferred;\r\n}());\r\nexports.Deferred = Deferred;\r\nvar Promise = (function () {\r\n    function Promise(_deferred) {\r\n        this._deferred = _deferred;\r\n    }\r\n    Promise.prototype.then = function (successCallback, errorCallback) {\r\n        return this._deferred.then(successCallback, errorCallback);\r\n    };\r\n    Promise.prototype.fail = function (errorCallback) {\r\n        return this._deferred.then(undefined, errorCallback);\r\n    };\r\n    return Promise;\r\n}());\r\nexports.Promise = Promise;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/promises.ts\n ** module id = 2\n ** module chunks = 0\n **/","\"use strict\";\r\nvar promises_1 = require(\"./promises\");\r\n(function (OAuthVersion) {\r\n    OAuthVersion[OAuthVersion[\"v1\"] = 1] = \"v1\";\r\n    OAuthVersion[OAuthVersion[\"v2\"] = 2] = \"v2\";\r\n})(exports.OAuthVersion || (exports.OAuthVersion = {}));\r\nvar OAuthVersion = exports.OAuthVersion;\r\nvar Error = (function () {\r\n    function Error() {\r\n    }\r\n    return Error;\r\n}());\r\nexports.Error = Error;\r\nvar CachedToken = (function () {\r\n    function CachedToken(id, scopes, resource, token, expiry) {\r\n        this.id = id;\r\n        this.scopes = scopes;\r\n        this.resource = resource;\r\n        this.token = token;\r\n        this.expiry = expiry;\r\n    }\r\n    ;\r\n    Object.defineProperty(CachedToken.prototype, \"isExpired\", {\r\n        get: function () {\r\n            return this.expiry <= new Date(new Date().getTime() + 60000);\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    CachedToken.prototype.hasScopes = function (requiredScopes) {\r\n        var _this = this;\r\n        if (!this.scopes) {\r\n            return false;\r\n        }\r\n        return requiredScopes.every(function (requiredScope) {\r\n            return _this.scopes.some(function (actualScope) { return requiredScope === actualScope; });\r\n        });\r\n    };\r\n    return CachedToken;\r\n}());\r\nvar TokenCache = (function () {\r\n    function TokenCache(tokenStorage) {\r\n        var _this = this;\r\n        this.tokenStorage = tokenStorage;\r\n        this.cachedTokens = {};\r\n        if (tokenStorage) {\r\n            tokenStorage.getAll().forEach(function (_a) {\r\n                var id = _a.id, scopes = _a.scopes, resource = _a.resource, token = _a.token, expiry = _a.expiry;\r\n                var cachedToken = new CachedToken(id, scopes, resource, token, new Date(expiry));\r\n                if (cachedToken.isExpired) {\r\n                    _this.tokenStorage.remove(cachedToken.id);\r\n                }\r\n                else {\r\n                    _this.cachedTokens[cachedToken.id] = cachedToken;\r\n                }\r\n            });\r\n        }\r\n    }\r\n    TokenCache.prototype.add = function (token) {\r\n        this.cachedTokens[token.id] = token;\r\n        this.tokenStorage && this.tokenStorage.add(token.id, token);\r\n    };\r\n    TokenCache.prototype.getForResource = function (resource) {\r\n        var cachedToken = this.cachedTokens[resource];\r\n        if (cachedToken && cachedToken.isExpired) {\r\n            this.remove(resource);\r\n            return null;\r\n        }\r\n        return cachedToken;\r\n    };\r\n    TokenCache.prototype.getForScopes = function (scopes) {\r\n        for (var key in this.cachedTokens) {\r\n            var cachedToken = this.cachedTokens[key];\r\n            if (cachedToken.hasScopes(scopes)) {\r\n                if (cachedToken.isExpired) {\r\n                    this.remove(key);\r\n                }\r\n                else {\r\n                    return cachedToken;\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    };\r\n    TokenCache.prototype.clear = function () {\r\n        this.cachedTokens = {};\r\n        this.tokenStorage && this.tokenStorage.clear();\r\n    };\r\n    TokenCache.prototype.remove = function (key) {\r\n        this.tokenStorage && this.tokenStorage.remove(key);\r\n        delete this.cachedTokens[key];\r\n    };\r\n    return TokenCache;\r\n}());\r\nvar IdToken = (function () {\r\n    function IdToken() {\r\n    }\r\n    return IdToken;\r\n}());\r\nexports.IdToken = IdToken;\r\nvar Identity = (function () {\r\n    function Identity(identitySettings) {\r\n        var _this = this;\r\n        this.policy = \"\";\r\n        this.clientId = identitySettings.clientId;\r\n        this.tokenProcessorUrl = identitySettings.tokenProcessingUri;\r\n        if (identitySettings.version)\r\n            this.version = identitySettings.version;\r\n        else\r\n            this.version = OAuthVersion.v1;\r\n        this.tokenCache = new TokenCache(identitySettings.tokenStorage);\r\n        window.addEventListener(\"message\", function (event) {\r\n            if (event.data.type === \"id_token\") {\r\n                if (event.data.error) {\r\n                    var e = new Error();\r\n                    e.text = event.data.error;\r\n                    _this.loginCallback(e);\r\n                }\r\n                else {\r\n                    if (_this.state !== event.data.state) {\r\n                        var error = new Error();\r\n                        error.statusText = \"Invalid state\";\r\n                        _this.loginCallback(error);\r\n                    }\r\n                    else {\r\n                        _this.decodeIdToken(event.data.token);\r\n                        _this.loginCallback(null);\r\n                    }\r\n                }\r\n            }\r\n            else if (event.data.type === \"access_token\") {\r\n                if (event.data.error) {\r\n                    var e = new Error();\r\n                    e.text = event.data.error;\r\n                    _this.getTokenCallback(null, e);\r\n                }\r\n                else {\r\n                    var token = event.data.token;\r\n                    var iframe = document.getElementById(\"tokenIFrame\");\r\n                    iframe.parentNode.removeChild(iframe);\r\n                    if (event.data.state !== _this.state) {\r\n                        var error = new Error();\r\n                        error.statusText = \"Invalid state\";\r\n                        _this.getTokenCallback(null, error);\r\n                    }\r\n                    else {\r\n                        _this.getTokenCallback(token, null);\r\n                    }\r\n                }\r\n            }\r\n        });\r\n    }\r\n    Identity.prototype.checkForIdentityRedirect = function () {\r\n        function token(s) {\r\n            var start = window.location.href.indexOf(s);\r\n            if (start < 0)\r\n                return null;\r\n            var end = window.location.href.indexOf(\"&\", start + s.length);\r\n            return window.location.href.substring(start, ((end > 0) ? end : window.location.href.length));\r\n        }\r\n        function parseQueryString(str) {\r\n            var queryString = str || window.location.search || '';\r\n            var keyValPairs = [];\r\n            var params = {};\r\n            queryString = queryString.replace(/.*?\\?/, \"\");\r\n            if (queryString.length) {\r\n                keyValPairs = queryString.split('&');\r\n                for (var pairNum in keyValPairs) {\r\n                    var key = keyValPairs[pairNum].split('=')[0];\r\n                    if (!key.length)\r\n                        continue;\r\n                    if (typeof params[key] === 'undefined')\r\n                        params[key] = [];\r\n                    params[key].push(keyValPairs[pairNum].split('=')[1]);\r\n                }\r\n            }\r\n            return params;\r\n        }\r\n        var params = parseQueryString(window.location.href);\r\n        var idToken = token(\"#id_token=\");\r\n        var accessToken = token(\"#access_token\");\r\n        if (idToken) {\r\n            if (true || this.state === params[\"state\"][0]) {\r\n                this.decodeIdToken(idToken);\r\n                this.loginCallback && this.loginCallback(null);\r\n            }\r\n            else {\r\n                var error = new Error();\r\n                error.statusText = \"Invalid state\";\r\n                this.loginCallback && this.loginCallback(error);\r\n            }\r\n            return true;\r\n        }\r\n        else if (accessToken) {\r\n            throw \"Should not get here.  This should be handled via the iframe approach.\";\r\n        }\r\n        return false;\r\n    };\r\n    Identity.prototype.decodeIdToken = function (idToken) {\r\n        var _this = this;\r\n        var decodedToken = this.base64Decode(idToken.substring(idToken.indexOf('.') + 1, idToken.lastIndexOf('.')));\r\n        var decodedTokenJSON = JSON.parse(decodedToken);\r\n        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\r\n        this.idToken = new IdToken();\r\n        this.idToken.FullToken = decodedTokenJSON;\r\n        this.idToken.Token = idToken;\r\n        this.idToken.Expiry = expiryDate;\r\n        this.idToken.UPN = decodedTokenJSON.upn;\r\n        this.idToken.TenantId = decodedTokenJSON.tid;\r\n        this.idToken.FamilyName = decodedTokenJSON.family_name;\r\n        this.idToken.GivenName = decodedTokenJSON.given_name;\r\n        this.idToken.Name = decodedTokenJSON.name;\r\n        this.idToken.PreferredUsername = decodedTokenJSON.preferred_username;\r\n        var expiration = expiryDate.getTime() - new Date().getTime() - 300000;\r\n        this.refreshTimer = setTimeout((function () {\r\n            _this.renewIdToken();\r\n        }), expiration);\r\n    };\r\n    Identity.prototype.decodeAccessToken = function (accessToken, resource, scopes) {\r\n        var decodedToken = this.base64Decode(accessToken.substring(accessToken.indexOf('.') + 1, accessToken.lastIndexOf('.')));\r\n        var decodedTokenJSON = JSON.parse(decodedToken);\r\n        var expiryDate = new Date(new Date('01/01/1970 0:0 UTC').getTime() + parseInt(decodedTokenJSON.exp) * 1000);\r\n        var key = resource || scopes.join(\" \");\r\n        var token = new CachedToken(key, scopes, resource, accessToken, expiryDate);\r\n        this.tokenCache.add(token);\r\n    };\r\n    Identity.prototype.getIdToken = function () {\r\n        return this.idToken;\r\n    };\r\n    Identity.prototype.isLoggedIn = function () {\r\n        if (!this.idToken)\r\n            return false;\r\n        return (this.idToken.Expiry > new Date());\r\n    };\r\n    Identity.prototype.renewIdToken = function () {\r\n        clearTimeout(this.refreshTimer);\r\n        this.login(function () { });\r\n    };\r\n    Identity.prototype.getCurrentOauthVersion = function () {\r\n        return this.version;\r\n    };\r\n    Identity.prototype.getAccessTokenAsync = function (resource) {\r\n        var d = new promises_1.Deferred();\r\n        this.getAccessToken(resource, (function (token, error) {\r\n            if (error) {\r\n                d.reject(error);\r\n            }\r\n            else {\r\n                d.resolve(token);\r\n            }\r\n        }));\r\n        return d.promise;\r\n    };\r\n    Identity.prototype.getAccessToken = function (resource, callback) {\r\n        var _this = this;\r\n        if (this.version !== OAuthVersion.v1) {\r\n            var e = new Error();\r\n            e.statusText = \"Currently this identity class is using v2 OAuth mode. You need to use getAccessTokenForScopes() method\";\r\n            callback(null, e);\r\n            return;\r\n        }\r\n        var token = this.tokenCache.getForResource(resource);\r\n        if (token) {\r\n            return callback(token.token, null);\r\n        }\r\n        this.getTokenCallback = (function (token, error) {\r\n            if (error) {\r\n                callback(null, error);\r\n            }\r\n            else {\r\n                _this.decodeAccessToken(token, resource);\r\n                callback(token, null);\r\n            }\r\n        });\r\n        this.nonce = \"token\" + this.generateNonce();\r\n        this.state = \"token\" + this.generateNonce();\r\n        var iframe = document.createElement('iframe');\r\n        iframe.style.display = \"none\";\r\n        iframe.id = \"tokenIFrame\";\r\n        iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n            \"&resource=\" + encodeURIComponent(resource) +\r\n            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n            \"&state=\" + encodeURIComponent(this.state) +\r\n            \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n            \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n            \"&op=token\";\r\n        document.body.appendChild(iframe);\r\n    };\r\n    Identity.prototype.getAccessTokenForScopesAsync = function (scopes, promptForConsent) {\r\n        if (promptForConsent === void 0) { promptForConsent = false; }\r\n        var d = new promises_1.Deferred();\r\n        this.getAccessTokenForScopes(scopes, promptForConsent, function (token, error) {\r\n            if (error) {\r\n                d.reject(error);\r\n            }\r\n            else {\r\n                d.resolve(token);\r\n            }\r\n        });\r\n        return d.promise;\r\n    };\r\n    Identity.prototype.getAccessTokenForScopes = function (scopes, promptForConsent, callback) {\r\n        var _this = this;\r\n        if (promptForConsent === void 0) { promptForConsent = false; }\r\n        if (this.version !== OAuthVersion.v2) {\r\n            var e = new Error();\r\n            e.statusText = \"Dynamic scopes require v2 mode. Currently this identity class is using v1\";\r\n            callback(null, e);\r\n            return;\r\n        }\r\n        var token = this.tokenCache.getForScopes(scopes);\r\n        if (token) {\r\n            return callback(token.token, null);\r\n        }\r\n        this.getTokenCallback = (function (token, error) {\r\n            if (error) {\r\n                if (promptForConsent || !error.text) {\r\n                    callback(null, error);\r\n                }\r\n                else if (error.text.indexOf(\"AADSTS65001\") >= 0) {\r\n                    _this.getAccessTokenForScopes(scopes, true, _this.getTokenCallback);\r\n                }\r\n                else {\r\n                    callback(null, error);\r\n                }\r\n            }\r\n            else {\r\n                _this.decodeAccessToken(token, null, scopes);\r\n                callback(token, null);\r\n            }\r\n        });\r\n        this.nonce = \"token\" + this.generateNonce();\r\n        this.state = \"token\" + this.generateNonce();\r\n        if (!promptForConsent) {\r\n            var iframe = document.createElement('iframe');\r\n            iframe.style.display = \"none\";\r\n            iframe.id = \"tokenIFrame\";\r\n            iframe.src = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\r\n                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n                \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n                \"&state=\" + encodeURIComponent(this.state) +\r\n                \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n                \"&login_hint=\" + encodeURIComponent(this.idToken.PreferredUsername) +\r\n                \"&domain_hint=\" + encodeURIComponent(this.idToken.TenantId === \"9188040d-6c67-4c5b-b112-36a304b66dad\" ? \"consumers\" : \"organizations\") +\r\n                \"&op=token\";\r\n            document.body.appendChild(iframe);\r\n        }\r\n        else {\r\n            window.open(this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n                \"&scopes=\" + encodeURIComponent(scopes.join(\" \")) +\r\n                \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n                \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n                \"&state=\" + encodeURIComponent(this.state) +\r\n                \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n                \"&op=token\", \"_blank\");\r\n        }\r\n    };\r\n    Identity.prototype.loginAsync = function (loginSettings) {\r\n        var d = new promises_1.Deferred();\r\n        this.login(function (error) {\r\n            if (error) {\r\n                d.reject(error);\r\n            }\r\n            else {\r\n                d.resolve(null);\r\n            }\r\n        }, loginSettings);\r\n        return d.promise;\r\n    };\r\n    Identity.prototype.login = function (callback, loginSettings) {\r\n        this.loginCallback = callback;\r\n        if (!loginSettings)\r\n            loginSettings = {};\r\n        if (loginSettings.policy)\r\n            this.policy = loginSettings.policy;\r\n        if (loginSettings.scopes && this.version === OAuthVersion.v1) {\r\n            var e = new Error();\r\n            e.text = \"Scopes can only be used with OAuth v2.\";\r\n            callback(e);\r\n            return;\r\n        }\r\n        if (loginSettings.policy && !loginSettings.tenant) {\r\n            var e = new Error();\r\n            e.text = \"In order to use policy (AAD B2C) a tenant must be specified as well.\";\r\n            callback(e);\r\n            return;\r\n        }\r\n        this.state = \"login\" + this.generateNonce();\r\n        this.nonce = \"login\" + this.generateNonce();\r\n        var loginURL = this.tokenProcessorUrl + \"?clientId=\" + encodeURIComponent(this.clientId) +\r\n            \"&redirectUri=\" + encodeURIComponent(this.tokenProcessorUrl) +\r\n            \"&state=\" + encodeURIComponent(this.state) +\r\n            \"&nonce=\" + encodeURIComponent(this.nonce) +\r\n            \"&version=\" + encodeURIComponent(this.version.toString()) +\r\n            \"&op=login\" +\r\n            \"&p=\" + encodeURIComponent(this.policy);\r\n        if (loginSettings.tenant) {\r\n            loginURL += \"&tenant=\" + encodeURIComponent(loginSettings.tenant);\r\n        }\r\n        if (this.version === OAuthVersion.v2) {\r\n            if (!loginSettings.scopes)\r\n                loginSettings.scopes = [];\r\n            if (loginSettings.scopes.indexOf(\"profile\") < 0)\r\n                loginSettings.scopes.push(\"profile\");\r\n            if (loginSettings.scopes.indexOf(\"openid\") < 0)\r\n                loginSettings.scopes.push(\"openid\");\r\n            loginURL += \"&scopes=\" + encodeURIComponent(loginSettings.scopes.join(\" \"));\r\n        }\r\n        window.open(loginURL, \"_blank\");\r\n    };\r\n    Identity.prototype.loginNoWindowAsync = function (toUrl) {\r\n        var d = new promises_1.Deferred();\r\n        this.loginNoWindow(function (error) {\r\n            if (error) {\r\n                d.reject(error);\r\n            }\r\n            else {\r\n                d.resolve(null);\r\n            }\r\n        }, toUrl);\r\n        return d.promise;\r\n    };\r\n    Identity.prototype.loginNoWindow = function (callback, toUrl) {\r\n        this.loginCallback = callback;\r\n        this.state = \"clientId=\" + this.clientId + \"&\" + \"tokenProcessorUrl=\" + this.tokenProcessorUrl;\r\n        this.nonce = this.generateNonce();\r\n        var redirected = this.checkForIdentityRedirect();\r\n        if (!redirected) {\r\n            var redirectUri = (toUrl) ? toUrl : window.location.href.split(\"#\")[0];\r\n            var url = \"https://login.microsoftonline.com/common/oauth2/authorize?response_type=id_token\" +\r\n                \"&client_id=\" + encodeURIComponent(this.clientId) +\r\n                \"&redirect_uri=\" + encodeURIComponent(redirectUri) +\r\n                \"&state=\" + encodeURIComponent(this.state) +\r\n                \"&nonce=\" + encodeURIComponent(this.nonce);\r\n            window.location.href = url;\r\n        }\r\n    };\r\n    Identity.prototype.logOut = function () {\r\n        this.tokenCache.clear();\r\n        var url = \"https://login.microsoftonline.com/common/oauth2/logout?post_logout_redirect_uri=\" + encodeURI(window.location.href);\r\n        window.location.href = url;\r\n    };\r\n    Identity.prototype.base64Decode = function (encodedString) {\r\n        var e = {}, i, b = 0, c, x, l = 0, a, r = '', w = String.fromCharCode, L = encodedString.length;\r\n        var A = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/\";\r\n        for (i = 0; i < 64; i++) {\r\n            e[A.charAt(i)] = i;\r\n        }\r\n        for (x = 0; x < L; x++) {\r\n            c = e[encodedString.charAt(x)];\r\n            b = (b << 6) + c;\r\n            l += 6;\r\n            while (l >= 8) {\r\n                ((a = (b >>> (l -= 8)) & 0xff) || (x < (L - 2))) && (r += w(a));\r\n            }\r\n        }\r\n        return r;\r\n    };\r\n    Identity.prototype.generateNonce = function () {\r\n        var text = \"\";\r\n        var chars = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789\";\r\n        for (var i = 0; i < 32; i++) {\r\n            text += chars.charAt(Math.floor(Math.random() * chars.length));\r\n        }\r\n        return text;\r\n    };\r\n    return Identity;\r\n}());\r\nexports.Identity = Identity;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/identity.ts\n ** module id = 3\n ** module chunks = 0\n **/"],"sourceRoot":""}