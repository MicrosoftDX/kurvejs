!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Kurve=t():e.Kurve=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var o=n[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,t),o.loaded=!0,o.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){"use strict";function r(e){for(var n in e)t.hasOwnProperty(n)||(t[n]=e[n])}r(n(1)),r(n(3)),r(n(4))},function(e,t,n){"use strict";var r=n(2),o=n(3),i=n(4),s=function(){function e(e){var t=this;this.req=null,this.accessToken=null,this.KurveIdentity=null,this.defaultResourceID="https://graph.microsoft.com",this.baseUrl="https://graph.microsoft.com/v1.0",this.GET=function(e,n){return function(){return t.Get(e,n)}},this.GETCOLLECTION=function(e,n){return function(){return t.GetCollection(e,n)}},this.me=new i.UserNode(this,this.baseUrl),this.user=function(e){return new i.UserNode(t,t.baseUrl,e)},this.users=new i.UsersNode(this,this.baseUrl),e.defaultAccessToken?this.accessToken=e.defaultAccessToken:this.KurveIdentity=e.identity}return e.prototype.Get=function(e,t){console.log("GET",e);var n=new r.Deferred;return this.get(e,function(e,t){var r=JSON.parse(t);if(r.error){var i=new o.Error;return i.other=r.error,void n.reject(i)}n.resolve(r)}),n.promise},e.prototype.GetCollection=function(e,t){console.log("GETCOLLECTION",e);var n=new r.Deferred;return this.get(e,function(e,t){var r=JSON.parse(t);if(r.error){var i=new o.Error;return i.other=r.error,void n.reject(i)}var s=r.value?r.value:[r];n.resolve({objects:s})}),n.promise},e.prototype.scopesForV2=function(e){return this.KurveIdentity?this.KurveIdentity.getCurrentOauthVersion()===o.OAuthVersion.v1?null:e:null},e.prototype.getAsync=function(e){var t=new r.Deferred;return this.get(e,function(e,n){return e?t.reject(e):t.resolve(n)}),t.promise},e.prototype.get=function(e,t,n,r){var o=this,i=new XMLHttpRequest;n&&(i.responseType=n),i.onreadystatechange=function(){4===i.readyState&&(200===i.status?t(null,n?i.response:i.responseText):t(o.generateError(i)))},i.open("GET",e),this.addAccessTokenAndSend(i,function(e){e&&t(e)},r)},e.prototype.generateError=function(e){var t=new o.Error;return t.status=e.status,t.statusText=e.statusText,""===e.responseType||"text"===e.responseType?t.text=e.responseText:t.other=e.response,t},e.prototype.addAccessTokenAndSend=function(e,t,n){this.accessToken?(e.setRequestHeader("Authorization","Bearer "+this.accessToken),e.send()):n?this.KurveIdentity.getAccessTokenForScopes(n,!1,function(n,r){r?t(r):(e.setRequestHeader("Authorization","Bearer "+n),e.send(),t(null))}):this.KurveIdentity.getAccessToken(this.defaultResourceID,function(n,r){n?t(n):(e.setRequestHeader("Authorization","Bearer "+r),e.send(),t(null))})},e}();t.Graph=s},function(e,t){"use strict";function n(e){setTimeout(e,0)}var r;!function(e){e[e.Pending=0]="Pending",e[e.ResolutionInProgress=1]="ResolutionInProgress",e[e.Resolved=2]="Resolved",e[e.Rejected=3]="Rejected"}(r||(r={}));var o=function(){function e(e,t,n){this._dispatcher=e,this._successCB=t,this._errorCB=n,this.result=new i(e)}return e.prototype.resolve=function(e,t){var n=this;return"function"!=typeof this._successCB?void this.result.resolve(e):void(t?this._dispatcher(function(){return n._dispatchCallback(n._successCB,e)}):this._dispatchCallback(this._successCB,e))},e.prototype.reject=function(e,t){var n=this;return"function"!=typeof this._errorCB?void this.result.reject(e):void(t?this._dispatcher(function(){return n._dispatchCallback(n._errorCB,e)}):this._dispatchCallback(this._errorCB,e))},e.prototype._dispatchCallback=function(e,t){var n;try{n=e(t),this.result.resolve(n)}catch(r){return void this.result.reject(r)}},e}(),i=function(){function e(e){this._stack=[],this._state=r.Pending,e?this._dispatcher=e:this._dispatcher=n,this.promise=new s(this)}return e.prototype.DispatchDeferred=function(e){setTimeout(e,0)},e.prototype.then=function(e,t){if("function"!=typeof e&&"function"!=typeof t)return this.promise;var n=new o(this._dispatcher,e,t);switch(this._state){case r.Pending:case r.ResolutionInProgress:this._stack.push(n);break;case r.Resolved:n.resolve(this._value,!0);break;case r.Rejected:n.reject(this._error,!0)}return n.result.promise},e.prototype.resolve=function(e){return this._state!==r.Pending?this:this._resolve(e)},e.prototype._resolve=function(e){var t,n=this,o=typeof e,i=!0;try{if(null===e||"object"!==o&&"function"!==o||"function"!=typeof(t=e.then))this._state=r.ResolutionInProgress,this._dispatcher(function(){n._state=r.Resolved,n._value=e;var t,o=n._stack.length;for(t=0;o>t;t++)n._stack[t].resolve(e,!1);n._stack.splice(0,o)});else{if(e===this.promise)throw new TypeError("recursive resolution");this._state=r.ResolutionInProgress,t.call(e,function(e){i&&(i=!1,n._resolve(e))},function(e){i&&(i=!1,n._reject(e))})}}catch(s){i&&this._reject(s)}return this},e.prototype.reject=function(e){return this._state!==r.Pending?this:this._reject(e)},e.prototype._reject=function(e){var t=this;return this._state=r.ResolutionInProgress,this._dispatcher(function(){t._state=r.Rejected,t._error=e;var n=t._stack.length,o=0;for(o=0;n>o;o++)t._stack[o].reject(e,!1);t._stack.splice(0,n)}),this},e}();t.Deferred=i;var s=function(){function e(e){this._deferred=e}return e.prototype.then=function(e,t){return this._deferred.then(e,t)},e.prototype.fail=function(e){return this._deferred.then(void 0,e)},e}();t.Promise=s},function(e,t,n){"use strict";var r=n(2);!function(e){e[e.v1=1]="v1",e[e.v2=2]="v2"}(t.OAuthVersion||(t.OAuthVersion={}));var o=t.OAuthVersion,i=function(){function e(){}return e}();t.Error=i;var s=function(){function e(e,t,n,r,o){this.id=e,this.scopes=t,this.resource=n,this.token=r,this.expiry=o}return Object.defineProperty(e.prototype,"isExpired",{get:function(){return this.expiry<=new Date((new Date).getTime()+6e4)},enumerable:!0,configurable:!0}),e.prototype.hasScopes=function(e){var t=this;return this.scopes?e.every(function(e){return t.scopes.some(function(t){return e===t})}):!1},e}(),c=function(){function e(e){var t=this;this.tokenStorage=e,this.cachedTokens={},e&&e.getAll().forEach(function(e){var n=e.id,r=e.scopes,o=e.resource,i=e.token,c=e.expiry,a=new s(n,r,o,i,new Date(c));a.isExpired?t.tokenStorage.remove(a.id):t.cachedTokens[a.id]=a})}return e.prototype.add=function(e){this.cachedTokens[e.id]=e,this.tokenStorage&&this.tokenStorage.add(e.id,e)},e.prototype.getForResource=function(e){var t=this.cachedTokens[e];return t&&t.isExpired?(this.remove(e),null):t},e.prototype.getForScopes=function(e){for(var t in this.cachedTokens){var n=this.cachedTokens[t];if(n.hasScopes(e)){if(!n.isExpired)return n;this.remove(t)}}return null},e.prototype.clear=function(){this.cachedTokens={},this.tokenStorage&&this.tokenStorage.clear()},e.prototype.remove=function(e){this.tokenStorage&&this.tokenStorage.remove(e),delete this.cachedTokens[e]},e}(),a=function(){function e(){}return e}();t.IdToken=a;var h=function(){function e(e){var t=this;this.policy="",this.clientId=e.clientId,this.tokenProcessorUrl=e.tokenProcessingUri,e.version?this.version=e.version:this.version=o.v1,this.tokenCache=new c(e.tokenStorage),window.addEventListener("message",function(e){if("id_token"===e.data.type)if(e.data.error){var n=new i;n.text=e.data.error,t.loginCallback(n)}else if(t.state!==e.data.state){var r=new i;r.statusText="Invalid state",t.loginCallback(r)}else t.decodeIdToken(e.data.token),t.loginCallback(null);else if("access_token"===e.data.type)if(e.data.error){var n=new i;n.text=e.data.error,t.getTokenCallback(null,n)}else{var o=e.data.token,s=document.getElementById("tokenIFrame");if(s.parentNode.removeChild(s),e.data.state!==t.state){var r=new i;r.statusText="Invalid state",t.getTokenCallback(null,r)}else t.getTokenCallback(o,null)}})}return e.prototype.checkForIdentityRedirect=function(){function e(e){var t=window.location.href.indexOf(e);if(0>t)return null;var n=window.location.href.indexOf("&",t+e.length);return window.location.href.substring(t,n>0?n:window.location.href.length)}function t(e){var t=e||window.location.search||"",n=[],r={};if(t=t.replace(/.*?\?/,""),t.length){n=t.split("&");for(var o in n){var i=n[o].split("=")[0];i.length&&("undefined"==typeof r[i]&&(r[i]=[]),r[i].push(n[o].split("=")[1]))}}return r}var n=(t(window.location.href),e("#id_token=")),r=e("#access_token");if(n){return this.decodeIdToken(n),this.loginCallback&&this.loginCallback(null),!0}if(r)throw"Should not get here.  This should be handled via the iframe approach.";return!1},e.prototype.decodeIdToken=function(e){var t=this,n=this.base64Decode(e.substring(e.indexOf(".")+1,e.lastIndexOf("."))),r=JSON.parse(n),o=new Date(new Date("01/01/1970 0:0 UTC").getTime()+1e3*parseInt(r.exp));this.idToken=new a,this.idToken.FullToken=r,this.idToken.Token=e,this.idToken.Expiry=o,this.idToken.UPN=r.upn,this.idToken.TenantId=r.tid,this.idToken.FamilyName=r.family_name,this.idToken.GivenName=r.given_name,this.idToken.Name=r.name,this.idToken.PreferredUsername=r.preferred_username;var i=o.getTime()-(new Date).getTime()-3e5;this.refreshTimer=setTimeout(function(){t.renewIdToken()},i)},e.prototype.decodeAccessToken=function(e,t,n){var r=this.base64Decode(e.substring(e.indexOf(".")+1,e.lastIndexOf("."))),o=JSON.parse(r),i=new Date(new Date("01/01/1970 0:0 UTC").getTime()+1e3*parseInt(o.exp)),c=t||n.join(" "),a=new s(c,n,t,e,i);this.tokenCache.add(a)},e.prototype.getIdToken=function(){return this.idToken},e.prototype.isLoggedIn=function(){return this.idToken?this.idToken.Expiry>new Date:!1},e.prototype.renewIdToken=function(){clearTimeout(this.refreshTimer),this.login(function(){})},e.prototype.getCurrentOauthVersion=function(){return this.version},e.prototype.getAccessTokenAsync=function(e){var t=new r.Deferred;return this.getAccessToken(e,function(e,n){e?t.reject(e):t.resolve(n)}),t.promise},e.prototype.getAccessToken=function(e,t){var n=this;if(this.version!==o.v1){var r=new i;return r.statusText="Currently this identity class is using v2 OAuth mode. You need to use getAccessTokenForScopes() method",void t(r)}var s=this.tokenCache.getForResource(e);if(s)return t(null,s.token);this.getTokenCallback=function(r,o){o?t(o):(n.decodeAccessToken(r,e),t(null,r))},this.nonce="token"+this.generateNonce(),this.state="token"+this.generateNonce();var c=document.createElement("iframe");c.style.display="none",c.id="tokenIFrame",c.src=this.tokenProcessorUrl+"?clientId="+encodeURIComponent(this.clientId)+"&resource="+encodeURIComponent(e)+"&redirectUri="+encodeURIComponent(this.tokenProcessorUrl)+"&state="+encodeURIComponent(this.state)+"&version="+encodeURIComponent(this.version.toString())+"&nonce="+encodeURIComponent(this.nonce)+"&op=token",document.body.appendChild(c)},e.prototype.getAccessTokenForScopesAsync=function(e,t){void 0===t&&(t=!1);var n=new r.Deferred;return this.getAccessTokenForScopes(e,t,function(e,t){t?n.reject(t):n.resolve(e)}),n.promise},e.prototype.getAccessTokenForScopes=function(e,t,n){var r=this;if(void 0===t&&(t=!1),this.version!==o.v2){var s=new i;return s.statusText="Dynamic scopes require v2 mode. Currently this identity class is using v1",void n(null,s)}var c=this.tokenCache.getForScopes(e);if(c)return n(c.token,null);if(this.getTokenCallback=function(o,i){i?t||!i.text?n(null,i):i.text.indexOf("AADSTS65001")>=0?r.getAccessTokenForScopes(e,!0,r.getTokenCallback):n(null,i):(r.decodeAccessToken(o,null,e),n(o,null))},this.nonce="token"+this.generateNonce(),this.state="token"+this.generateNonce(),t)window.open(this.tokenProcessorUrl+"?clientId="+encodeURIComponent(this.clientId)+"&scopes="+encodeURIComponent(e.join(" "))+"&redirectUri="+encodeURIComponent(this.tokenProcessorUrl)+"&version="+encodeURIComponent(this.version.toString())+"&state="+encodeURIComponent(this.state)+"&nonce="+encodeURIComponent(this.nonce)+"&op=token","_blank");else{var a=document.createElement("iframe");a.style.display="none",a.id="tokenIFrame",a.src=this.tokenProcessorUrl+"?clientId="+encodeURIComponent(this.clientId)+"&scopes="+encodeURIComponent(e.join(" "))+"&redirectUri="+encodeURIComponent(this.tokenProcessorUrl)+"&version="+encodeURIComponent(this.version.toString())+"&state="+encodeURIComponent(this.state)+"&nonce="+encodeURIComponent(this.nonce)+"&login_hint="+encodeURIComponent(this.idToken.PreferredUsername)+"&domain_hint="+encodeURIComponent("9188040d-6c67-4c5b-b112-36a304b66dad"===this.idToken.TenantId?"consumers":"organizations")+"&op=token",document.body.appendChild(a)}},e.prototype.loginAsync=function(e){var t=new r.Deferred;return this.login(function(e){e?t.reject(e):t.resolve(null)},e),t.promise},e.prototype.login=function(e,t){if(this.loginCallback=e,t||(t={}),t.policy&&(this.policy=t.policy),t.scopes&&this.version===o.v1){var n=new i;return n.text="Scopes can only be used with OAuth v2.",void e(n)}if(t.policy&&!t.tenant){var n=new i;return n.text="In order to use policy (AAD B2C) a tenant must be specified as well.",void e(n)}this.state="login"+this.generateNonce(),this.nonce="login"+this.generateNonce();var r=this.tokenProcessorUrl+"?clientId="+encodeURIComponent(this.clientId)+"&redirectUri="+encodeURIComponent(this.tokenProcessorUrl)+"&state="+encodeURIComponent(this.state)+"&nonce="+encodeURIComponent(this.nonce)+"&version="+encodeURIComponent(this.version.toString())+"&op=login&p="+encodeURIComponent(this.policy);t.tenant&&(r+="&tenant="+encodeURIComponent(t.tenant)),this.version===o.v2&&(t.scopes||(t.scopes=[]),t.scopes.indexOf("profile")<0&&t.scopes.push("profile"),t.scopes.indexOf("openid")<0&&t.scopes.push("openid"),r+="&scopes="+encodeURIComponent(t.scopes.join(" "))),window.open(r,"_blank")},e.prototype.loginNoWindowAsync=function(e){var t=new r.Deferred;return this.loginNoWindow(function(e){e?t.reject(e):t.resolve(null)},e),t.promise},e.prototype.loginNoWindow=function(e,t){this.loginCallback=e,this.state="clientId="+this.clientId+"&tokenProcessorUrl="+this.tokenProcessorUrl,this.nonce=this.generateNonce();var n=this.checkForIdentityRedirect();if(!n){var r=t?t:window.location.href.split("#")[0],o="https://login.microsoftonline.com/common/oauth2/authorize?response_type=id_token&client_id="+encodeURIComponent(this.clientId)+"&redirect_uri="+encodeURIComponent(r)+"&state="+encodeURIComponent(this.state)+"&nonce="+encodeURIComponent(this.nonce);window.location.href=o}},e.prototype.logOut=function(){this.tokenCache.clear();var e="https://login.microsoftonline.com/common/oauth2/logout?post_logout_redirect_uri="+encodeURI(window.location.href);window.location.href=e},e.prototype.base64Decode=function(e){var t,n,r,o,i={},s=0,c=0,a="",h=String.fromCharCode,u=e.length,d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(t=0;64>t;t++)i[d.charAt(t)]=t;for(r=0;u>r;r++)for(n=i[e.charAt(r)],s=(s<<6)+n,c+=6;c>=8;)((o=s>>>(c-=8)&255)||u-2>r)&&(a+=h(o));return a},e.prototype.generateNonce=function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=0;32>n;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return e},e}();t.Identity=h},function(e,t){"use strict";var n=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};t.queryUnion=function(e,t){return e?e+(t?"&"+t:""):t},t.pathWithQuery=function(e,n,r){var o=t.queryUnion(n,r);return e+(o?"?"+o:"")};var r=function(e){return"$select="+e.join(",")},o=function(e){return"$orderby="+e.join(",")},i=function(){function e(e,n,r){this.graph=e,this.path=n,this.query=r,this.pathWithQuery=t.pathWithQuery(this.path,this.query)}return e}();t.Node=i;var s=function(e){function i(){var n=this;e.apply(this,arguments),this.GetAttachment=this.graph.GET(this.pathWithQuery),this.addQuery=function(e){return new h(n.graph,n.path,t.queryUnion(n.query,e))},this.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(r(e))},this.orderby=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(o(e))}}return n(i,e),i}(i);t.AttachmentEndpoint=s;var c=function(e){function t(t,n,r){e.call(this,t,n+"/attachments/"+r)}return n(t,e),t}(s);t.AttachmentNode=c;var a=function(e,t){return function(n){return new c(e,t,n)}},h=function(e){function i(){var n=this;e.apply(this,arguments),this.GetAttachments=this.graph.GETCOLLECTION(this.pathWithQuery),this.addQuery=function(e){return new i(n.graph,n.path,t.queryUnion(n.query,e))},this.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(r(e))},this.orderby=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(o(e))}}return n(i,e),i}(i);t.AttachmentsEndpoint=h;var u=function(e){function t(t,n){e.call(this,t,n+"/attachments")}return n(t,e),t}(h);t.AttachmentsNode=u;var d=function(e,t){return new u(e,t)},p=function(e){function i(){var n=this;e.apply(this,arguments),this.GetMessage=this.graph.GET(this.pathWithQuery),this.addQuery=function(e){return new i(n.graph,n.path,t.queryUnion(n.query,e))},this.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(r(e))},this.orderby=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(o(e))}}return n(i,e),i}(i);t.MessageEndpoint=p;var l=function(e){function t(t,n,r){e.call(this,t,n+"/messages/"+r),this.attachment=a(this.graph,this.path),this.attachments=d(this.graph,this.path)}return n(t,e),t}(p);t.MessageNode=l;var f=function(e,t){return function(n){return new l(e,t,n)}},v=function(e){function i(){var n=this;e.apply(this,arguments),this.GetMessages=this.graph.GETCOLLECTION(this.pathWithQuery),this.addQuery=function(e){return new i(n.graph,n.path,t.queryUnion(n.query,e))},this.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(r(e))},this.orderby=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(o(e))}}return n(i,e),i}(i);t.MessagesEndpoint=v;var y=function(e){function t(t,n){e.call(this,t,n+"/messages/")}return n(t,e),t}(v);t.MessagesNode=y;var g=function(e,t){return new y(e,t)},k=function(e){function i(){var n=this;e.apply(this,arguments),this.GetEvent=this.graph.GET(this.pathWithQuery),this.addQuery=function(e){return new i(n.graph,n.path,t.queryUnion(n.query,e))},this.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(r(e))},this.orderby=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(o(e))}}return n(i,e),i}(i);t.EventEndpoint=k;var m=function(e){function t(t,n,r){e.call(this,t,n+"/events/"),this.attachment=a(this.graph,this.path),this.attachments=d(this.graph,this.path)}return n(t,e),t}(k);t.EventNode=m;var T=function(e,t){return function(n){return new m(e,t,n)}},w=function(e){function i(){var n=this;e.apply(this,arguments),this.GetEvents=this.graph.GETCOLLECTION(this.pathWithQuery),this.addQuery=function(e){return new i(n.graph,n.path,t.queryUnion(n.query,e))},this.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(r(e))},this.orderby=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(o(e))}}return n(i,e),i}(i);t.EventsEndpoint=w;var C=function(e){function t(t,n){e.call(this,t,n+"/events/")}return n(t,e),t}(w);t.EventsNode=C;var I=function(e,t){return new C(e,t)},U=function(e){function i(){var n=this;e.apply(this,arguments),this.GetCalendarView=this.graph.GETCOLLECTION(this.pathWithQuery),this.addQuery=function(e){return new i(n.graph,n.path,t.queryUnion(n.query,e))},this.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(r(e))},this.orderby=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(o(e))}}return n(i,e),i}(i);t.CalendarViewEndpoint=U;var _=function(e){function t(t,n,r,o){e.call(this,t,n+"/calendarView","startDateTime="+r.toISOString()+"&endDateTime="+o.toISOString())}return n(t,e),t}(U);t.CalendarViewNode=_;var b=function(e,t){return function(n,r){return new _(e,t,n,r)}},E=function(e){function i(){var n=this;e.apply(this,arguments),this.GetMailFolders=this.graph.GETCOLLECTION(this.pathWithQuery),this.addQuery=function(e){return new i(n.graph,n.path,t.queryUnion(n.query,e))},this.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(r(e))},this.orderby=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(o(e))}}return n(i,e),i}(i);t.MailFoldersEndpoint=E;var R=function(e){function t(t,n){e.call(this,t,n+"/mailFolders")}return n(t,e),t}(E);t.MailFoldersNode=R;var A=function(e){function i(){var n=this;e.apply(this,arguments),this.GetUser=this.graph.GET(this.pathWithQuery),this.addQuery=function(e){return new i(n.graph,n.path,t.queryUnion(n.query,e))},this.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(r(e))},this.orderby=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(o(e))}}return n(i,e),i}(i);t.UserEndpoint=A;var x=function(e){function t(t,n,r){void 0===n&&(n=""),e.call(this,t,r?n+"/users/"+r:n+"/me"),this.graph=t,this.message=f(this.graph,this.path),this.messages=g(this.graph,this.path),this.event=T(this.graph,this.path),this.events=I(this.graph,this.path),this.calendarView=b(this.graph,this.path),this.mailFolders=new R(this.graph,this.path)}return n(t,e),t}(A);t.UserNode=x;var O=function(e){function i(){var n=this;e.apply(this,arguments),this.GetUsers=this.graph.GETCOLLECTION(this.pathWithQuery),this.addQuery=function(e){return new i(n.graph,n.path,t.queryUnion(n.query,e))},this.select=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(r(e))},this.orderby=function(){for(var e=[],t=0;t<arguments.length;t++)e[t-0]=arguments[t];return n.addQuery(o(e))}}return n(i,e),i}(i);t.UsersEndpoint=O;var Q=function(e){function t(t,n){void 0===n&&(n=""),e.call(this,t,n+"/users")}return n(t,e),t}(i);t.UsersNode=Q}])});
//# sourceMappingURL=kurve.min.js.map