{"version":3,"sources":["KurveGraph.ts"],"names":["Kurve","Kurve.Graph","Kurve.Graph.constructor","Kurve.Graph.meAsync","Kurve.Graph.me","Kurve.Graph.usersAsync","Kurve.Graph.users","Kurve.Graph.getAsync","Kurve.Graph.get","Kurve.Graph.getUsers","Kurve.Graph.getUser","Kurve.Graph.addAccessTokenAndSend","Kurve.Graph.decorateUserObject","Kurve.Graph.decorateMessageObject","Kurve.Graph.getMessages","Kurve.Graph.buildMeUrl","Kurve.Graph.buildUsersUrl"],"mappings":"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AAUA,CAACA,iBAAiBA,CAACA,CAACA;gBAE7CA,EAAEA,CAACA,CAACA,QAAQA,CAACA,CAACA,CAACA;oBACLA,KAAMA,CAACA,QAAQA,GAAGA,CAACA,UAACA,QAAkDA;wBACxEA,IAAIA,CAACA,GAAGA,IAAIA,cAAQA,EAAEA,CAACA;wBACvBA,KAAIA,CAACA,QAAQA,CAACA,QAAQA,EAAEA,CAACA,UAACA,MAAMA,EAAEA,KAAKA;4BACnCA,EAAEA,CAACA,CAACA,QAAQA,CAACA;gCACTA,QAAQA,CAACA,MAAMA,EAAEA,KAAKA,CAACA,CAACA;4BAC5BA,IAAIA,CAACA,EAAEA,CAACA,CAACA,KAAKA,CAACA;gCACXA,CAACA,CAACA,MAAMA,CAACA,KAAKA,CAACA,CAACA;4BACpBA,IAAIA;gCACAA,CAACA,CAACA,OAAOA,CAACA,MAAMA,CAACA,CAACA;wBAC1BA,CAACA,CAACA,CAACA,CAACA;wBACJA,MAAMA,CAACA,CAACA,CAACA,OAAOA,CAACA;oBACrBA,CAACA,CAACA,CAACA;gBACPA,CAACA;gBAEDA,QAAQA,CAACA,KAAKA,EAAEA,IAAIA,CAACA,CAACA;YAC1BA,CAACA,CAACA,CAACA,CAACA;QACRA,CAACA;QAEOR,uBAAOA,GAAfA,UAAgBA,SAASA,EAAEA,QAA4CA;YAAvES,iBAcCA;YAbGA,IAAIA,CAACA,GAAGA,CAACA,SAASA,EAAEA,UAACA,MAAcA;gBAE/BA,IAAIA,SAASA,GAAGA,IAAIA,CAACA,KAAKA,CAACA,MAAMA,CAACA,CAACA;gBACnCA,EAAEA,CAACA,CAACA,SAASA,CAACA,KAAKA,CAACA,CAACA,CAACA;oBAClBA,QAAQA,CAACA,IAAIA,EAAEA,IAAIA,CAACA,SAASA,CAACA,SAASA,CAACA,KAAKA,CAACA,CAACA,CAACA;oBAChDA,MAAMA,CAACA;gBACXA,CAACA;gBAEDA,KAAIA,CAACA,kBAAkBA,CAACA,SAASA,CAACA,CAACA;gBAEnCA,QAAQA,CAACA,SAASA,EAAEA,IAAIA,CAACA,CAACA;YAC9BA,CAACA,CAACA,CA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","file":"KurveGraph-0.1.0.js","sourcesContent":["// Copyright (c) Microsoft. All rights reserved. Licensed under the MIT license. See full license at the bottom of this file.\r\nmodule Kurve {\r\n\r\n    export class Graph {\r\n        private req: XMLHttpRequest = null;\r\n        private state: string = null;\r\n        private nonce: string = null;\r\n        private accessToken: string = null;\r\n        private tenantId: string = null;\r\n        private KurveIdentity: Identity = null;\r\n        private defaultResourceID: string = \"https://graph.microsoft.com\";\r\n        private baseUrl: string = \"https://graph.microsoft.com/beta/\";\r\n\r\n        constructor(tenantId: string, identityInfo: { identity: Identity });\r\n        constructor(tenantId: string, identityInfo: { defaultAccessToken: string });\r\n        constructor(tenantId: string, identityInfo: any) {\r\n            this.tenantId = tenantId;\r\n            if (identityInfo.defaultAccessToken) {\r\n                this.accessToken = identityInfo.defaultAccessToken;\r\n            } else {\r\n                this.KurveIdentity = identityInfo.identity;\r\n            }\r\n        }\r\n\r\n        //Messages\r\n      \r\n        //Users\r\n    \r\n        public meAsync(odataQuery?: string): Promise {\r\n            var d = new Deferred();\r\n            this.me((user, error) => {\r\n                if (error) {\r\n                    d.reject(error);\r\n                } else {\r\n                    d.resolve(user);\r\n                }\r\n            }, odataQuery);\r\n            return d.promise;\r\n        }\r\n\r\n        public me(callback: (user: any, error: string) => void, odataQuery?: string): void {\r\n            var urlString: string = this.buildMeUrl() + \"/\";\r\n            if (odataQuery) {\r\n                urlString += \"?\" + odataQuery;\r\n            }\r\n            this.getUser(urlString, callback);\r\n        }\r\n\r\n        public usersAsync(odataQuery?: string): Promise {\r\n            var d = new Deferred();\r\n            this.users((users, error) => {\r\n                if (error) {\r\n                    d.reject(error);\r\n                } else {\r\n                    d.resolve(users);\r\n                }\r\n            }, odataQuery);\r\n            return d.promise;\r\n        }\r\n\r\n        public users(callback: (users: any, error: string) => void, odataQuery?: string): void {\r\n            var urlString: string = this.buildUsersUrl() + \"/\";\r\n            if (odataQuery) {\r\n                urlString += \"?\" + odataQuery;\r\n            }\r\n            this.getUsers(urlString, callback);\r\n        }\r\n\r\n        //http verbs\r\n\r\n        public getAsync(url: string): Promise {\r\n            var d = new Deferred();\r\n            this.get(url, (response) => {\r\n                d.resolve(response);\r\n            });\r\n            return d.promise;\r\n        }\r\n\r\n        public get(url: string, callback: (response:string)=>void): void {\r\n            var xhr = new XMLHttpRequest();\r\n\r\n            xhr.onreadystatechange = (() => {\r\n                if (xhr.readyState === 4) {\r\n                    callback(xhr.responseText);\r\n                }\r\n            });\r\n\r\n            xhr.open(\"GET\", url);\r\n            this.addAccessTokenAndSend(xhr);\r\n        }\r\n\r\n\r\n        //Private methods\r\n\r\n        private getUsers(urlString, callback: (users: any, error: string) => void): void {\r\n            this.get(urlString, ((result: string) => {\r\n\r\n                var usersODATA = JSON.parse(result);\r\n                if (usersODATA.error) {\r\n                    callback(null, JSON.stringify(usersODATA.error));\r\n                    return;\r\n                }\r\n\r\n                var resultsArray = !usersODATA.value ? [usersODATA] : usersODATA.value;\r\n\r\n                for (var i: number = 0; i < resultsArray.length; i++) {\r\n                    this.decorateUserObject(resultsArray[i]);\r\n                }\r\n\r\n                var users = {\r\n                    resultsPage: resultsArray\r\n                };\r\n\r\n                //implement nextLink\r\n                var nextLink = usersODATA['@odata.nextLink'];\r\n\r\n                if (nextLink) {\r\n                    (<any>users).nextLink = ((callback?: (result: string, error: string) => void) => {\r\n                        var d = new Deferred();\r\n                        this.getUsers(nextLink, ((result, error) => {\r\n                            if (callback)\r\n                                callback(result, error);\r\n                            else if (error)\r\n                                d.reject(error);\r\n                            else\r\n                                d.resolve(result);\r\n                        }));\r\n                        return d.promise;\r\n                    });\r\n                }\r\n\r\n                callback(users, null);\r\n            }));\r\n        }\r\n\r\n        private getUser(urlString, callback: (user: any, error: string) => void): void {\r\n            this.get(urlString, (result: string) => {\r\n\r\n                var userODATA = JSON.parse(result);\r\n                if (userODATA.error) {\r\n                    callback(null, JSON.stringify(userODATA.error));\r\n                    return;\r\n                }\r\n\r\n                this.decorateUserObject(userODATA);\r\n\r\n                callback(userODATA, null);\r\n            });\r\n\r\n        }\r\n\r\n        private addAccessTokenAndSend(xhr: XMLHttpRequest): void {\r\n            if (this.accessToken) {\r\n                //Using default access token\r\n                xhr.setRequestHeader('Authorization', 'Bearer ' + this.accessToken);\r\n                xhr.send();\r\n            } else {\r\n                //Using the integrated Identity object\r\n                this.KurveIdentity.getAccessToken(this.defaultResourceID, ((token: string, error: string) => {\r\n                    //cache the token\r\n                    if (error)\r\n                        throw error;\r\n                    xhr.setRequestHeader('Authorization', 'Bearer ' + token);\r\n                    xhr.send();\r\n                }));\r\n            }\r\n        }\r\n\r\n        private decorateUserObject(user: any): void {\r\n            user.messages = ((callback: (messages: any, error: string) => void, odataQuery?: string) => {\r\n                var urlString = this.buildUsersUrl() + \"/\" + user.userPrincipalName + \"/messages\";\r\n                if (odataQuery) urlString += \"?\" + odataQuery;\r\n                this.getMessages(urlString, callback, odataQuery);\r\n            });\r\n        }\r\n\r\n        private decorateMessageObject(message: any): void {\r\n        }\r\n\r\n        private getMessages(urlString: string, callback: (messages: any, error: string) => void, odataQuery?: string): void {\r\n\r\n            var url = urlString;\r\n            if (odataQuery) urlString += \"?\" + odataQuery;\r\n            this.get(url, ((result: string) => {\r\n\r\n                var messagesODATA = JSON.parse(result);\r\n                if (messagesODATA.error) {\r\n                    callback(null, JSON.stringify(messagesODATA.error));\r\n                    return;\r\n                }\r\n\r\n                var resultsArray = !messagesODATA.value ? [messagesODATA] : messagesODATA.value;\r\n\r\n                for (var i: number = 0; i < resultsArray.length; i++) {\r\n                    this.decorateMessageObject(resultsArray[i]);\r\n                }\r\n\r\n                var messages = {\r\n                    resultsPage: resultsArray\r\n                };\r\n                var nextLink = messagesODATA['@odata.nextLink'];\r\n                //implement nextLink\r\n                if (nextLink) {\r\n                    (<any>messages).nextLink = ((callback?: (result: string, error: string) => void) => {\r\n                        var d = new Deferred();\r\n                        this.getMessages(nextLink, ((result, error) => {\r\n                            if (callback)\r\n                                callback(result, error);\r\n                            else if (error)\r\n                                d.reject(error);\r\n                            else\r\n                                d.resolve(result);\r\n                        }));\r\n                        return d.promise;\r\n                    });\r\n                }\r\n\r\n                callback(messages, null);\r\n            }));\r\n        }       \r\n\r\n        private buildMeUrl(): string {\r\n            return this.baseUrl + \"me\";\r\n        }\r\n        private buildUsersUrl(): string {\r\n            return this.baseUrl + this.tenantId + \"/users\";\r\n        }\r\n    }\r\n}\r\n\r\n\r\n//*********************************************************   \r\n//   \r\n//Kurve js, https://github.com/microsoftdx/kurvejs\r\n//  \r\n//Copyright (c) Microsoft Corporation  \r\n//All rights reserved.   \r\n//  \r\n// MIT License:  \r\n// Permission is hereby granted, free of charge, to any person obtaining  \r\n// a copy of this software and associated documentation files (the  \r\n// \"\"Software\"\"), to deal in the Software without restriction, including  \r\n// without limitation the rights to use, copy, modify, merge, publish,  \r\n// distribute, sublicense, and/or sell copies of the Software, and to  \r\n// permit persons to whom the Software is furnished to do so, subject to  \r\n// the following conditions:  \r\n\r\n\r\n\r\n\r\n// The above copyright notice and this permission notice shall be  \r\n// included in all copies or substantial portions of the Software.  \r\n\r\n\r\n\r\n\r\n// THE SOFTWARE IS PROVIDED \"\"AS IS\"\", WITHOUT WARRANTY OF ANY KIND,  \r\n// EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF  \r\n// MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND  \r\n// NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE  \r\n// LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION  \r\n// OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION  \r\n// WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.  \r\n//   \r\n//*********************************************************   \r\n"],"sourceRoot":"/source/"}