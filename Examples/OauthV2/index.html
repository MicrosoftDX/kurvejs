<!DOCTYPE html>
<html>
<head>
    <title></title>
    <meta charset="utf-8" />

    <script src="https://kurvejs.blob.core.windows.net/dist/kurve.min-0.4.0.js"></script>
    <script src="./app.js"></script>

</head>
<body>
    This example uses the v2 of the protocol, therefore the application must be registered in the new registration portal: <a href="https://apps.dev.microsoft.com/">https://apps.dev.microsoft.com/</a>.<br />
    The new app model v2 is an <b>experimental</b> model with significant limitations, you should not use it in production.<br />
    More details:<br />
    
    App model v2:<br />
    <a href="https://azure.microsoft.com/en-us/documentation/articles/active-directory-v2-compare/">https://azure.microsoft.com/en-us/documentation/articles/active-directory-v2-compare/</a><br />
    Incremental consent:<br />
    <a href="https://azure.microsoft.com/en-us/documentation/articles/active-directory-v2-scopes/">https://azure.microsoft.com/en-us/documentation/articles/active-directory-v2-scopes/</a><br /> 
    Restrictions: <br />
    <a href="https://azure.microsoft.com/en-us/documentation/articles/active-directory-v2-limitations/">https://azure.microsoft.com/en-us/documentation/articles/active-directory-v2-limitations/</a><br /> 
    Implicit flow:<br />
    <a href="https://azure.microsoft.com/en-us/documentation/articles/active-directory-v2-protocols-implicit/">https://azure.microsoft.com/en-us/documentation/articles/active-directory-v2-protocols-implicit/</a><br />
    Types of tokens:<br />
    <a href="https://azure.microsoft.com/en-us/documentation/articles/active-directory-v2-tokens/">https://azure.microsoft.com/en-us/documentation/articles/active-directory-v2-tokens/</a><br />


    <div id="initDiv">
        Your App ID:<br/> <input type="text" id="AppID" value="" /><button id="buttonTestClass" onclick="setAppID();"> Use a Test App ID </button><br />
        Redirect URL: <br/> <input type="text" id="redirectUrl" value="https://localhost:44300/login.html" /><br /><br />

        <button id="btnInit" onclick="init();">Initialize</button>
    </div>
  <div id="scenarios" style="display:none">
      Tests:<br />
      <button id="logoutBtn">logout</button><br />
      <button id="requestAccessToken">Request for access token with specific scopes</button><br />
      <button id="meUser">Load user "me"</button> <br />
      <button id="userMessages">Load a user and then messages</button> <br />
      <button id="userEvents">Load a user and then their calendar events</button> <br />
      <button id="userPhoto">Load a user and then its photo</button> <br />
      <button id="loggedIn">Is user logged in?</button> <br />
      <button id="whoAmI">WhoAmI?</button> <br />

      <div id="results">

      </div>

  </div>
    
    <script type="text/javascript">
        var app;
        function init() {
            app = new Sample.AppV2();
        }


        function setAppID() {
            document.getElementById("AppID").value = "6f95d630-018e-441d-8d19-fa78a1232b42";
        }
    </script>
</body>
</html>
